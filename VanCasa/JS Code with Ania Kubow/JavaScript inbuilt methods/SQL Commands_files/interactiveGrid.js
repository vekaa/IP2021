apex.model={},function(e,t,n,r,i){"use strict";var s={},a=[],o=100,d=10,l=i.extend,h=i.isArray,c=i.isPlainObject,u=i.isFunction,f=i.Deferred;function g(e){if("string"==typeof e)return[e,null];if(h(e)&&2===e.length&&"string"==typeof e[0]&&(null===e[1]||"string"==typeof e[1]))return e;throw new Error("Invalid model id")}function _(e){var t,n;if(h(e)){for(n=[],t=0;t<e.length;t++)n.push(_(e[t]));return n}return c(e)?l(!0,{},e):e}function p(e,t,n){var r,i=e._listeners;for(r=0;r<i.length;r++)i[r].onChange(t,n)}function y(e,t,n,r,i){e?t.call(e,n,r,i):t(n,r,i)}function v(e){return"string"==typeof e?e:h(e)?1===e.length?""+e[0]:JSON.stringify(e):e.toString()}function I(e,t){var n,s=[],a=[];function o(e){var t,n,r=e._listeners;for(t=0;t<r.length;t++)(n=r[t].progressView)&&n[0]&&n[0].offsetWidth&&n[0].offsetHeight&&(s.push(n),a.push(r[t].progressOptions||null))}if(o(e),t)for(n=0;n<t.length;n++)o(t[n]);return 0===s.length?null:e._options.makeLoadingIndicator?e._options.makeLoadingIndicator(s,a):function(){var e,t,n=i();for(e=0;e<s.length;e++)t=r.showSpinner(s[e],a[e]),n=n.add(t);return function(){n.remove()}}}function m(e,t,n,r){var i,s;return s=e,r&&(s+=" Server status: "+r),i=new Error(s),t.status>=0&&(i.status=t.status),i}function w(e,t){var n,r;for(n in delete e.error,delete e.warning,delete e.message,e.fields)e.fields.hasOwnProperty(n)&&(r=e.fields[n],t||(delete r.changed,delete r.stale),delete r.error,delete r.warning,delete r.message)}function R(e,t,n,r,i){return-1===t&&(t=0),-1===n&&(n=t+e*r),t+(n-t)/(r+1)*i}function F(e){return new Error("Model has invalid shape for the "+e+" method")}function x(e,t){var n,r=e,i=t;if(null!==e&&"object"==typeof e&&e.hasOwnProperty("v")&&(r=e.v,null!==t&&"object"==typeof t&&t.hasOwnProperty("v")&&(i=t.v)),h(r)&&h(i)){if(r.length!==i.length)return!1;for(n=0;n<r.length;n++)if(r[n]!=i[n])return!1;return!0}return r==i}function K(e,t,n){var r,i,s,a;for(r in t)t.hasOwnProperty(r)&&((i=t[r]).volatile||i.virtual||"string"==typeof(a=e[s=n?i.index:r])&&(e[s]=a.replace(/\r\n/g,"\n")))}function b(e,t,n,r,i){var s,a,o,d,l,h,c,u,f,g,_,y=e._options,v=t.record,I=e._getIdentity(v),m=[];for(function t(n,r,i){var s,a,o,d;for(s=0;s<n.length;s++)a=n[s],(o=y.fields[a])&&!r[a]&&(o.dependsOn&&t(o.dependsOn,r,i),r[a]||!o.calcValue&&!o.dependsOn||(i.push(a),r[a]=1,(d=e._dependentFields[a])&&t(d,r,i)))}(n,i||{},m),s=0;s<m.length;s++)if(o=m[s],(d=y.fields[o]).calcValue){for(f=[],a=0;a<d.dependsOn.length;a++)g=":"===(c=d.dependsOn[a]).substr(0,1)?apex.item(c.substr(1)).getValue():e.getValue(v,c),f.push(g);if(_=d.calcValue(f,e,v),l=e.getFieldKey(o),t.fields&&t.fields[o]&&t.fields[o].ck)throw new Error("Set calculated value not allowed for field.");x(h=v[l],_)||(v[l]=_,t.fields||(t.fields={}),(u=t.fields[o])||(u={},t.fields[o]=u),u.changed=!0,r&&p(e,"set",{oldValue:h,oldIdentity:null,recordId:I,record:v,field:o}),e._checkAggregates(o))}else(u=t.fields[o])||(u={},t.fields[o]=u),u.stale=!0,r&&e.metadataChanged(I,o)}function D(e,t){var n,r,i={},s=t.record,a=[];for(n=0;n<e._calculatedFields.length;n++)r=e._calculatedFields[n],null==s[e.getFieldKey(r)]?a.push(r):i[r]=1;a.length>0&&b(e,t,a,!1,i)}var O=/^\s*([+-]?(?:(?:[0-9]+\.[0-9]*)|(?:\.[0-9]+))(?:[eE][+-]?[0-9]+)?[fFdD]?|[+-]?[0-9]+)\s*$/;function C(e){return""===e||null===e?null:"string"==typeof e&&O.test(e)?parseFloat(e):"number"==typeof e?e:NaN}var M={SUM:{name:"SUM",init:function(e,t){if(t&&"NUMBER"!==t)throw new Error("Wrong data type for SUM aggregate");e.total=0,e.grandTotal=0},add:function(e,t){null===(t=C(t))||isNaN(t)||(e.total+=t,e.grandTotal+=t)},get:function(e,t){var n=t?e.total:e.grandTotal;return t&&(e.total=0),n}},AVG:{name:"AVG",init:function(e,t){if(t&&"NUMBER"!==t)throw new Error("Wrong data type for AVG aggregate");e.total=0,e.grandTotal=0,e.count=0,e.totalCount=0},add:function(e,t){null===(t=C(t))||isNaN(t)||(e.total+=t,e.grandTotal+=t,e.count+=1,e.totalCount+=1)},get:function(e,t){var n=t?e.total/e.count:e.grandTotal/e.totalCount;return t&&(e.total=0,e.count=0),n}},MAX:{name:"MAX",init:function(e,t){e.dataType=t,e.max=null,e.overallMax=null},add:function(e,t){"NUMBER"===e.dataType?t=C(t):t.d&&(t=t.d),null===t||""===t.toString().trim()||isNaN(t)||((null===e.max||t>e.max)&&(e.max=t),(null===e.overallMax||t>e.overallMax)&&(e.overallMax=t))},get:function(e,t){var n=t?e.max:e.overallMax;return t&&(e.max=null),n}},MIN:{name:"MIN",init:function(e,t){e.dataType=t,e.min=null,e.overallMin=null},add:function(e,t){"NUMBER"===e.dataType?t=C(t):t.d&&(t=t.d),null===t||""===t.toString().trim()||isNaN(t)||((null===e.min||t<e.min)&&(e.min=t),(null===e.overallMin||t<e.overallMin)&&(e.overallMin=t))},get:function(e,t){var n=t?e.min:e.overallMin;return t&&(e.min=null),n}},MEDIAN:{name:"MEDIAN",init:function(e,t){e.values=[],e.allValues=[]},add:function(e,t){null===(t=C(t))||isNaN(t)||(e.values.push(t),e.allValues.push(t))},get:function(e,t){var n,r=t?e.values:e.allValues,i=r.length;return r.sort((function(e,t){return e-t})),n=i%2==0?(r[i/2]+r[i/2-1])/2:r[(i-1)/2],t&&(e.values=[]),n}},COUNT:{name:"COUNT",init:function(e){e.count=0,e.totalCount=0},add:function(e,t){t.v&&(t=t.v),null!==t&&""!==t.toString().trim()&&(e.count+=1,e.totalCount+=1)},get:function(e,t){var n=t?e.count:e.totalCount;return t&&(e.count=0),n}},COUNT_DISTINCT:{name:"COUNT_DISTINCT",init:function(e){e.count=0,e.totalCount=0,e.distinctValues={}},add:function(e,t){t.v&&(t=t.v),null!==t&&""!==t.toString().trim()&&(e.distinctValues[t]||(e.count+=1,e.totalCount+=1),e.distinctValues[t]=1)},get:function(e,t){var n=t?e.count:e.totalCount;return t&&(e.count=0),n}}},S={modelId:function(){return null===this.instance?this.name:[this.name,this.instance]},fetch:function(e,t,n){var r,i,s,a,o,d,h,c,u,g=this,_=this._options,p=f();if("number"!=typeof e&&(n=t,t=e,e=0),"table"===_.shape){if(c=e,u=_.pageSize,h=Math.floor(c/u)*u,e=function(e){var t,n=g._data;if(0===e)return 0;for(t=e;t<n.length&&void 0!==n[t];t++);return t}(h),this._haveAllData&&e>=this._data.length||this._masterRecordIsInserted||this._masterRecordIsDeleted)return!1;d=this._getServerOffset(e),(o=h+_.pageSize-e)<_.pageSize&&void 0===this._data[h+_.pageSize]&&(o+=_.pageSize),a={version:_.version,firstRow:d+1,maxRows:o}}else a={version:_.version};return this._requestsInProgress.fetch?null:(i={regions:[l({},_.regionData,{id:_.regionId,ajaxIdentifier:_.ajaxIdentifier,fetchData:l({},_.fetchData,a)})]},_.pageItemsToSubmit&&(i.pageItems=_.pageItemsToSubmit),this._addParentItems(i.regions[0]),s=l({},_.requestOptions),n?delete s.loadingIndicator:s.loadingIndicator=I(this),this._requestsInProgress.fetch=!0,this._callServer(i,s).done((function(t){var n,r=null,i=null,s=null,a=null,o=null;delete g._requestsInProgress.fetch,g._requestsInProgress.abortFetch?(delete g._requestsInProgress.abortFetch,p.reject(m("Error: Aborted when model cleared",{status:0}))):(n=t.regions[0].fetchedData,"table"===_.shape?(r=n.values,i=n.totalRows,s=n.firstRow-1,a=n.moreData,o=n.dataOverflow):"tree"===_.shape?r=n.root:"record"===_.shape&&(r=n.value),g._addData(e,s,r,i,a,o),p.resolve())})).fail((function(e,t,n){delete g._requestsInProgress.fetch,p.reject(m("Error retrieving data.",e,0,n))})),r=p.promise(),t&&r.always(t),r.always((function(e){g._drainWaiters(e)})),r)},fetchAll:function(e){var t=this,n=0,r=this._options,i=r.pageSize;if("table"!==r.shape)throw F("fetchAll");for(;this._data[n];)n+=1;!function r(){var s=t.fetch(n,(function(s){s?e({error:s}):(e({offset:n,total:t.getTotalRecords(),done:!1}),n+=i,r())}),!0);null===s?setTimeout((function(){r()}),500):!1===s&&e({offset:n,total:t.getTotalRecords(),done:!0})}()},fetchRecords:function(e,t){var n,r,i,s,a,o,d=this,h=this._options,c=[],u=f();if("record"===h.shape)throw F("fetchRecords");if(void 0===this._identityKeys)throw new Error("Model must have identityField defined");for(n=0;n<e.length;n++)r=this._getIdentity(e[n]),(i=this.getRecordMetadata(r))&&!i.inserted&&c.push({recordId:r,pk:this._getPrimaryKey(e[n])});return 0===c.length?null:(a={regions:[l({},h.regionData,{id:h.regionId,ajaxIdentifier:h.ajaxIdentifier,fetchData:l({},h.fetchData,{version:h.version,primaryKeys:c})})]},h.pageItemsToSubmit&&(a.pageItems=h.pageItemsToSubmit),this._addParentItems(a.regions[0]),o=l({},h.requestOptions,{loadingIndicator:I(this)}),this._callServer(a,o).done((function(e){var t;t=e.regions[0].fetchedData.values,d._updateData(t),u.resolve()})).fail((function(e,t,n){u.reject(m("Error retrieving data.",e,0,n))})),s=u.promise(),t&&s.always(t),s)},save:function(e){var t,n,r,i,s,a=this._options,o=f();return s=l({},a.requestOptions,{loadingIndicator:I(this)}),i={},(n=this.addChangesToSaveRequest(i))?(n(t=this._callServer(i,s)),t.done((function(e){e.errors?o.reject(e.errors):o.resolve(null,e)})).fail((function(e,t,n){o.reject(m("Error saving data.",e,0,n))})),r=o.promise(),e&&r.always(e),r):null},saveInProgress:function(){return!!this._requestsInProgress.save},addChangesToSaveRequest:function(e){var t,n,r,i,s,a,o,d,c,u,f=this,g=this._options,p=this._metaKey,y=[],v=[],I={},m=[],w=0;function R(){delete f._requestsInProgress.save,f._changes=f._pendingChanges.concat(f._changes)}function F(e){var t,n,r,i,s,a,o,d=e.record;for(a=e.inserted&&!e.originalId,n=g.recordIsArray?[]:{},t=0;t<v.length;t++)null!==(r=d[i=v[t]])&&"object"==typeof r&&r.hasOwnProperty("v")&&(r=r.v),o=I[i],e.fields&&e.fields[o]&&e.fields[o].disabled&&(r=""),!a||!f.isIdentityField(o)||e.original&&r!==e.original[i]||(r=""),"string"==typeof r&&(r=r.replace(/\n/g,"\r\n")),g.recordIsArray?n.push(_(r)):n[i]=_(r);s=null,e.deleted?s="d":e.inserted?s="i":e.updated&&(s="u"),n[p]||(n[p]={}),s&&(n[p].op=s),n[p].recordId=f._getIdentity(d),e.originalId&&(n[p].originalId=e.originalId),g.saveSelection&&(n[p].sel=e.sel?"Y":"N"),m.push(n)}if(g.pageItemsToSubmit&&((i=e.pageItems)||(i=[],e.pageItems=i),h(i)))for(s=g.pageItemsToSubmit,h(s)||(s=s.replace(/#/g,"").split(/\s*,\s*/)),t=0;t<s.length;t++)i.indexOf(s[t])<0&&i.push(s[t]);if(this._requestsInProgress.save||0===this._changes.length&&!g.saveSelection)return null;for(t in g.fields)g.fields.hasOwnProperty(t)&&((n=g.fields[t]).virtual||(w+=1),n.volatile||n.virtual||(r=g.recordIsArray?n.index:t,v.push(r),I[r]=t,g.recordIsArray&&n.index===this._metaKey&&(p=v.length-1)));for(g.recordIsArray&&v.sort((function(e,t){return e-t})),p||(p=g.recordIsArray?v.length:"_meta"),t=0;t<this._changes.length;t++)(a=this._changes[t]).autoInserted&&!a.updated&&y.push(a.record);for(y.length&&this.deleteRecords(y),t=0;t<this._changes.length;t++)F(a=this._changes[t]);if(this._pendingChanges=this._changes,this._changes=[],g.saveSelection)for(t in this._selection)this._selection.hasOwnProperty(t)&&((a=this._selection[t]).inserted||a.deleted||a.updated||F(a));for((o=e.regions)||(e.regions=o=[]),t=0;t<o.length&&(d=o[t]).id!==g.regionId;t++)d=null;return d||(d=l({},g.regionData,{id:g.regionId,ajaxIdentifier:g.ajaxIdentifier,saveData:{models:[]}}),o.push(d)),c=d.saveData.models,u=l({},g.saveData,{instance:this.instance,version:g.version,values:m}),this._addParentItems(u),c.push(u),this._requestsInProgress.save=!0,function(e){e.done((function(e){var t,n,r,i,s,a,o;if(f._requestsInProgress.abortSave)delete f._requestsInProgress.abortSave,R();else if(e.errors){for(t=0;t<e.errors.length;t++)(a=e.errors[t]).regionStaticId===g.regionStaticId&&a.recordId&&a.instance==f.instance&&f.setValidity("error",a.recordId,a.columnName||null,a.message);R()}else if(e.regions){for(s=null,t=0;t<e.regions.length;t++){if((r=e.regions[t]).id===g.regionId){for(i=r.fetchedData.models,n=0;n<i.length;n++)if(i[n].instance==f.instance){s=i[n].values,f._metaKey||(o=g.recordIsArray?w:"_meta"),f._updateData(s,o);break}break}r=null}f._clearChanges("_pendingChanges")}delete f._requestsInProgress.save})).fail((function(e,t,n){R()}))}},setData:function(e,t){t=t||0,this._addData(t,t,e,e?e.length:null,!1,!1),p(this,"refresh",{})},clearData:function(){this._clear(),p(this,"refresh",{})},getTotalRecords:function(){var e,t,n=this._options;if("table"===n.shape)return this._haveAllData||"none"===n.paginationType?this._data.length:this._totalRecords<0?this._totalRecords:Math.max(this._data.length,this._totalRecords);if("record"===n.shape)return 1;if("tree"===n.shape){for(e in t=0,this._index)this._index.hasOwnProperty(e)&&(t+=1);return t}},getServerTotalRecords:function(){var e=this._options;return"table"===e.shape?this._totalRecords<0?this._totalRecords:this._totalRecords+this._numInsertedRecords-this._numDeletedRecords:"record"===e.shape?1:"tree"===e.shape?-1:void 0},getDataOverflow:function(){return!!this.dataOverflow},forEach:function(e,t){var n,r,i,s=this,a=this._options,o=this._data;if("record"===a.shape)throw F("forEach");if("tree"===a.shape)n=0,o&&this.walkTree(o,{node:function(r){y(t,e,r,n,s._getIdentity(r)),n+=1}});else for(i=o.length,n=0;n<i;n++)(r=o[n])&&y(t,e,r,n,this._getIdentity(r,n))},transform:function(e,t){var n,r,i,s,a,o=/^\[\W*([^ \t\/]+)\W*\]$/,d=e.template,l=e.showNullAs,c=d.length,f=[],g={},_=this;function p(e,t){var n;return(n=e[t])||(n={values:{},paths:[]},e[t]=n),n}function y(e,t,n,r,i,s){var a,d,l,c,u,f,g,_;if(e){for(u=e.split("/"),f=r,g=null,_=null,l=null,a=0;a<u.length;a++){if(l=u[a],d=o.exec(l)){p(s,d[1]).paths[t]=u.slice(a+1).join("/");break}g=f,_=l,f.hasOwnProperty(l)||(f[l]={}),f=f[l]}g?(h(g[_])?(c=g[_]).length=0:c=[],g[_]=c):c=r,i[t]=c}else{if(!h(r))throw new Error("Context must be an array when there is no path");i[t]=r}n&&p(s,n)}function v(e,n,r,i){var s,a,o,d,c=!1;return"string"==typeof e?(s=e.length,o=e.charAt(0),d=e.charAt(s-1),"'"===o&&"'"===d?e.substring(1,s-1):("("===o&&")"===d&&(e=e.substring(1,s-1),c=!0),null!==(a=_.getValue(n,e))&&"object"==typeof a&&a.hasOwnProperty("d")&&(a=c?a.v:a.d),c||!l||null!==a&&""!==a||(a=l),a)):u(e)?e.call(t,_,n,r,i):null===e?e:h(e)?function(e,t,n,r,i){var s,a;for(s=0;s<e.length;s++)void 0!==(a=v(e[s],n,r,i))&&(t[s]=a);return t}(e,[],n,r,i):"object"==typeof e?function(e,t,n,r,i){var s,a;for(s in e)e.hasOwnProperty(s)&&void 0!==(a=v(e[s],n,r,i))&&(t[s]=a);return t}(e,{},n,r,i):void 0}function I(e,t,n,r){var i,s,a,d=[];if(e)for(e=e.split("/"),i=0;i<e.length;i++)s=e[i],(a=o.exec(s))&&d.push({key:a[1],value:v(a[1],t,n,r)});return d}function m(n,r,i){var o,l,h,u,m,w,R,F,x,K,b;if(!(r<s||a>0&&r>=s+a)&&(e.includeAggregates||!_._metaKey||!n[_._metaKey].agg)&&(!e.filter||e.filter.call(t,_,n,r,i)))for(o=0;o<c;o++)if(w=null,h=d[o],u=f[o],!h.filter||h.filter.call(t,_,n,r,i)){if(h.uniqueIndexField&&(w=g[h.uniqueIndexField],R=v(h.uniqueIndexField,n,r,i),void 0!==w.values[R]))continue;if(void 0!==(m=v(h.item,n,r,i))){if(w)w.values[R]={index:u.length,arrays:[],indexes:{}};else for(F=I(h.path,n,r,i),b=g,l=0;l<F.length;l++)void 0===(x=(w=p(b,F[l].key)).values[F[l].value])&&(x={index:u.length,arrays:[],indexes:{}},K=""===w.paths[o]?[]:{},u.push(K),w.values[F[l].value]=x),K=u[x.index],x.arrays[o]||y(w.paths[o],o,null,K,x.arrays,x.indexes),u=x.arrays[o],b=x.indexes;u.push(m)}}}for(null!==t&&"object"==typeof t||(t={}),function(){var e,n;for(e=0;e<d.length;e++)y((n=d[e]).path,e,n.uniqueIndexField,t,f,g)}(),s=0,e.offset>=0&&(s=e.offset),a=e.fetchData?this._options.pageSize:null,e.count>0&&(a=e.count),e.fetchData?this.forEachInPage(s,a,m):this.forEach(m),n=0;n<c;n++)r=d[n],i=f[n],r.sort&&i.array.sort(r.sort);return t},forEachInPage:function(e,t,r,i){var s,a,o,d,l=e,h=this,c=this._options,u=this._data;function f(s){var a=t-(s-e);n.trace("Model: "+h.modelId()+". forEachInPage fetching more data starting at: ",s),h._waitingPages.push({offset:s,callback:r,thisArg:i,next:function(){h.forEachInPage(s,a,r,i)}}),h._requestsInProgress.fetch||h.fetch(s,(function(e){e||setTimeout((function(){h._waitingPages.length>0&&h._waitingPages.shift().next()}),1)}))||(h._waitingPages.pop(),y(i,r,null,-1,null))}if("table"!==c.shape)throw F("forEachInPage");if(t>c.pageSize&&(c.pageSize=10*Math.floor((t+9)/10)),"one"===c.paginationType&&(l=e-this._offset),l<0||l>=u.length)this._haveAllData?(y(i,r,null,-1,null),this._drainWaiters()):f(e);else{for(a=l+t,d=e,s=l;s<a;s++){if(void 0===(o=u[s]))return void(this._haveAllData&&s>=u.length?(y(i,r,null,-1,null),this._drainWaiters()):f(s+this._offset));o&&(y(i,r,o,d,this._getIdentity(o,s)),d+=1)}this._drainWaiters()}},indexOf:function(e){var t,n=this._options;if("record"===n.shape)throw F("indexOf");return"tree"===n.shape?(t=this.getRecordMetadata(this._getIdentity(e)))&&t.parent?t.parent[this._childrenKey].indexOf(e):-1:this._data.indexOf(e)},recordAt:function(e){if("table"!==this._options.shape)throw F("recordAt");return this._data[e]||null},getRecordId:function(e){return this._getIdentity(e)},getAggregateRecord:function(e,t){var n,r,i,s,a=null;if(t>=0){if(i=this._breakEndIds[t],(n=this.indexOf(this.getRecord(i)))>=0)for(s=!1;n<this._data.length;n++)if((r=(a=this._data[n])[this._metaKey])&&r.agg){if(s=!0,r.agg===e)break}else if(s){a=null;break}}else for(n=this._data.length-1;n>=0;n--){if(!((r=(a=this._data[n])[this._metaKey])&&r.agg&&r.grandTotal)){a=null;break}if(r.agg===e)break}return a},isIdentityField:function(e){return void 0!==this._identityKeys&&this._identityKeys.indexOf(this.getFieldKey(e))>=0},getRecordMetadata:function(e){return this._index[v(e)]||null},metadataChanged:function(e,t){var n=this._index[v(e)];n&&p(this,"metaChange",{record:n.record,recordId:e,field:t||null})},getTypeMetadata:function(e){return this._options.types[e]||null},getFieldMetadata:function(e){return this._options.fields[e]||null},getFieldKey:function(e){var t=this._options;if(t.fields.hasOwnProperty(e)&&!t.fields[e].virtual)return t.recordIsArray?t.fields[e].index:e},isChanged:function(){var e,t,n;if(0===this._changes.length)return!1;for(n=0,e=0;e<this._changes.length;e++)(t=this._changes[e]).autoInserted&&!t.updated||(n+=1);return n>0},getChanges:function(){return this._changes},clearChanges:function(){this._clearChanges("_changes")},hasErrors:function(){return this._errors.length>0},getErrors:function(){return this._errors},setSelectionState:function(e,t){var n=v(e),r=this._index[n];r&&(t=!!t,r.sel!==t&&(r.sel=t,t?(this._selection[n]=r,this._selectionCount+=1):(delete this._selection[n],this._selectionCount-=1)))},clearSelection:function(){var e;for(e in this._selection)this._selection.hasOwnProperty(e)&&(this._selection[e].sel=!1);this._selection={},this._selectionCount=0},getSelectedCount:function(){return this._selectionCount},getSelectedRecords:function(){var e,t=this._selection,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e].record);return n},allowEdit:function(e){return this.check("canEdit",e)},allowDelete:function(e){var t=this._options;return"record"!==t.shape&&("tree"!==t.shape||e!==this._data)&&this.check("canDelete",e)},allowAdd:function(e,t,n){var r,i,s,a,o=this._options;if("record"===o.shape)return!1;if(!("tree"!==o.shape||e&&e[this._childrenKey]))return!1;if((s=this.check("canAdd",e,t,n))&&n&&"tree"===o.shape&&!0!==(i=void 0!==(a=this._getType(e)).validChildren?a.validChildren:void 0===o.types.default.validChildren||o.types.default.validChildren))for(r=0;r<n.length;r++)if(i.indexOf(n[r][this._typeKey])<0){s=!1;break}return s},allowDrag:function(e){return"record"!==this._options.shape&&this.check("canDrag",e)},dragOperations:function(e){var t,n,r,i=this._options;if(e){if(e.length>0&&this._typeKey){for(r=e[0][this._typeKey]||"default",t=1;t<e.length;t++)if((e[t][this._typeKey]||"default")!==r){r="default";break}}else r="default";n=i.types[r].operations&&void 0!==i.types[r].operations.drag?i.types[r].operations.drag:i.types.default.operations.drag}else n=i.types.default.operations.externalDrag;return n},check:function(e,t,n,r){var i,s=!1,a=this._options,o=this._getType(t);if(!a.editable||this._masterRecordIsDeleted)return!1;if(t&&(i=this.getRecordMetadata(this._getIdentity(t)))){if(i.deleted||i.agg)return!1;if(i.inserted&&("canEdit"===e||"canDelete"===e))return!0}return i&&void 0!==i[e]?s=i[e]:o.operations&&void 0!==o.operations[e]?s=o.operations[e]:void 0!==a.types.default.operations[e]&&(s=a.types.default.operations[e]),u(s)&&(s=s.call(this,t,n,r)),u(a.check)&&(s=a.check(s,e,t,n,r)),s},getValue:function(e,t){return void 0===t&&(t=e,e=this._data),e[this.getFieldKey(t)]},setValue:function(e,t,n,r){var i,s,a,o,d,l,c,u,f,g,y,v,I,m=this._options,w=!1;if(void 0===n&&(n=t,t=e,e=this._data),a=this.getFieldKey(t),!this.allowEdit(e))throw new Error("Set value not allowed for record.");if(c=this._getIdentity(e),!(o=this.getRecordMetadata(c)))return null;if(I=m.fields[t],void 0===a||I.readonly&&!I.parentField||o.fields&&o.fields[t]&&o.fields[t].ck)throw new Error("Set value not allowed for field.");if(!x(s=e[a],n)){if(!r&&(t===m.sequenceField||t===m.parentIdentityField))if(u=f=g=null,t===m.sequenceField){if("tree"===m.shape?(f=this.parent())&&(u=f[this._childrenKey]):u=this._data,u)for(i=0;i<u.length&&!(parseFloat(u[i][this._sequenceKey])>parseFloat(n));i++)g=u[i]}else t===m.parentIdentityField&&(f=this.getRecord(n));if(o.original||(o.original=function(e){var t,n;if(h(e))for(n=[],t=0;t<e.length;t++)n[t]=_(e[t]);else for(t in n={},e)e.hasOwnProperty(t)&&(n[t]=_(e[t]));return n}(e),w=!0),e[a]=n,(l=this._getIdentity(e))!==c){if(this._index[l])return e[a]=s,w&&delete o.original,"DUP";o.originalId||(o.originalId=c),delete this._index[c],this._index[l]=o,o.sel&&(delete this._selection[c],this._selection[l]=o)}return o.updated||o.deleted||o.inserted||this._addChange(o),o.updated=!0,o.fields||(o.fields={}),(d=o.fields[t])||(d={},o.fields[t]=d),d.changed=!0,(o.error||o.warning)&&this.setValidity("valid",l),p(this,"set",{oldValue:s,oldIdentity:l!==c?c:null,recordId:l,record:e,field:t}),this._checkAggregates(t),(y=this._dependentFields[t])&&(I.calcValue&&((v={})[t]=1),b(this,o,y,!0,v)),(f||g)&&this.moveRecords([e],f,g),"SET"}return"NC"},getRecordValue:function(e,t){return this.getValue(this.getRecord(e),t)},setRecordValue:function(e,t,n){this.setValue(this.getRecord(e),t,n)},setValidity:function(e,t,n,r){var i,s,a,o,d,l,h,c=this._index[v(t)];if(c&&(n?(c.fields||(c.fields={}),(a=c.fields[n])||(a={},c.fields[n]=a)):a=c,l="valid",h=a.message||r,a.warning&&(l="warning"),a.error&&(l="error"),e!==l||h!==r)){switch(e){case"error":s="error",delete a.warning;break;case"warning":s="warning",delete a.error;break;case"valid":delete a.error,delete a.warning,delete a.message;break;default:throw new Error("Invalid value for pValidity parameter: "+e)}if(s&&(a[s]=!0,a.message=r),!(o=c.error)&&c.fields)for(i in c.fields)if(c.fields.hasOwnProperty(i)&&c.fields[i].error){o=!0;break}o?((d=this._errors.indexOf(c))>=0&&this._errors.splice(d,1),this._errors.push(c)):this._removeError(c),this.metadataChanged(t,n)}},deleteRecords:function(e){var t,r,i,s,a=[],o=[],d=this._options;if("record"===d.shape)throw F("deleteRecords");for(t=0;t<e.length;t++)s=e[t],i=this._getIdentity(s),(r=this.getRecordMetadata(i))?this.allowDelete(s)?("table"===d.shape&&(this._numDeletedRecords+=1),d.onlyMarkForDelete&&!r.inserted||("table"===d.shape&&r.inserted&&(this._numDeletedRecords-=1,this._numInsertedRecords-=1),this._removeRecord(i,r)),r.inserted?(delete r.inserted,delete r.autoInserted,delete r.updated,this._removeError(r),this._removeChange(r)):(w(r,!0),this._removeError(r),r.deleted=!0,this._addChange(r)),a.push(s),o.push(i)):n.warn("Delete not allowed for record: "+i):n.warn("Record to delete not found: "+i);return a.length>0&&(p(this,"delete",{records:a,recordIds:o}),this._checkAggregates()),a.length},canRevertRecord:function(e){var t;return!(!(t=this.getRecordMetadata(this._getIdentity(e)))||!t.original&&!t.deleted)},revertRecords:function(e){var t,r,i,s,a,o,d={},l=[],h=[],c=this._options;for(t=0;t<e.length;t++)i=e[t],s=this._getIdentity(i),(r=this.getRecordMetadata(s))?r.original||r.deleted?("table"===c.shape?a=this._data:"tree"===c.shape&&(a=this.parent(r.record)[this._childrenKey]),o=a.indexOf(r.record),r.deleted?("table"===c.shape&&(this._numDeletedRecords-=1),delete r.deleted):(r.originalId&&(this._index[r.originalId]=r,delete this._index[s],r.sel&&(this._selection[r.originalId]=r,delete this._selection[s]),d[s]=r.originalId,delete r.originalId),r.original&&(r.record=r.original,delete r.original),delete r.updated,w(r),this._removeError(r)),this._removeChange(r),i=r.record,a[o]!==i&&(a[o]=i),l.push(i),h.push(s)):n.warn("Nothing to revert for record "+s):n.warn("Record to revert not found: "+s);return l.length>0&&(p(this,"revert",{records:l,recordIds:h,newIds:d}),this._checkAggregates()),l.length},insertNewRecord:function(e,t,n){var r,i,s,a,o,d,l,h=this._options,c=null;if("record"===h.shape)throw F("insertNewRecord");if(a=this._initRecord(n,null,e),!this.allowAdd(e,"new",[a]))throw new Error("Insert not allowed for new record.");return o="tree"===h.shape?e?e[this._childrenKey]:this._data[this._childrenKey]:this._data,i=0,t&&(c=this._getIdentity(t),(r=this.getRecordMetadata(c))&&(i=o.indexOf(r.record)+1)),this._sequenceKey&&(d=l=-1,i-1>=0&&(d=parseFloat(o[i-1][this._sequenceKey])),i<o.length&&(l=parseFloat(o[i][this._sequenceKey])),a[this._sequenceKey]=""+R(h.sequenceStep,d,l,1,1)),o.splice(i,0,a),s=this._getIdentity(a),r={record:a,inserted:!0},this._index[s]=r,this._addChange(r),"tree"===h.shape?r.parent=e:this._numInsertedRecords+=1,D(this,r),p(this,"insert",{record:a,recordId:s,insertAfterId:c}),s},moveRecords:function(e,t,r){var i,s,a,o,d,l,h,c,u,f,g=this._options,_=[],y=[],v=null;if("record"===g.shape)throw F("moveRecords");for("tree"===g.shape?(t||(t=this._data),o=t[this._childrenKey]):o=this._data,a=0,r&&(v=this._getIdentity(r),(s=this.getRecordMetadata(v))&&(a=o.indexOf(s.record)+1),(!s||a<0)&&(n.warn("AfterRecord not found, move to beginning."),a=0)),this._sequenceKey&&(u=f=-1,a-1>=0&&(u=parseFloat(o[a-1][this._sequenceKey])),a<o.length&&(f=parseFloat(o[a][this._sequenceKey]))),i=0;i<e.length;i++)if(h=e[i],c=this._getIdentity(h),s=this.getRecordMetadata(c)){if("tree"===g.shape){if(!(d=this.parent(h))){n.warn("Move not allowed for root");continue}d=d[this._childrenKey]}else d=o;l=d.indexOf(h),d.splice(l,1),o===d&&l<a&&(a-=1),y.push(h),_.push(c),o.splice(a,0,h),a+=1,this._sequenceKey&&this.setValue(h,g.sequenceField,""+R(g.sequenceStep,u,f,e.length,i+1),!0),"tree"===g.shape&&(s.parent=t,this._parentIdKey&&this.setValue(h,g.parentIdentityField,this._getIdentity(t),!0))}else n.warn("Record to move not found: "+c);return p(this,"move",{records:y,recordIds:_,insertAfterId:v}),_},copyRecords:function(e,t,r){var i,s,a,o,d,l,h,c,u,f,g,_=this,y=this._options,v=[],I=[],m=null;if("record"===y.shape)throw F("copyRecords");for("tree"===y.shape?(u={node:function(e,t){var n,r;t&&(n=_._getIdentity(e),r={record:e,inserted:!0,parent:t},_._index[n]=r,_._addChange(r))}},t||(t=this._data),h=t[this._childrenKey]):h=this._data,a=0,r&&(m=this._getIdentity(r),(s=this.getRecordMetadata(m))&&(a=h.indexOf(s.record)+1),(!s||a<0)&&(n.warn("AfterRecord not found, copy to beginning."),a=0)),this._sequenceKey&&(f=g=-1,a-1>=0&&(f=parseFloat(h[a-1][this._sequenceKey])),a<h.length&&(g=parseFloat(h[a][this._sequenceKey]))),i=0;i<e.length;i++)o=e[i],l=this._getIdentity(o),(s=this.getRecordMetadata(l))?(d=this._initRecord(null,e[i],t),h.splice(a,0,d),a+=1,this._sequenceKey&&(d[this._sequenceKey]=""+R(y.sequenceStep,f,g,e.length,i+1)),c=this._getIdentity(d),I.push(d),v.push(c),s={record:d,inserted:!0},this._index[c]=s,this._addChange(s),"tree"===y.shape?(s.parent=t,this.walkTree(d,u,null)):this._numInsertedRecords+=1):n.warn("Record to copy not found: "+l);return p(this,"copy",{records:I,recordIds:v,insertAfterId:m}),this._checkAggregates(),v},root:function(){if("tree"!==this._options.shape)throw F("root");return this._data},child:function(e,t){var n=e[this._childrenKey];if(n)return n[t]},parent:function(e){var t,n;if(this._identityKeys&&(t=this._getIdentity(e),(n=this.getRecordMetadata(t))&&n.hasOwnProperty("parent")))return n.parent?n.parent:null},childCount:function(e){var t=e[this._childrenKey];return null===t?null:t?t.length:0},hasChildren:function(e){var t=e[this._childrenKey];return null===t?null:!!t&&t.length>0},fetchChildNodes:function(e,t){var n,r,i,s=this,a=this._options,o=f();return r={regions:[l({},a.regionData,{id:a.regionId,ajaxIdentifier:a.ajaxIdentifier,fetchData:l({},a.fetchData,{version:a.version,parentId:this._getPrimaryKey(e)})})]},a.pageItemsToSubmit&&(r.pageItems=a.pageItemsToSubmit),this._addParentItems(r.regions[0]),i=l({},a.requestOptions,{loadingIndicator:I(this)}),this._callServer(r,i).done((function(t){var n=t[s._childrenKey];s._addData(e,null,n),o.resolve(n.length)})).fail((function(e,t,n){o.reject(m("Error retrieving data.",e,0,n))})),n=o.promise(),t&&n.always(t),n},clearChildNodes:function(e){e[this._childrenKey];e[this._childrenKey]=null},walkTree:function(e,t,n){var r,i,s,a;if(void 0===n&&(n=null,(i=this._getIdentity(e))&&(s=this.getRecordMetadata(i))&&(n=s)),!t.node(e,n)&&(a=e[this._childrenKey])&&a.length>0){for(t.beginChildren&&t.beginChildren(e),r=0;r<a.length;r++)this.walkTree(a[r],t,e);t.endChildren&&t.endChildren(e)}},subscribe:function(e){var t=e.viewId;return t||(t="v::"+o,o+=1,e.viewId=t),this._listeners.push(e),t},unSubscribe:function(e){var t;for(t=0;t<this._listeners.length;t++)this._listeners[t].viewId===e&&this._listeners.splice(t,1)},getOption:function(e){var t=this._options[e];if(void 0===t)throw new Error("No such option: "+e);return t},setOption:function(e,t){if({genIdPrefix:1,pageItemsToSubmit:1,fetchData:1,saveData:1,regionData:1,requestOptions:1,parentRecordId:1,editable:1,pageSize:1}[e]){if("editable"===e&&!this._options.identityField)throw new Error("An editable model requires an identityField");this._options[e]=t}else n.warn("Option cannot be set: "+e)},_callServer:function(e,n){return(this._options.callServer||t.plugin)(e,n)},_drainWaiters:function(e){var t,n;for(t=0;t<this._waitingPages.length;t++)if(n=this._waitingPages[t],(this._haveAllData||this._data[n.offset]||e)&&(this._waitingPages.splice(t,1),t-=1,e&&0!==e.status?y(n.thisArg,n.callback,null,-1,null):n.next(),this._requestsInProgress.fetch))return},_getServerOffset:function(e){var t,n,r,i=e-1;for(r=this._data[i];r;){if(t=this._getIdentity(r,i),(n=this.getRecordMetadata(t))&&n.serverOffset>=0)return n.serverOffset+1;i-=1,r=this._data[i]}return e},_clear:function(){var e=this._options;this._requestsInProgress.fetch&&(this._requestsInProgress.abortFetch=!0),this._requestsInProgress.save&&(this._requestsInProgress.abortSave=!0),"table"===e.shape?(this._data=[],e.hasTotalRecords?this._totalRecords=0:this._totalRecords=-1,this._haveAllData=!1,this._offset=0,this._numInsertedRecords=0,this._numDeletedRecords=0,this._masterRecordIsInserted&&(this._haveAllData=!0),this.dataOverflow=!1):this._data=null,this._changes=[],this._errors=[],this._index={},this._breakEndIds=[],this._selection={},this._selectionCount=0},_saveDataState:function(){this._saveState={_data:this._data,_totalRecords:this._totalRecords,_haveALlData:this._haveAllData,_offset:this._offset,_numInsertedRecords:this._numInsertedRecords,_numDeletedRecords:this._numDeletedRecords,dataOverflow:this.dataOverflow,_changes:this._changes,_errors:this._errors,_index:this._index,_breakEndIds:this._breakEndIds,_selection:this._selection,_selectionCount:this._selectionCount}},_restoreDataState:function(){var e=this._saveState;this._data=e._data,this._totalRecords=e._totalRecords,this._haveALlData=e._haveAllData,this._offset=e._offset,this._numInsertedRecords=e._numInsertedRecords,this._numDeletedRecords=e._numDeletedRecords,this.dataOverflow=e.dataOverflow,this._changes=e._changes,this._errors=e._errors,this._index=e._index,this._breakEndIds=e._breakEndIds,this._selection=e._selection,this._selectionCount=e._selectionCount},_clearChanges:function(e){var t,n,r,i=[],s=[],a=this._options,o=this[e];for(t=0;t<o.length;t++)n=o[t],r=this._getIdentity(n.record),n.deleted&&a.onlyMarkForDelete&&this._removeRecord(r,n),n.deleted?i.push(r):(n.inserted||n.updated)&&s.push(r),delete n.deleted,delete n.recordId,delete n.inserted,delete n.autoInserted,delete n.updated,delete n.original;this[e]=[],p(this,"clearChanges",{deletedIds:i,changedIds:s})},_addData:function(e,t,r,i,s,a){var o,d,h,c,u,f,g,_,y,v,I,m,w,R,F=this._options,x=this,b=this._calculatedFields.length>0;function O(e,t,n){var r={record:n};x._metaKey&&(l(r,n[x._metaKey]),r.sel="Y"===r.sel,r.agg&&(!e||x._identityKeys&&!n[x._identityKeys[0]])&&(x._assignTempIdentity(n),e=x._getIdentity(n)),r.allowedOperations&&(r.canEdit=!!r.allowedOperations.update,r.canDelete=!!r.allowedOperations.delete)),null!=t&&(r.serverOffset=t),x._index[e]=r,r.sel&&(x._selected[e]=r),K(n,F.fields,F.recordIsArray),b&&!r.agg&&D(x,r)}function C(e,t,n){var r,i,s,a,o,d;for(s=0,r=0;r<x._aggregateRecs.length;r++)t[i=x._aggregateRecs[r]]||(o=x._initRecord(!1),d={agg:i},n&&(d.grandTotal=n),o[x._metaKey]=d,a=e+s,x._data[a]?x._data.splice(a,0,o):x._data[a]=o,O(null,null,o),s+=1);return s}function M(){if(x._data.length>0&&x._haveAllData&&x._aggregateRecs.length>0){if(w){if(f&&f.grandTotal)for(o=x._data.length-1;o>=0&&(h=x._data[o],(f=x._metaKey&&h[x._metaKey])&&f.agg&&f.grandTotal);o--);C(o+1,R)}(o=C(x._data.length,R,!0))>0&&x._checkAggregates()}}if("table"===F.shape?((0===e&&!this.isChanged()||"none"===F.paginationType)&&this._clear(),"one"===F.paginationType&&(this._offset=e),this._totalRecords=-1,null!=i?this._totalRecords=i:F.hasTotalRecords&&n.warn("Model missing total records"),this._haveAllData||s||(this._haveAllData=!0),a&&(this.dataOverflow=!0)):"record"===F.shape&&this._clear(),"tree"===F.shape&&e)(_=e)[this._childrenKey]=r,F.identityField&&x.walkTree(_,{node:function(e,t){var n;t&&(O(n=x._getIdentity(e),null,e),x.getRecordMetadata(n).parent=t)}},null),p(this,"addData",{parentNode:_,offset:0,count:r.length});else if(null===this._data||0===this._data.length||"table"!==F.shape||"one"===F.paginationType){if(n.trace("Model: "+this.modelId()+". add data set: ",e,i,s),this._data=r,this._numInsertedRecords=0,this._numDeletedRecords=0,"record"!==F.shape)if(I={offset:0,count:r.length},y=t,"tree"===F.shape&&this.root()&&F.identityField)this.walkTree(this.root(),{node:function(e,t){c=x._getIdentity(e),x._metaKey&&h[x._metaKey].agg?v=null:(v=y,y+=1),O(c,v,e),x.getRecordMetadata(c).parent=t}},null),I.parentNode=null,I.count=1;else{for(w=!1,R={},o=0;o<this._data.length;o++)h=this._data[o],c=this._getIdentity(h,o),(f=this._metaKey&&h[this._metaKey])&&f.agg?(v=null,R[f.agg]=1):(v=y,y+=1,w&&(o+=C(o,R)),w=!1),f&&f.endControlBreak&&(this._breakEndIds.push(c),this._aggregateRecs.length>0&&(w=!0,R={})),O(c,v,h);M()}else F.identityField&&this._data?(I={offset:0,count:1},O(this._getIdentity(this._data),null,this._data)):I={offset:0,count:this._data?1:0};p(this,"addData",I)}else{for(n.trace("Model: "+this.modelId()+". add data merge: ",e,i,s),d=e,y=t,m=[],w=!1,R={},o=0;o<r.length;o++){if(h=r[o],c=this._getIdentity(h,d),(f=this._metaKey&&h[this._metaKey])&&f.agg?(v=null,R[f.agg]=1):(v=y,y+=1),g=this.getRecordMetadata(c)){if(g.updated||g.inserted||g.deleted)continue;u=this._data.indexOf(g.record),this._data[u]=h,K(h,F.fields,F.recordIsArray),g.record=h,g.serverOffset=v,f&&l(g,f),m.push(c),b&&!g.agg&&D(this,g)}else this._data[d]?this._data.splice(d,0,h):this._data[d]=h,d+=1,O(c,v,h);f&&(f.agg||(w&&(d+=C(d,R)),w=!1),f.endControlBreak&&(this._breakEndIds.push(c),this._aggregateRecs.length>0&&(w=!0,R={})))}M(),I={offset:e,count:d-e},m.length&&(I.replacedIds=m),p(this,"addData",I)}},_updateData:function(e,t){var n,r,i,s,a,o,d=this._options,h=!1,c=[],u=[],f=[],g=[],_={},y=t||this._metaKey;for(n=0;n<e.length;n++)s=(o=(r=e[n])[y])?o.recordId:null,o&&s&&o.notFound?(a=this.getRecordMetadata(s),this._removeRecord(s,a),f.push(a.record),g.push(s)):(s===(i=this._getIdentity(r))&&(s=null),(a=this.getRecordMetadata(s||i))&&(s&&(_[s]=i,this._index[i]=a,delete this._index[s],delete this._selection[s],this._selectionCount-=1),c.push(r),u.push(s||i),this._data[this._data.indexOf(a.record)]=r,K(r,d.fields,d.recordIsArray),a.record=r,y&&o?(l(!0,a,o),a.allowedOperations&&(a.canEdit=!!a.allowedOperations.update,a.canDelete=!!a.allowedOperations.delete),delete a.recordId):t&&(d.recordIsArray?r.splice(t,1):delete r[t]),D(this,a),delete a.deleted,delete a.inserted,delete a.autoInserted,delete a.updated,delete a.original,w(a),this._removeError(a),this._removeChange(a)));c.length>0&&(p(this,"refreshRecords",{records:c,recordIds:u,newIds:_}),h=!0),f.length>0&&(p(this,"delete",{records:f,recordIds:g}),h=!0),h&&this._checkAggregates()},_initRecord:function(t,n,r){var i,s,a,o,d,l,h,c,u,f,g=!0,_=this._options;if(t)l=t;else for(i in!1===t&&(g=!1),l=_.recordIsArray?[]:{},_.fields)if(_.fields.hasOwnProperty(i)&&(s=_.fields[i],a=_.recordIsArray?s.index:i,!s.virtual))if(!n||s.noCopy){if(s.parentField&&_.parentModel&&(h||(h=e.get(_.parentModel))&&!c&&_.parentRecordId&&(c=h.getRecord(_.parentRecordId)),c)){l[a]=h.getValue(c,s.parentField);continue}u="",g&&void 0!==(f=s.defaultValue)&&(u="function"==typeof f?f(this,n):f),l[a]=u}else l[a]=n[a];if(h&&e.release(_.parentModel),this._identityKeys&&this._assignTempIdentity(l),this._metaKey&&(l[this._metaKey]={}),"tree"===_.shape&&(this._parentIdKey&&(l[this._parentIdKey]=this._getIdentity(r)),d=[],l[this._childrenKey]=d,n&&(o=n[this._childrenKey])))for(i=0;i<o.length;i++)d.push(this._initRecord(null,o[i],l));return l},_assignTempIdentity:function(e){var t;for(t=0;t<this._identityKeys.length;t++)e[this._identityKeys[t]]=this._options.genIdPrefix+this._nextInsertId,this._nextInsertId+=1},_getIdentity:function(e,t){var n,r=null;if(void 0!==this._identityKeys)if(1===this._identityKeys.length)r=e[this._identityKeys[0]]+"";else for(r=[],n=0;n<this._identityKeys.length;n++)r.push(e[this._identityKeys[n]]+"");else null!=t&&(r=t+"");return null!==r?v(r):r},_getPrimaryKey:function(e){var t,n;if(void 0!==this._identityKeys)for(n=[],t=0;t<this._identityKeys.length;t++)n.push(e[this._identityKeys[t]]+"");return n},_getType:function(e){var t="default",n=this._options;return e&&void 0!==this._typeKey&&(null!==(t=e[this._typeKey])&&"object"==typeof t&&t.hasOwnProperty("v")&&(t=t.v),t||(t="default")),n.types[t]||n.types.default},_getRecordById:function(e){var t=this._index[v(e)];return t?t.record:null},_removeRecord:function(e,t){var n,r,i=this._options;"table"===i.shape?n=this._data:"tree"===i.shape&&(n=t.parent[this._childrenKey],delete t.parent),n.splice(n.indexOf(t.record),1),r=v(e),delete this._index[r],t.sel&&(delete this._selection[r],this._selectionCount-=1)},_addChange:function(e){var t=this._changes.indexOf(e);t>=0&&this._changes.splice(t,1),this._changes.push(e)},_removeChange:function(e){var t=this._changes.indexOf(e);t>=0&&!e.deleted&&!e.updated&&!e.inserted&&this._changes.splice(t,1)},_removeError:function(e){var t=this._errors.indexOf(e);t>=0&&this._errors.splice(t,1)},_addParentItems:function(t){var n,r,i,s,a,o,d={values:[]},l=this._options;if(l.parentModel&&l.parentRecordId){for(n in l.fields)l.fields.hasOwnProperty(n)&&(r=l.fields[n]).parentField&&(i||(i=e.get(l.parentModel))&&!s&&(s=i.getRecord(l.parentRecordId),o=i.getRecordMetadata(l.parentRecordId)),s&&(a={n:r.parentField,v:i.getValue(s,r.parentField)},d.values.push(a)));o&&(o.salt&&(d.salt=o.salt),o.protected&&(d.protected=o.protected)),i&&e.release(l.parentModel),t.parentRecordId=l.parentRecordId,d.values.length>0&&(t.parentItems=d)}},_updateAggregates:function(){var e,t,n,r,i,s,a=this._options.fields,o=[];if(!(this._staleAggFields.length<=0)){for(e=0;e<this._staleAggFields.length;e++)for(n=a[r=this._staleAggFields[e]],t=0;t<n.aggregates.length;t++)"string"==typeof(i=n.aggregates[t])&&(i=M[i]),(s={name:i.name,fieldName:r,key:this.getFieldKey(this._staleAggFields[e]),state:{},agg:i}).agg.init(s.state,n.dataType),o.push(s);this.forEach((function(e,t,n){var r,i,a,d=this.getRecordMetadata(n);for(r=0;r<o.length;r++)s=o[r],d.agg?d.agg===s.name&&(a=e[s.key],i=s.agg.get(s.state,!d.grandTotal)+"",e[s.key]=i,p(this,"set",{oldValue:a,oldIdentity:null,recordId:n,record:e,field:s.fieldName})):d.deleted||(i=e[s.key],s.agg.add(s.state,i))}),this),this._staleAggFields=[]}},_checkAggregates:function(e){var t;if(e)this._aggregatedFields[e]&&this._staleAggFields.indexOf(e)<0&&(this._staleAggFields.push(e),this._debouncedUpdateAggregates());else for(t in this._aggregatedFields)this._aggregatedFields.hasOwnProperty(t)&&this._checkAggregates(t)},_recalculate:function(e){this.forEach((function(t,n,r){var i=this.getRecordMetadata(r);i.agg||b(this,i,e,!0)}),this)}},A={shape:"table",recordIsArray:!1,hasTotalRecords:!1,genIdPrefix:"t",regionId:null,ajaxIdentifier:null,pageItemsToSubmit:null,regionData:{},fetchData:{},saveData:{},version:1,parentModel:null,parentRecordId:null,editable:!1,onlyMarkForDelete:!0,identityField:null,typeField:null,childrenField:null,parentIdentityField:null,sequenceField:null,metaField:null,sequenceStep:10,saveSelection:!1,types:{default:{validChildren:!0,operations:{canAdd:!0,canEdit:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},check:null,sortCompare:null,paginationType:"none",pageSize:100,preFetch:!1},P={table:1,tree:1,record:1},T={none:1,one:1,progressive:1};function E(e){var t,n=g(e);return(t=s[n[0]])&&(t=n[1]?t.instances[n[1]]:t.model),t}function q(e,t,n,r){var i,a,o=r?g(r):null,d=[];function l(r){var i=!(!n&&!r._options.regionId);return i&&("change"===e?i=r.isChanged():"error"===e&&(i=r.hasErrors()),i&&t&&(i=function(e){for(var t,n=e,r=g(n.modelId());r;){if(r[0]===o[0]&&(r[1]===o[1]||null===o[1]))return!0;r=null,(t=n.getOption("parentModel"))&&(n=E(t))&&(r=g(t))}return!1}(r))),i}function h(e,t){d.push({id:e,model:t})}function c(e,t){var n;for(n in e.model&&l(e.model)&&h(t,e.model),e.instances)e.instances.hasOwnProperty(n)&&l(e.instances[n])&&h([t,n],e.instances[n])}if(o||(t=!1),!t&&o&&o[0])a=o[0],(i=s[a])&&(o[1]?i.instances[o[1]]&&l(i.instances[o[1]])&&h([a,o[1]],i.instances[o[1]]):c(i,a));else for(a in s)s.hasOwnProperty(a)&&c(i=s[a],a);return d}function k(e){var t;(t=a.indexOf(e))>=0&&a.splice(t,1)}e.create=function(t,o,c,u,f,_){var y,v,I,m,w,R,F,x,K,b,D,O,C=g(t),E=Object.create(S);function q(e,t){var r=v.fields[e];(r.calcValue||r.dependsOn||r.aggregates&&r.aggregates.length>0)&&(n.warn("Model "+t+" field does not support calculations"),delete r.calcValue,delete r.dependsOn)}if(E.name=C[0],E.instance=C[1],E._requestsInProgress={},E._listeners=[],E._waitingPages=[],I=o.fields,E._options=l(!0,{},A,o),E._options.fields=I,!(v=E._options).fields)throw new Error("The fields option is required");if(!P[v.shape])throw new Error("Invalid shape option: "+v.shape);if(!T[v.paginationType])throw new Error("Invalid paginationType option: "+v.paginationType);if(v.editable&&!v.identityField)throw new Error("An editable model requires an identityField");if("tree"===v.shape&&!v.childrenField)throw new Error("A tree shaped model requires a childrenField");if("table"===v.shape&&"none"===v.paginationType&&void 0===o.hasTotalRecords&&(v.hasTotalRecords=!0),E._dependentFields={},E._calculatedFields=[],E._aggregatedFields={},E._aggregateRecs=[],function(e,t,n,s,a){var o,d,l,h,c,u,f,g,_,p,y=[],v={},I=function(e){var t=e.target.id;E._recalculate(E._dependentFields[":"+t])};for(l in e)if(e.hasOwnProperty(l)){if((h=e[l]).calcValue&&n.push(l),c=h.dependsOn)for(o=0;o<c.length;o++){if(":"===(f=c[o]).substr(0,1)){if(g=f.substr(1),!apex.item(g).node)throw new Error("Field '"+l+"' depends on unknown item '"+g+"'");y.push(g)}else if(!e[f])throw new Error("Field '"+l+"' depends on unknown field '"+f+"'");_=l,t[p=f]||(t[p]=[]),t[p].push(_)}if(h.aggregates){for(o=0;o<h.aggregates.length;o++){if("string"==typeof(d=h.aggregates[o])&&!M[d]||"object"==typeof d&&!(d.name&&d.init&&d.add&&d.get))throw new Error("Field '"+l+"' has invalid aggregate");v[u=d.name||d]||a.push(u),v[u]=1}s[l]=1}}y.length>0&&(E._externalItems$=i(y.map((function(e){return"#"+r.escapeCSS(e)})).join(",")),E._externalItems$.on("change",I),E._externalItemsHandler=I)}(v.fields,E._dependentFields,E._calculatedFields,E._aggregatedFields,E._aggregateRecs),E._staleAggFields=[],E._debouncedUpdateAggregates=r.debounce((function(){E._updateAggregates()}),250),E._nextInsertId=1e3,v.identityField)if(h(v.identityField))for(E._identityKeys=[],y=0;y<v.identityField.length;y++)E._identityKeys.push(E.getFieldKey(v.identityField[y])),q(v.identityField[y],"identity");else E._identityKeys=[E.getFieldKey(v.identityField)],q(v.identityField,"identity");if(v.typeField){if(E._typeKey=E.getFieldKey(v.typeField),void 0===E._typeKey)throw new Error("Type field not found: "+v.typeField);q(v.typeField,"type")}if(v.childrenField){if(E._childrenKey=E.getFieldKey(v.childrenField),void 0===E._childrenKey)throw new Error("Children field not found: "+v.childrenField);q(v.childrenField,"children")}if(v.parentIdentityField){if(E._parentIdKey=E.getFieldKey(v.parentIdentityField),void 0===E._parentIdKey)throw new Error("Parent identity field not found: "+v.parentIdentityField);q(v.parentIdentityField,"parentIdentity")}if(v.sequenceField){if(E._sequenceKey=E.getFieldKey(v.sequenceField),void 0===E._sequenceKey)throw new Error("Sequence field not found: "+v.sequenceField);q(v.sequenceField,"sequence")}if(v.metaField){if(E._metaKey=E.getFieldKey(v.metaField),void 0===E._metaKey)throw new Error("Meta field not found: "+v.metaField);q(v.metaField,"meta")}if("record"!==v.shape?v.identityField?E.getRecord=E._getRecordById:E.getRecord=E.recordAt:E.getRecord=function(){return E._data},E._clear(),c?(K="none"!==v.paginationType&&(null!=f?f:null==u||c.length<u),E._addData(0,0,c,u,K,_)):null!=u&&(E._totalRecords=u),v.parentModel&&v.parentRecordId&&!c&&(O=e.get(v.parentModel))){for(y in(D=O.getRecordMetadata(v.parentRecordId)).inserted&&(E._masterRecordIsInserted=!0,E._clear()),D.deleted&&(E._saveDataState(),E._masterRecordIsDeleted=!0,E._clear(),E._addData(0,0,[],0,!1,!1)),R=E._parentFieldsMap={},v.fields)v.fields.hasOwnProperty(y)&&(w=v.fields[y]).parentField&&(R[w.parentField]||(R[w.parentField]=[]),R[w.parentField].push(y));E.parentModelViewId=O.subscribe({onChange:function(t,n){var r,i;if("delete"===t||"revert"===t||"refreshRecords"===t||"clearChanges"===t){for(i=n.recordIds||n.deletedIds,r=0;r<i.length;r++)if(i[r]===v.parentRecordId){"delete"===t?(E._saveDataState(),E._masterRecordIsDeleted=!0,E._clear(),E._addData(0,0,[],0,!1,!1),p(E,"refresh",{})):"revert"!==t&&"refreshRecords"!==t||!E._masterRecordIsDeleted?"refreshRecords"===t&&n.newIds&&n.newIds[E.instance]||"clearChanges"===t&&E._masterRecordIsDeleted&&delete E._saveState:(delete E._masterRecordIsDeleted,E._restoreDataState(),p(E,"refresh",{}));break}"clearChanges"===t&&E._masterRecordIsInserted&&delete E._masterRecordIsInserted}else"set"===t&&(n.oldIdentity||n.recordId)===v.parentRecordId?((F=n.field)in R&&(m=R[F],x=O.getValue(n.record,F),E.forEach((function(e){var t,r;if(!E._metaKey||!e[E._metaKey].agg)for(t=0;t<m.length;t++)r=m[t],n.oldValue===E.getValue(e,r)&&E.setValue(e,r,x)}))),n.oldIdentity&&(v.parentRecordId=n.recordId,e.renameInstance(E.modelId(),n.recordId))):"refresh"===t&&E._masterRecordIsDeleted&&(delete E._masterRecordIsDeleted,E._restoreDataState(),p(E,"refresh",{}))}}),e.release(v.parentModel)}return a.length>=d&&(b=function(){var e,t;for(e=0;e<a.length;e++)if(!(t=a[e]).isChanged())return t;return null}())&&(n.info("Model: cache overflow; remove model from cache: "+b.modelId()),e.destroy(g(b.modelId()))),(b=s[C[0]])||(b={instances:{},instancesRef:{}},s[C[0]]=b),C[1]?(b.instancesRef[C[1]]=1,b.instances[C[1]]=E):(b.modelRef=1,b.model=E),n.info("Model: created model: "+t+" refCount: 1"),E},e.list=function(e,t,n){return q(null,n,e,t).map((function(e){return e.id}))},e.getStats=function(){var e,t,n,r,i,o=[];for(e in s)if(s.hasOwnProperty(e))for(i in(r=(t=s[e]).model)&&(n={name:r.name,instance:null,refCount:t.modelRef,cachePos:a.indexOf(r),subscribers:r._listeners.length,progressViews:r._listeners.map((function(e){return e.progressView||null}))},o.push(n)),t.instances)t.instances.hasOwnProperty(i)&&(n={name:(r=t.instances[i]).name,instance:r.instance,refCount:t.instancesRef[i],cachePos:a.indexOf(r),subscribers:r._listeners.length,progressViews:r._listeners.map((function(e){return e.progressView||null}))},o.push(n));return o},e.anyChanges=function(e,t,n){return q("change",n,e,t).length>0},e.anyErrors=function(e,t,n){return q("error",n,e,t).length>0},e.addChangesToSaveRequest=function(e,t,n){var r,i,s=[],a=q("change",n,!1,t);if(a.length<=0)return null;for(r=0;r<a.length;r++)(i=a[r].model.addChangesToSaveRequest(e))&&s.push(i);return function(e){var t;for(t=0;t<s.length;t++)s[t](e)}},e.save=function(e,n,r,i,s){var a,o,d,l,h;if(e=e||{},n=n||{},l=q("change",i,!1,r),o=apex.model.addChangesToSaveRequest(e,r,i)){if(r&&void 0===n.loadingIndicator&&void 0===n.loadingIndicatorPosition){for(h=[],a=1;a<l.length;a++)h.push(l[a].model);n.loadingIndicator=I(l[0].model,h)}return o(d=(s||t.plugin)(e,n)),d}return null},e.get=function(e){var t,r,i,a=g(e);return(t=s[a[0]])&&(a[1]?(r=t.instances[a[1]])&&(i=t.instancesRef[a[1]]+=1):(r=t.model)&&(i=t.modelRef+=1),r&&(k(r),n.info("Model: get model: "+e+" refCount: "+i))),r},e.renameInstance=function(e,t){var r,i,a=g(e);(r=s[a[0]])&&a[1]&&((i=r.instances[a[1]]).instance=t,delete r.instances[a[1]],r.instances[t]=i,n.info("Model: rename model "+a[0]+" instance: "+a[1]+" to "+t),p(i,"instanceRename",{oldInstance:a[1],newInstance:t}))},e.release=function(t){var r,i,o=g(t);(r=s[o[0]])&&(o[1]?(i=r.instancesRef[o[1]]-=1,r=r.instances[o[1]]):(i=r.modelRef-=1,r=r.model),n.info("Model: release model: "+t+" refCount: "+i),i<=0&&(r._options.parentModel&&E(r._options.parentModel)?(n.info("Model: save in cache model: "+t),function(e){var t;(t=a.indexOf(e))>=0&&a.splice(t,1),a.push(e)}(r)):r.isChanged()||e.destroy(t)))},e.destroy=function(t){var r,i,a=g(t);function o(r){var i,s;r&&(k(r),r.parentModelViewId&&(s=r._options.parentModel,(i=e.get(s))&&(i.unSubscribe(r.parentModelViewId),e.release(s))),r._externalItems$&&r._externalItems$.off("change",r._externalItemsHandler),r._data=null,r._index=null,r._selection=null,n.info("Model: destroy model: "+t))}if(r=s[a[0]]){if(a[1])o(r.instances[a[1]]),delete r.instancesRef[a[1]],delete r.instances[a[1]];else if(o(r.model),delete r.model,delete r.modelRef,"string"==typeof t&&!a[1])for(i in r.instances)r.instances.hasOwnProperty(i)&&(o(r.instances[i]),delete r.instancesRef[i],delete r.instances[i]);0!==Object.keys(r.instances).length||r.model||delete s[a[0]]}},e.getMaxCachedModels=function(){return d},e.setMaxCachedModels=function(e){d=parseInt(e,10)||10}}(apex.model,apex.server,apex.debug,apex.util,apex.jQuery);
!function(t,a,e,o){"use strict";var i="a-Toolbar",n=t.ui.keyCode,r=1;t.widget("apex.toolbar",{version:"5.1",widgetEventPrefix:"toolbar",options:{label:"",toolbarFor:null,idPrefix:null,actionsContext:null,small:!1,simple:!1,toolbarClass:"",cursorKeyNavigation:!1,data:[]},_create:function(){var e,n=this.element,r=this,s=this.options;e=a.debounce((function(a,e){"update"!==e&&"updateChoices"!==e||(r.enterActions[a.name]&&n.find('[data-enter-action="'+a.name+'"]').prop("disabled",!!a.disabled),n.is(":visible")&&n.find(".a-Toolbar-group").each((function(){var a,e=t(this);a=e.children().filter((function(){return!this.style||"none"!==this.style.display})).length>0,e.toggle(a)})))}),10),this.menus={},this.enterActions={},n.addClass(i).attr("role","toolbar").attr("aria-label",s.label?s.label:o.formatMessage("APEX.TB.TOOLBAR")),s.toolbarFor&&n.attr("aria-controls",s.toolbarFor),s.small&&n.addClass("a-Toolbar--small"),s.simple&&n.addClass("a-Toolbar--simple"),s.toolbarClass&&n.addClass(s.toolbarClass),apex.actions&&(this.actionsContext=s.actionsContext||apex.actions,this.actionsContext.observe(e),this.actionObserver=e),this.refresh(),s.cursorKeyNavigation&&(this.toolbarHasChanged(),this._on(this._keyNavHandlers))},_keyNavHandlers:{keydown:function(a){var e=this,o=a.which,i=t(a.target);function r(t){var o,i;t.attr("tabindex","-1"),o=(i=parseFloat(e.focusableElements.index(t[0])+1))>=e.focusableElements.length?e.focusableElements.first():e.focusableElements.filter(":eq("+i+")"),t.is(":input[type=radio]")&&t.attr("name")===o.attr("name")?r(o):o.attr("tabindex","0").focus(),a.preventDefault()}function s(t){var o,i;t.attr("tabindex","-1"),o=(i=parseFloat(e.focusableElements.index(t[0])-1))<0?e.focusableElements.last():e.focusableElements.filter(":eq("+i+")"),t.is(":input[type=radio]")&&t.attr("name")===o.attr("name")?s(o):o.attr("tabindex","0").focus(),a.preventDefault()}i.is(":input[type=text],:input[type=radio],select")?a.shiftKey&&o===n.TAB?s(i):o===n.TAB&&r(i):o===n.LEFT?s(i):o===n.RIGHT&&r(i)}},_destroy:function(){var a,e=this.element,o=this.options;for(a in e.removeClass(i+" a-Toolbar--small a-Toolbar--simple "+o.toolbarClass).removeAttr("role").empty(),this.actionsContext&&this.actionsContext.unobserve(this.actionObserver),this.menus)this.menus.hasOwnProperty(a)&&t("#"+a).remove()},_setOption:function(t,a){var e=this.element;"small"===t&&e.toggleClass("a-Toolbar--small",a),"simple"===t&&e.toggleClass("a-Toolbar--simple",a),"toolbarClass"===t&&e.removeClass(this.options.toolbarClass).addClass(a),this._super(t,a),"data"===t&&this.refresh()},_getControlProperty:function(t,a){var e,o;return void 0===(o=t[a])&&t.action&&(e=this.actionsContext.lookup(t.action))&&e[a]&&(o=e[a]),o},_getLocalizedControlProperty:function(t,a){var e,i=null;return t[a+"Key"]?i=o.getMessage(t[a+"Key"]):void 0!==t[a]&&(i=t[a]),!i&&t.action&&(e=this.actionsContext.lookup(t.action))&&void 0!==e[a]&&(i=e[a]),i},_getNoUpdate:function(t){return t.label||t.labelKey||t.icon||t.title||t.titleKey?"true":null},_getId:function(t){var a=this.options.idPrefix||this.element[0].id||"tb";return t.id?a+"_"+t.id:null},_forceId:function(t){t.id||(t.id="m"+r,r+=1)},_buildText:function(a,e){var o=t.extend({id:"",label:"",size:"30",maxChars:"4000",placeholder:"",action:""},e);o.enterAction&&(this.enterActions[o.enterAction]=!0),a.markup("<input").optionalAttr("id",this._getId(o)).attr("class","a-Toolbar-input a-Toolbar-inputText a-Toolbar-item").attr("title",this._getLocalizedControlProperty(o,"label")).attr("type","text").attr("size",o.size).attr("maxlength",o.maxChars).attr("value","").optionalAttr("placeholder",this._getLocalizedControlProperty(o,"placeholder")).optionalAttr("data-enter-action",o.enterAction).markup(" />")},_buildStatic:function(t,a){t.markup("<span").optionalAttr("id",this._getId(a)).attr("class","a-Toolbar-static a-Toolbar-item").markup(">"),a.content?t.markup(a.content):t.content(this._getLocalizedControlProperty(a,"label")),t.markup("</span>")},_buildSelect:function(t,a){var e,o=this.actionsContext.lookup(a.action);(e=this._getLocalizedControlProperty(a,"title"))||(e=this._getLocalizedControlProperty(a,"label")),t.markup("<select").optionalAttr("id",this._getId(a)).attr("class","a-Toolbar-selectList js-actionSelect a-Toolbar-item").attr("size","1").optionalAttr("title",e).optionalAttr("aria-label",e).optionalBoolAttr("disabled",o&&!!o.disabled).attr("data-action",a.action).markup("></select>")},_buildButton:function(t,a){var e,o,i,n,r,s="a-Button a-Toolbar-item",l=a.menu||a.menuId;function u(){t.markup("<span").attr("class","a-Icon "+i).markup("></span>")}l?(a.menu?(this._forceId(a),e=this._getId(a)+"_menu"):e=a.menuId,s+=" js-menuButton"):s+=" js-actionButton",(i=this._getControlProperty(a,"icon"))&&(s+=" a-Button--withIcon"),a.iconOnly&&(s+=" a-Button--noLabel"),a.hot&&(s+=" a-Button--hot"),(r=this.actionsContext.lookup(a.action))&&r.get&&!r.onLabel&&r.get(a.action)&&(s+=" is-active"),t.markup("<button type='button'").attr("class",s).optionalAttr("id",this._getId(a)).optionalBoolAttr("disabled",r&&!!r.disabled),o=this._getLocalizedControlProperty(a,"label"),n=this._getLocalizedControlProperty(a,"title"),!o&&r&&r.get&&(o=r.get()?r.onLabel:r.offLabel),a.iconOnly?(n||(n=o),t.attr("title",n).attr("aria-label",o)):n&&t.attr("title",n),l?t.attr("data-menu",e).attr("aria-haspopup",!0).attr("aria-expanded",!1):t.attr("data-action",a.action).optionalAttr("data-no-update",this._getNoUpdate(a)),t.markup(">"),i&&a.iconBeforeLabel&&u(),a.iconOnly||t.markup("<span class='a-Button-label'>").content(o).markup("</span>"),i&&!a.iconBeforeLabel&&u(),l&&t.markup("<span").attr("class","a-Icon icon-menu-drop-down").markup("></span>"),t.markup("</button>"),a.menu&&(this.menus[e]=a.menu)},_buildRadioButtonGroup:function(t,a){t.markup("<div role='group'").attr("aria-label",this._getLocalizedControlProperty(a,"label")).attr("class","a-Toolbar-radioGroup js-actionRadioGroup a-Toolbar-item").attr("data-action",a.action).attr("data-item","a-Button").attr("data-item-wrap","a-Toolbar-button-item").markup("></div>")},_buildToggle:function(t,a){var e,o,i=this.actionsContext.lookup(a.action);this._forceId(a),o="a-Toolbar-input a-Toolbar-inputCheckbox",(e=i&&i.get(a.action))&&(o+=" is-active"),t.markup("<div").attr("class","a-Toolbar-toggleButton js-actionCheckbox a-Toolbar-item").attr("data-action",a.action).optionalAttr("data-no-update",this._getNoUpdate(a)).markup(">"),t.markup("<input type='checkbox'").attr("class",o).attr("name",a.action).attr("id",this._getId(a)).optionalBoolAttr("checked",e).optionalBoolAttr("disabled",i&&!!i.disabled).markup(" />"),t.markup("<label").attr("for",this._getId(a)).attr("class","a-Button").markup(">").content(this._getLocalizedControlProperty(a,"label")).markup("</label>"),t.markup("</div>")},_buildToolbar:function(t,a){var e,o=[],i=[],n=[];for(e=0;e<a.length;e++)a[e].align&&"start"!==a[e].align?"center"===a[e].align?i.push(a[e]):"end"===a[e].align&&n.push(a[e]):o.push(a[e]);o.length&&this._buildGroupContainer(t,"start",o),i.length&&this._buildGroupContainer(t,"center",i),n.length&&this._buildGroupContainer(t,"end",n)},_buildGroupContainer:function(t,a,o){var i,n,r,s,l,u="a-Toolbar-groupContainer";switch(a){case"start":u+=" a-Toolbar-groupContainer--start";break;case"center":u+=" a-Toolbar-groupContainer--center";break;case"end":u+=" a-Toolbar-groupContainer--end"}for(t.markup("<div").attr("class",u).markup(">"),i=0;i<o.length;i++){for(l="a-Toolbar-group",(r=o[i]).customCSS&&(l+=" "+r.customCSS),r.groupTogether&&(l+=" a-Toolbar-group--together"),t.markup("<div").attr("class",l).markup(">"),n=0;n<r.controls.length;n++)switch((s=r.controls[n]).type){case"STATIC":this._buildStatic(t,s);break;case"TEXT":this._buildText(t,s);break;case"SELECT":this._buildSelect(t,s);break;case"MENU":case"BUTTON":this._buildButton(t,s);break;case"RADIO_GROUP":this._buildRadioButtonGroup(t,s);break;case"TOGGLE":this._buildToggle(t,s);break;default:e.error("Unknown toolbar control type: "+s.type)}t.markup("</div>")}t.markup("</div>")},refresh:function(){var e,o,i,n,r,s,l,u=this,c=this.element,d=this.options,p=d.data,h=a.htmlBuilder();for(r in this.menus)this.menus.hasOwnProperty(r)&&t("#"+r).remove();for(this._buildToolbar(h,d.data),c.html(h.toString()),e=0;e<p.length;e++)if(i=p[e].controls)for(o=0;o<i.length;o++)n=i[o],(l=this.actionsContext.lookup(n.action))&&(l.hide&&this.actionsContext.update(n.action),l.choices&&this.actionsContext.updateChoices(n.action));for(r in c.find(".a-Toolbar-input").on("keydown",(function(a){var e=t(a.target).attr("data-enter-action");e&&13===a.which&&(u.actionsContext.invoke(e),a.preventDefault())})),this.menus)this.menus.hasOwnProperty(r)&&(t("<div/>",{id:r,class:"a-Toolbar-menu",style:"display:none;"}).appendTo("body"),(s=this.menus[r]).actionsContext=this.actionsContext,s.idPrefix=this.options.idPrefix||this.element[0].id||"tb",t("#"+r).menu(s))},toolbarHasChanged:function(){var t,a;this.focusableElements=this.element.find(":focusable"),a=(t=this.focusableElements.filter("[tabindex=0]")).length?this.focusableElements.index(t[0]):0,this.focusableElements.filter(":eq("+a+")").attr("tabindex","0").end().not(":eq("+a+")").attr("tabindex","-1")},hideControl:function(t){var a=this.find(t);a&&(a.action?this.actionsContext.hide(a.action):(this.findElement(t).hide(),this.actionObserver&&this.actionObserver({},"update")))},showControl:function(t){var a=this.find(t);a&&(a.action?this.actionsContext.show(a.action):(this.findElement(t).show(),this.actionObserver&&this.actionObserver({},"update")))},disableControl:function(t){var a=this.find(t);a&&(a.action?this.actionsContext.disable(a.action):this.findElement(t).prop("disabled",!0))},enableControl:function(t){var a=this.find(t);a&&(a.action?this.actionsContext.enable(a.action):this.findElement(t).prop("disabled",!1))},findGroup:function(t){var a,e,o=this.options.data;for(a=0;a<o.length;a++)if((e=o[a]).id===t)return e;return null},find:function(a){var e,o,i,n,r,s=this.options.data;for(e=0;e<s.length;e++)if(i=s[e].controls)for(o=0;o<i.length;o++)if((n=i[o]).id===a)return n;for(r in this.menus)if(this.menus.hasOwnProperty(r)&&(n=t("#"+r).menu("find",a)))return n;return null},findElement:function(a){var e=this._getId({id:a});return t("#"+e)}})}(apex.jQuery,apex.util,apex.debug,apex.lang);
!function(t,e,i,s,n){"use strict";var o="is-selected",a="aria-multiselectable",r=n.ui.keyCode,l=0;function c(t){return t.parent().children().index(t)}function h(t){var e=t.find("a");return e.length?e[0]:t[0]}function d(t){return n(t).closest(".a-IconList-item")}var u=function(t,e){t._trigger("selectionChange",e)},f=s.debounce(u,1),m=s.debounce(u,350),g={begin:function(){this.text="<ul>\r\n"},item:function(t,e,i){this.text+="<li>"+s.escapeHTML(i)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};n.widget("apex.iconList",n.extend(!0,{version:"19.1",widgetEventPrefix:"iconlist",options:{multiple:!1,itemSelector:!1,addItemSelector:!0,label:!0,navigation:!1,tabbableContent:null,noNavKeyContent:null,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},item:function(t,e,i){e>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(g)}],selectionChange:null,activate:null},_create:function(){var t,i=this,s=this.options,c=this.element;this.columns=0,this.rows=0,this.searchString="",this.searchTimerId=null,s.navigation&&(s.multiple=!1),c.addClass("a-IconList").attr("role","listbox"),s.multiple&&c.attr(a,"true"),this.forwardKey=r.RIGHT,this.backwardKey=r.LEFT,"rtl"===c.css("direction")&&(c.addClass("u-RTL"),this.forwardKey=r.LEFT,this.backwardKey=r.RIGHT),c.attr("aria-labelledby")?(t=n("#"+c.attr("aria-labelledby").split(" ").join(",#")).last(),this.infoId=t.attr("id")+"_info",t.append("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>")):(this.infoId=(c.attr("id")||"il"+l++)+"_info",c.before("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>"),c.attr("aria-labelledby",this.infoId),this.addedLabel=!0),this._initContextMenu("a-IconList-item",(function(t){return!1}),(function(t){var e=d("keydown"===t.type&&i.lastFocused?i.lastFocused:t.target);return!!e.length&&(!!e.hasClass(o)||e)})),this._on(this._eventHandlers),s.allowCopy&&e.addHandler(c[0],(function(t){return i._copy(t),!0})),this.refresh(),s.disabled&&this._setOption("disabled",s.disabled)},_eventHandlers:{resize:function(t){t.target===this.element[0]&&(this._dim(),t.stopPropagation())},click:function(t){var e,i=this.options,s=i.navigation,o=n(t.target);s&&o.closest("a").length>0&&(t.shiftKey||t.ctrlKey)||(e=o.closest(".a-IconList-item")).length&&(i.itemSelector&&o.closest(".u-selector").length&&(t.ctrlKey=!0,t.shiftKey=!1),this._select(e,t,!0,!1),s&&this._activate(t),!s&&i.tabbableContent&&o.closest(i.tabbableContent).length?i.tabbableContent&&o.closest(i.tabbableContent).length&&o.focus():t.preventDefault())},dblclick:function(t){this.options.navigation||d(t.target).length&&this._activate(t)},mousedown:function(t){t.preventDefault()},keydown:function(t){var e,i,s,o=this.element,a=this.options,l=n(t.target),h=null,u=t.which;!a.navigation&&a.noNavKeyContent&&l.closest(a.noNavKeyContent).length||(u===r.HOME?h=o.children().first():u===r.END?h=o.children().last():u===r.DOWN?this.lastFocused&&(e=this._index2RowCol(c(d(this.lastFocused))),i=o.children(),e.row<Math.floor((i.length-1)/this.columns)&&((s=this._rowCol2Index(e.row+1,e.column))>=i.length&&(s=i.length-1),h=i.eq(s))):u===r.UP?this.lastFocused&&(e=this._index2RowCol(c(d(this.lastFocused))),i=o.children(),(s=this._rowCol2Index(e.row-1,e.column))>=0&&(h=i.eq(s)),h&&t.stopPropagation()):u===this.backwardKey?this.lastFocused&&(h=d(this.lastFocused).prev()):u===this.forwardKey?this.lastFocused&&(h=d(this.lastFocused).next()):u===r.SPACE?this.lastFocused&&!this.searchTimerId&&(h=d(this.lastFocused)):u===r.ENTER&&"A"!==t.target.nodeName&&this._activate(t),h&&h[0]&&(this._select(h,t,!0,!0),t.preventDefault()))},keypress:function(t){var e,i,s=this.options,o=this;if(0!==t.which&&s.label&&!t.altKey&&!t.ctrlKey&&(s.navigation||!s.noNavKeyContent||!n(t.target).closest(s.noNavKeyContent).length)){if(e=String.fromCharCode(t.which).toLowerCase(),this.searchTimerId)e!==this.searchString&&(this.searchString+=e),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===e)return;this.searchString=e}this.searchTimerId=setTimeout((function(){o.searchTimerId=null}),500),(i=this._findItem(this.searchString))&&this._select(i,t,!0,!0)}},focusin:function(t){var e=d(t.target);0!==e.length&&(e.addClass("is-focused"),this._setFocusable(t.target))},focusout:function(t){d(t.target).removeClass("is-focused")}},_destroy:function(){var t=this.element,i=this.options;t.removeClass("a-IconList is-disabled u-RTL").removeAttr("role").removeAttr(a).children().removeClass("a-IconList-item").removeAttr("role").removeAttr("aria-selected").removeAttr("tabindex"),t.find("a").removeAttr("tabindex").removeAttr("role"),i.itemSelector&&i.addItemSelector&&t.find(".u-selector").remove(),e.removeHandler(t[0]),this._destroyContextMenu(),n("#"+this.infoId).remove(),this.addedLabel&&t.removeAttr("aria-labelledby")},_setOption:function(t,e){var i,s,n=this.options,o=this.element;if(this._checkContextMenuOptions(t,e),"multiple"===t)n.navigation&&(e=!1);else if("allowCopy"===t||"addItemSelector"===t||"navigation"===t)throw new Error("IconList "+t+" option cannot be set");this._super(t,e),"disabled"===t?(o.toggleClass("is-disabled ui-state-disabled",e).attr("aria-disabled",e),this.lastFocused&&(e?this.lastFocused&&((i=!n.navigation&&n.tabbableContent)?(s=d(this.lastFocused)).add(s.find(i).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1):this._setFocusable(this.lastFocused)),e&&this._dim()):"multiple"===t?e?o.attr(a,"true"):o.removeAttr(a):"itemSelector"===t&&this.refresh()},refresh:function(){var t,e,i,s=this.options,o=this.element;s.multiple&&!s.itemSelector&&apex.userHasTouched()&&(s.itemSelector=!0,s.addItemSelector=!0),o.find("a").attr("tabindex",-1).attr("role","option"),o.find(s.tabbableContent).attr("tabindex",-1),(i=o.children()).addClass("a-IconList-item").filter((function(){return 0===n(this).find("a").length})).attr("role","option").attr("tabindex",-1),s.addItemSelector&&(s.itemSelector?(e=n("<span class='"+(s.multiple?"u-selector":"u-selector u-selector--single")+"'></span>"),i.filter((function(){return n(this).find(".u-selector").length<=0})).prepend(e)):o.find(".u-selector").remove()),this._dim(),(t=o.find(".is-selected.a-IconList-item")).length>0?this.setSelection(t,!1):(this.lastFocused&&n(this.lastFocused).is(":visible")||(this.lastFocused=h(o.children().first())),this.selectAnchor=this.lastFocused,this.lastFocused&&!s.disabled&&this._setFocusable(this.lastFocused))},resize:function(){this._dim()},focus:function(){this.lastFocused&&this.lastFocused.focus()},getColumns:function(){return this.columns},getRows:function(){return this.rows},getSelection:function(){return this.element.find(".is-selected.a-IconList-item")},getSelectionValues:function(){var t=[];return this.getSelection().each((function(){t.push(n(this).attr("data-value"))})),t},setSelection:function(t,e,i){e=!!e,this._select(t,null,e,!1,i)},_copy:function(t){var e,i,s=this.getSelection(),n=this.options.dataTransferFormats;if(s.length){for(n.forEach((function(t){t.writer.begin(s)})),e=0;e<s.length;e++)i=s.eq(e),n.forEach((function(t){t.writer.item(i,e,i.text())}));n.forEach((function(e){e.writer.end(),t.setData(e.format,e.writer.toString())}))}},_rowCol2Index:function(t,e){return t*this.columns+e},_index2RowCol:function(t){var e=Math.floor(t/this.columns);return{row:Math.floor(t/this.columns),column:t-e*this.columns}},_dim:function(){var t,e,s,o=this,a=this.element,r=a.width(),l=a.children(),c=l.length;c&&(t=l.first().position().top,s=l.first().outerWidth()),this.columns=c,l.each((function(e){var i=n(this).position().top;if(i>t)return t=i,o.columns=e,!1})),this.rows=c>0?Math.floor((c+this.columns-1)/this.columns):0,1===this.rows&&(this.columns=Math.floor(r/s)),e=1===this.columns?i.formatMessage("APEX.ICON_LIST.LIST_DIM",this.rows):i.formatMessage("APEX.ICON_LIST.GRID_DIM",this.columns,this.rows),n("#"+this.infoId).text(e)},_findItem:function(t){var e,i,s=this.element,n=t.length,o=this.options.label;for(e=i=d(this.lastFocused),1===n&&(e=e.next()),0===e.length&&(e=s.children().first());e.length>0;){if((!0===o?e.text().trim():e.find(o).text()).substring(0,n).toLowerCase()===t)return e;if(0===(e=e.next()).length&&(e=s.children().first()),e[0]===i[0])break}return null},_setFocusable:function(t){var e,i=this.options,s=!i.navigation&&i.tabbableContent;this.lastFocused&&this.lastFocused!==t&&(s?(e=d(this.lastFocused)).add(e.find(s).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1),s?(e=d(t)).find(s).not("disabled").prop("tabIndex",0).length||e.prop("tabIndex",0):t.tabIndex=0,this.lastFocused=t},_activate:function(t){var e,i;this._trigger("activate",t,{values:this.getSelectionValues()}),this.options.navigation&&!t.isDefaultPrevented()&&(i=(e=this.getSelection()).attr("href")||e.find("a").attr("href"))&&(t.preventDefault(),apex.navigation.redirect(i))},_select:function(t,e,i,a,r){var l,d,u,g,p,b,v,C,x,I="set",y=this.element,_=this.options,w=y.find(".is-selected.a-IconList-item");t=t.filter(":visible"),e&&_.multiple&&("click"===e.type?e.ctrlKey||e.metaKey?I="toggle":e.shiftKey&&(I="range"):"keydown"===e.type&&(e.keyCode===n.ui.keyCode.SPACE?I=e.ctrlKey?"toggle":e.shiftKey?"range":"add":e.ctrlKey?I="none":e.shiftKey&&(I="range"))),"range"!==I||this.selectAnchor||(I="set"),"set"!==I&&"range"!==I||w.removeClass(o).removeAttr("aria-selected").find(".u-selector").removeClass(o),l=t.hasClass(o),"set"===I||"add"===I||"toggle"===I&&!l?(t.addClass(o).attr("aria-selected",!0).find(".u-selector").addClass(o),this.selectAnchor=t[0]):"range"===I?(y.children().removeClass(o).removeAttr("aria-selected").find(".u-selector").removeClass(o),b=c(n(this.selectAnchor)),v=c(t.last()),b>v&&(C=v,v=b,b=C),y.children().filter((function(t){return t>=b&&t<=v})).addClass(o).attr("aria-selected",!0).find(".u-selector").addClass(o)):"toggle"===I&&l&&(t.removeClass(o).removeAttr("aria-selected").find(".u-selector").removeClass(o),this.selectAnchor=t[0]),t.length>0&&(x=h(t.first()),i?(x.tabIndex=0,x.focus()):this._setFocusable(x),(g=(u=y.scrollParent())[0]===document?{left:0,top:0}:u.offset())&&(p=y.offset(),((d=t.first().offset()).top<g.top||d.top>g.top+u[0].offsetHeight)&&(u[0].scrollTop=d.top-p.top),(d.left+t[0].offsetWidth<g.left||d.left>g.left+u[0].offsetWidth)&&(u[0].scrollLeft=d.left-p.left))),r||_.navigation&&e&&"click"===e.type||("toggle"===I||"range"===I&&!l||"add"===I&&!l||"set"===I&&!s.arrayEqual(w,t))&&(a?m(this,e):f(this,e))}},apex.widget.contextMenuMixin))}(apex.debug,apex.clipboard,apex.lang,apex.util,apex.jQuery);
!function(e,t,a,s,o,i){"use strict";e.widget("apex.combobox",{version:"5.1",widgetEventPrefix:"combobox",options:{source:[],multipleValues:!1,multipleValueDelimiter:",",label:""},_create:function(){var i=t.htmlBuilder(),n=this,l=this.options,r=e(".a-Combobox").length;this.baseId=this.element[0].id||"combobox"+(r+1),this.actions=a.createContext("combobox",this.element[0]),l.label&&o.warn("Label not provided, which is an accessibility issue (unless the 'label' option is later set)."),i.markup("<span").attr("class","a-Combobox-wrapper").markup("></span>"),this.element.wrap(i.toString()).addClass("a-Combobox"),this.wrapper$=this.element.closest(".a-Combobox-wrapper"),this._createShowAllButton(),this._on(this.element,{keydown:function(t){(t.altKey||t.metaKey)&&t.which===e.ui.keyCode.DOWN&&(n.menu$.menu("open",n.element,!1),n.menu$.find(":focusable").first().focus())}}),this.actions.add({name:this.baseId+"-values",label:s.getMessage("APEX.COMBOBOX.LIST_OF_VALUES"),set:function(e){var t=n.element.val();l.multipleValues?n.element.val((t?t+l.multipleValueDelimiter:t)+e):n.element.val(e),t!==n.element.val()&&n.element.change()},get:function(){return n.element.val()},choices:l.source})},_setOption:function(t,a){switch(this._super(t,a),t){case"multipleValues":break;case"source":this.actions.lookup(this.baseId+"-values").choices=a,this.actions.updateChoices(this.baseId+"-values");break;case"label":e("#"+this.baseId+"-showAll",this.wrapper$).attr("title",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",a)).attr("aria-label",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",a))}},_createShowAllButton:function(){var a=t.htmlBuilder();a.markup("<button type='button'").attr("id",this.baseId+"-showAll").attr("tabindex","-1").attr("title",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("aria-label",s.formatMessage("APEX.COMBOBOX.SHOW_ALL_VALUES",this.options.label)).attr("class","a-Button a-Button--withIcon a-Button--noLabel js-menuButton").attr("data-menu",this.baseId+"-menu").attr("aria-haspopup",!0).attr("aria-expanded",!1).markup(">"),a.markup("<span").attr("aria-hidden",!0).attr("class","a-Icon icon-menu-drop-down").markup(">").markup("</span>"),a.markup("</button>"),this.wrapper$.append(a.toString()),this.menu$=e("<div/>",{id:this.baseId+"-menu",class:"",style:"display:none;"}).appendTo("body"),this.menu$.menu({actionsContext:this.actions,items:[{type:"radioGroup",action:this.baseId+"-values"}]})},_destroy:function(){this.element.insertBefore(this.wrapper$),this.wrapper$.remove(),this.menu$.remove(),this.element.removeClass("a-Combobox"),a.removeContext("combobox",this.element[0])}})}(apex.jQuery,apex.util,apex.actions,apex.lang,apex.debug);
!function(t,i,e){"use strict";var s=".a-Splitter-barH,.a-Splitter-barV",o="a-Splitter-thumb",r="."+o,a="is-disabled",n="title";t.widget("apex.splitter",{version:"5.0",widgetEventPrefix:"splitter",options:{orientation:"horizontal",positionedFrom:"begin",minSize:60,position:100,noCollapse:!1,dragCollapse:!0,collapsed:!1,snap:!1,inc:10,realTime:!1,iframeFix:!1,restoreText:null,collapseText:null,title:null,change:null},lastPos:null,bar$:null,before$:null,after$:null,horiz:!0,fromEnd:!1,barSize:1,_create:function(){var s,o,a,n,l,h,p=this,d=this.options,c=this.element,f=i.htmlBuilder(),b=t.ui.keyCode,u=!!d.snap&&[1*d.snap,1*d.snap],m=d.noCollapse?0:1,z=null;if(2!==c.children().length)throw new Error("Splitter must have exactly two children.");if("horizontal"!==d.orientation&&"vertical"!==d.orientation)throw new Error("Orientation bad value");if("begin"!==d.positionedFrom&&"end"!==d.positionedFrom)throw new Error("PositionedFrom bad value");if(d.minSize<m&&(d.minSize=m,e.warn("Option minSize adjusted")),this.horiz="horizontal"===d.orientation,this.fromEnd="end"===d.positionedFrom,h=this.horiz?"left":"top",this.before$=c.children().eq(0),this.after$=c.children().eq(1),c.addClass("a-Splitter resize"),"rtl"===c.css("direction")&&(c.addClass("u-RTL"),this.horiz&&(this.before$=c.children().eq(1),this.after$=c.children().eq(0),this.fromEnd=!this.fromEnd)),c.parent(".a-Splitter").length>0||this.before$.is(".a-Splitter")||this.after$.is(".a-Splitter"))throw new Error("Child of splitter cannot be a splitter");this.before$[0].id||(this.before$[0].id=(c[0].id||"splitter")+"_first"),this.after$[0].id||(this.after$[0].id=(c[0].id||"splitter")+"_second"),d.position<d.minSize&&(d.position=d.minSize),this.lastPos=d.position,d.snap&&(d.inc=d.snap),this._renderBar(f),this.bar$=t(f.toString()).insertAfter(c.children().eq(0)),this.horiz?this.barSize=this.bar$.width():this.barSize=this.bar$.height(),c.css({position:"relative"}).children().css({position:"absolute"}),this.horiz?(s=this.bar$.position()[h],o=0,a="e-resize",this.fromEnd?(n=b.LEFT,l=b.RIGHT):(n=b.RIGHT,l=b.LEFT)):(s=0,o=this.bar$.position()[h],a="s-resize",this.fromEnd?(n=b.UP,l=b.DOWN):(n=b.DOWN,l=b.UP)),this.bar$.css({left:s,top:o}).draggable({axis:p.horiz?"x":"y",containment:"parent",cancel:"button",cursor:a,iframeFix:d.iframeFix,grid:u,scroll:!1,drag:function(t,i){var e;d.realTime&&(e=i.position[h],p.fromEnd&&(e=(p.horiz?c.width():c.height())-e-p.barSize),p._setPos(e,!1))},start:function(t,i){p.bar$.addClass("is-active")},stop:function(t,i){var e=i.position[h];p.bar$.removeClass("is-active"),p.fromEnd&&(e=(p.horiz?c.width():c.height())-e-p.barSize),p._setPos(e,!1)}}).click((function(){t(this).find(r).focus()})).find("button").click((function(){p._setPos(p._getPos(),!p._isCollapsed())})),apex.widget.util.TouchProxy.addTouchListeners(this.bar$[0]),this.bar$.find(r).focus((function(){t(this).parent().addClass("is-focused is-active")})).blur((function(){t(this).parent().removeClass("is-focused is-active")})).keydown((function(t){var i,e,s=t.keyCode,o=null,r=!1;if(s!==l||d.collapsed?s===n&&((o=p._getPos())<0?(d.noCollapse||(r=!0),o=0):o+=d.inc,i=p._getMaxPos(),o>i&&(o=i)):(o=p._getPos(),(o-=d.inc)<d.minSize&&d.noCollapse&&(o=d.minSize),o<0&&(o=0)),null!==o)return e=o,p.fromEnd&&(e=(p.horiz?c.width():c.height())-e-p.barSize),p.bar$.css(h,e),z&&(clearTimeout(z),z=null),z=setTimeout((function(){z=null,p._setPos(o,r)}),100),!1})),this._on(!0,this._eventHandlers),d.disabled&&this._setOption("disabled",d.disabled),this.refresh()},_eventHandlers:{resize:function(e){var s,o,r,a,n=this.options,l=this.element;if(e.target===l[0]){if(s=l.height(),o=l.width(),0===s||0===o)throw new Error("Splitter needs to be in a component with size");a=l.offset(),this.horiz?(l.children().each((function(){i.setOuterHeight(t(this),s)})),this.fromEnd?(r=[a.left+n.minSize,a.top,a.left+o-this.barSize,a.top+s],n.dragCollapse&&!n.noCollapse||(r[2]-=n.minSize)):(r=[a.left,a.top,a.left+o-this.barSize-n.minSize,a.top+s],n.dragCollapse&&!n.noCollapse||(r[0]+=n.minSize+1))):(l.children().each((function(){i.setOuterWidth(t(this),o)})),this.fromEnd?(r=[a.left,a.top+n.minSize,a.left+o,a.top+s-this.barSize],n.dragCollapse&&!n.noCollapse||(r[3]-=n.minSize)):(r=[a.left,a.top,a.left+o,a.top+s-this.barSize-n.minSize],n.dragCollapse&&!n.noCollapse||(r[1]+=n.minSize+1))),this._setPos(n.position,n.collapsed),this.bar$.draggable("option","containment",r),l.children(".resize").filter(":visible").trigger("resize"),e.stopPropagation()}}},_destroy:function(){this.element.removeClass("a-Splitter "+a+" u-RTL resize").children(s).remove(),this.element.children().css("position","")},refresh:function(){this.element.is(":visible")&&this.element.trigger("resize")},_setOption:function(i,s){var o,l,h;if(!this.options.noCollapse||"collapsed"!==i&&"restoreText"!==i&&"collapseText"!==i){if("orientation"===i||"positionedFrom"===i||"noCollapse"===i)throw new Error("Readonly option: "+i);"position"===i?this._setPos(1*s,this._isCollapsed()):"collapsed"===i?this._setPos(this._getPos(),!!s):"snap"===i?(s=!!s&&1*s,this.options.snap=s,o=!!s&&[s,s],this.bar$.draggable("option","grid",o),s&&(this.options.inc=s)):"inc"===i?(s*=1,this.options.snap&&(s=this.options.snap),this.options.inc=s):"disabled"===i?(this.options.disabled=s,h=this.bar$.find(r),this.options.noCollapse?s?h.removeAttr("tabindex"):h.attr("tabindex","0"):(h[0].disabled=s,s?h.attr(n,this.options.title):h.attr(n,this.options.collapsed?this.options.restoreText:this.options.collapseText)),this.bar$.draggable("option","disabled",s),s?(this.element.addClass(a),this.bar$.addClass(a),h.attr("aria-disabled",!0)):(h.removeAttr("aria-disabled"),this.bar$.removeClass(a),this.element.removeClass(a))):"minSize"===i?(s<(l=this.options.noCollapse?0:1)&&(s=l,e.warn("Option minSize adjusted")),this.options.minSize=s):t.Widget.prototype._setOption.apply(this,arguments),"title"===i?(this.bar$.attr(n,s),(this.options.noCollapse||this.options.disabled)&&this.bar$.find(r).attr(n,s)):"restoreText"===i&&this.options.collapsed&&!this.options.disabled?this.bar$.find("button").attr(n,s):"collapseText"!==i||this.options.collapsed||this.options.disabled?"iframeFix"===i?this.bar$.draggable("option","iframeFix",s):"dragCollapse"===i&&this.refresh():this.bar$.find("button").attr(n,s)}else e.warn("Setting "+i+" option on noCollapse splitter has no effect.")},_renderBar:function(t){var i=this.options,e=this.horiz?"a-Splitter-barH":"a-Splitter-barV";this.fromEnd&&(e+=" a-Splitter--end"),i.noCollapse&&(i.collapsed=!1),i.collapsed&&(e+=" is-collapsed"),t.markup("<div").attr("class",e).optionalAttr(n,i.title).markup("><div></div>"),i.noCollapse?t.markup("<span role='separator' class='"+o+"' tabindex='0' aria-expanded='true'").optionalAttr(n,i.title).markup("></span>"):t.markup("<button role='separator' class='"+o+"' type='button'").attr("aria-expanded",!i.collapsed).optionalAttr(n,i.collapsed?i.restoreText:i.collapseText).markup("></button>"),t.markup("</div>")},_getPos:function(){var t=this.element,i=this.horiz?"left":"top",e=this.bar$.position()[i];return this.fromEnd&&(e=(this.horiz?t.width():t.height())-e-this.barSize),e},_isCollapsed:function(){return this.bar$.hasClass("is-collapsed")},_getMaxPos:function(){var t=this.options,i=this.element;return this.horiz?i.width()-this.barSize-t.minSize:i.height()-this.barSize-t.minSize},_setPos:function(t,e){var s,o,a,l,h,p,d=this.options,c=this.element,f=this.horiz?"left":"top",b=this._isCollapsed(),u=this.lastPos;d.noCollapse&&(e=!1),b&&!e&&(t=this.lastPos)<d.minSize&&(t=d.minSize),t<d.minSize?d.noCollapse?t=d.minSize:e=!0:t>(s=this._getMaxPos())&&(t=s),d.noCollapse&&t<=0&&(t=0),t>0&&(this.lastPos=t),e&&(t=0,d.position=0),o=this.horiz?c.width():c.height(),h=t,this.fromEnd&&(h=o-t-this.barSize),this.bar$.css(f,h),p=this.bar$.find(r),this.fromEnd?(a=this.after$,l=o-h-this.barSize):(a=this.before$,l=h),e?(this.bar$.addClass("is-collapsed"),d.disabled||p.attr("aria-expanded",!1).attr(n,d.restoreText),a.hide()):(d.noCollapse?a.toggle(0!==t):(this.bar$.removeClass("is-collapsed"),d.noCollapse||d.disabled||p.attr("aria-expanded",!0).attr(n,d.collapseText),a.show()),this.horiz?i.setOuterWidth(a,l):i.setOuterHeight(a,l)),this.fromEnd?(a=this.before$,l=h):(a=this.after$,l=o-h-this.barSize),this.horiz?i.setOuterWidth(a,l):i.setOuterHeight(a,l),d.noCollapse&&a.toggle(0!==l),this.after$.css(f,h+this.barSize+"px"),this.before$.css(f,0),(!e&&t!==u||b!==e)&&(d.collapsed=e,d.position=t,c.children(".resize").filter(":visible").trigger("resize"),this._trigger("change",{},{position:d.position,collapsed:d.collapsed,lastPosition:this.lastPos}))}});var l=0,h=0;t.apex.splitter.nextSplitter=function(i){var e,o,a,n=i?-1:1,p=t(document.activeElement);if(!(l>0||h>0))return(a=(o=t(".a-Splitter >.a-Splitter-barH,.a-Splitter >.a-Splitter-barV").filter(":visible").not(".ui-state-disabled").add(p)).index(p))>=0&&(a+=n,i&&p.parent().is(s)&&(a+=n),a>=0&&a<o.length&&(e=o.eq(a))),(e&&0===e.length&&!p.parent().is(s)||p.is("html,body"))&&(e=t(".a-Splitter >.a-Splitter-barH,.a-Splitter >.a-Splitter-barV").filter(":visible").not(".ui-state-disabled")[i?"last":"first"]()),e&&e.length>0?(e.children(r).focus(),!0):void 0},t((function(){t(document.body).on("menubeforeopen",(function(){h+=1})).on("menuafterclose",(function(){h-=1})).on("dialogopen",(function(){l+=1})).on("dialogclose",(function(){l-=1}))})),apex.message&&apex.message.addVisibilityCheck((function(i){var e=t("#"+i);e.parents(".a-Splitter").each((function(){e.is(":visible")||t(this).splitter("option","collapsed",!1)}))}))}(apex.jQuery,apex.util,apex.debug);
!function(e,t,s,i,a,o){"use strict";var n={},r=e.applyTemplate;function l(e){return i.getMessage("APEX.GV."+e)}function d(e){var t=Array.prototype.slice.call(arguments);return t[0]="APEX.GV."+e,i.formatMessage.apply(i,t)}function h(e,t){return Math.floor(e/t)*t}o.widget("apex.tableModelViewBase",{version:"20.2",widgetEventPrefix:"tableModelViewBase",options:{modelName:null,noDataMessage:"",noDataIcon:"icon-irr-no-results",moreDataMessage:"",hideEmptyFooter:!1,editable:!1,autoAddRecord:!1,hasSize:!1,progressOptions:null,stickyFooter:!1,pagination:{scroll:!1,loadMore:!1,showPageLinks:!1,maxLinks:5,showPageSelector:!1,showRange:!0,firstAndLastButtons:!1,hideSinglePage:!1},highlights:{},highlighter:null,highlighterContext:null,rowsPerPage:null,selectionStatusMessageKey:"APEX.GV.SELECTION_COUNT",hideDeletedRows:!1,footer:!0,scrollParentOverride:null},firstPage:function(){return!this.renderInProgress&&(this.options.pagination.scroll?this.scrollParent$.scrollTop(this.scrollDelta):this.pageOffset>0&&(this.pageOffset=0,this.refresh(!1)),!0)},previousPage:function(){var e,t;return!this.renderInProgress&&(this.options.pagination.scroll?((t=(e=this.scrollParent$).scrollTop()-this.scrollDelta-this.displayPageHeight)<0&&(t=0),e.scrollTop(t+this.scrollDelta)):this.pageOffset>0&&(this.pageOffset-=this.pageSize,this.pageOffset<0&&(this.pageOffset=0),this.refresh(!1)),!0)},nextPage:function(){var e,t,s,i;return!this.renderInProgress&&(this.options.pagination.scroll?(e=this.scrollParent$,t=this._getDataContainer().first().height()-this.displayPageHeight,(s=e.scrollTop()-this.scrollDelta+this.displayPageHeight)>t&&(s=t),e.scrollTop(s+this.scrollDelta)):((i=this.model.getTotalRecords())<0||this.pageOffset+this.pageCount<i)&&(this.pageOffset+=this.pageSize,this.refresh(!1)),!0)},lastPage:function(){var e,t,s,i;return!this.renderInProgress&&(this.options.pagination.scroll?(t=this.scrollParent$,s=this._getDataContainer().first().height()-this.displayPageHeight,t.scrollTop(s+this.scrollDelta)):(i=this.model.getTotalRecords())>0&&(e=Math.ceil(i/this.pageSize),this.pageOffset=(e-1)*this.pageSize,this.refresh(!1)),!0)},loadMore:function(){return this.options.pagination.scroll&&!this.scrollPaging?this._addNextPage():this.nextPage()},gotoPage:function(e){var t,s=this.model.getTotalRecords();return!this.renderInProgress&&(s>0&&(t=Math.ceil(s/this.pageSize),e>=0&&e<t&&(this.pageOffset=e*this.pageSize,this.refresh(!1))),!0)},getActiveRecordId:function(){return this.activeRecordId},getActiveRecord:function(){return this.activeRecord},setActiveRecordValue:function(e){var t=this.columnItems[e];this.activeRecord&&t&&(this.ignoreItemChange=!0,this._setModelValue(null,t.item,this.activeRecord,e,!0),this.ignoreItemChange=!1)},lockActive:function(){this.activeRecord&&(this.activeLockCount+=1)},unlockActive:function(){this.activeRecord&&(this.activeLockCount-=1,this.activeLockCount<0&&(this.activeLockCount=0),0===this.activeLockCount&&(this.activeUnlockCallback&&(this.activeUnlockCallback(),this.activeUnlockCallback=null),this.finishEditingCallback&&(this.finishEditingCallback(),this.finishEditingCallback=null)))},finishEditing:function(){var e=this,t=o.Deferred();function s(){e._finishEditing?e._finishEditing(t):t.resolve()}return this.activeLockCount>0?this.finishEditingCallback=s:s(),t.promise()},addStateIcon:function(t,s,i){var a=e.htmlBuilder();this.stateIconMessages[t]=i,0===this.stateIcons$.find("[data-state='"+t+"']").length&&(a.markup("<span tabindex='0'").attr("class",s).attr("data-state",t).markup("></span>"),this.stateIcons$.append(a.toString()))},removeStateIcon:function(e){this.stateIcons$.find("[data-state='"+e+"']").remove(),delete this.stateIconMessages[e]},_create:function(){var e=this.options;e.hideDeletedRows&&this.element.addClass("a-GV--hideDeleted"),this.pageOffset=0,this.pageCount=0,this.pageSize=10,this.noData=!0,this.onLastPage=!1,this.lastScrollLeft=null,this.lastScrollTop=null,this.stateIconMessages={},this.reinitCallbacks=null,this.pendingRefresh=null,this.ignoreFieldChange=null,this.activeRecord=null,this.activeRecordId=null,this.activeLockCount=0,this.activeUnlockCallback=null,this.columnItems=null,this.columnItemsContainer$=null,e.progressOptions||(e.progressOptions={fixed:!e.hasSize}),e.pagination.scroll&&(e.rowsPerPage=null),e.rowsPerPage&&(this.pageSize=e.rowsPerPage)},_tableModelViewDestroy:function(){this.footer$.remove(),this.footer$=null,this.pageRange$=null,this.pageSelector$=null,this.status$=null,this.stateIcons$=null,this.element.removeClass("a-GV--hideDeleted"),this._scrollHandler&&this.scrollParent$.off("scroll",null,this._scrollHandler)},_refreshCheckIfVisible:function(){return null===this.element[0].offsetParent?(this.pendingRefresh=!0,!1):(this.pendingRefresh=!1,!0)},_initModel:function(e,s){var i,a=this.options,o=this;if(this.model&&(this.model.unSubscribe(this.modelViewId),this.modelName!==e&&t.release(this.modelName),this.model=null,this.modelName=null),e){if(this.modelName=e,this.model=t.get(e),!this.model)throw new Error("Model not found: "+e);this.modelViewId=this.model.subscribe({onChange:s||function(e,t){var s,n,r,l,d,h,c,g,u,p,f;if(!o.pendingRefresh){if("refresh"===e)o.pageOffset=0,o.pageCount=0,o.refresh();else if("refreshRecords"===e||"revert"===e)for(n=o._elementsFromRecordIds(t.recordIds),s=0;s<n.length;s++)(r=n[s])&&(l=t.records[s],h=t.recordIds[s],d=t.newIds[h]||h,c=o.model.getRecordMetadata(d),o._replaceRecord(r,l,h,d,c));else if("move"===e)for(p=t.records,t.insertAfterId&&(r=(n=o._elementsFromRecordIds([t.insertAfterId])).length>0?n[0]:null),s=p.length-1;s>=0;s--)l=p[s],d=o.model.getRecordId(l),c=o.model.getRecordMetadata(d),(n=o._elementsFromRecordIds([d])).length>0&&n[0]&&o._removeRecord(n[0]),g=o._insertRecord(r,l,d,c,r?"after":"before");else if("insert"===e||"copy"===e)if("insert"===e?(f=!1,p=[t.record]):(f=!0,p=t.records),t.insertAfterId&&(r=(n=o._elementsFromRecordIds([t.insertAfterId])).length>0?n[0]:null),o.noData)setTimeout((function(){o.refresh(),(n=o._elementsFromRecordIds([o.model.getRecordId(p[0])])).length>0&&n[0]&&o._afterInsert(n,f)}),1);else{for(u=[],s=p.length-1;s>=0;s--)l=p[s],d=o.model.getRecordId(l),c=o.model.getRecordMetadata(d),g=o._insertRecord(r,l,d,c,r?"after":"before"),u.push(g);o._afterInsert(u,f)}else if("clearChanges"===e){if(i)for(n=o._elementsFromRecordIds(t.deletedIds),s=0;s<n.length;s++)n[s]&&o._removeRecord(n[s]);for(n=o._elementsFromRecordIds(t.changedIds),s=0;s<n.length;s++)(r=n[s])&&(d=t.changedIds[s],c=o.model.getRecordMetadata(d),l=o.model.getRecord(d),o._updateRecordState(r,d,l,c))}else if(t.recordIds){for(n=o._elementsFromRecordIds(t.recordIds),s=0;s<n.length;s++)(r=n[s])&&(d=t.recordIds[s],c=o.model.getRecordMetadata(d),l=t.records[s],"delete"===e?(!a.hideDeletedRows&&i&&null!==c||o._removeFocus(r),i&&null!==c?o._updateRecordState(r,d,l,c):o._removeRecord(r)):o._updateRecordState(r,d,l,c));"delete"===e&&(0===o.model.getTotalRecords()?o.refresh():a.hideDeletedRows&&(o.element.find(".is-deleted").removeClass("is-selected").removeAttr("aria-selected"),o._updateStatus()))}else"set"===e||"metaChange"===e?null!==o.ignoreFieldChange&&o.ignoreFieldChange===t.field||(l=t.record,d=o.model.getRecordId(l),t.oldIdentity&&o._identityChanged(t.oldIdentity,d),c=o.model.getRecordMetadata(d),(n=o._elementsFromRecordIds([d])).length>0&&n[0]&&("set"===e&&o._updateRecordField(n[0],l,t.field,c),o._updateRecordState(n[0],d,l,c))):"instanceRename"===e&&o.modelName[1]===t.oldInstance&&(o.modelName[1]=t.newInstance);o._updateTotalRecords()}},progressView:this.element,progressOptions:a.progressOptions}),i=this.model.getOption("onlyMarkForDelete"),this.options.pagination.scroll&&this.scrollParent$&&this.scrollParent$.scrollTop(0),this.pageOffset=0,this.pageCount=0}},_renderButton:function(e,t,s,i){e.markup("<button class='"+t+"' type='button'").attr("aria-label",i).attr("title",i).markup("><span aria-hidden='true' class='a-Icon ").attr(s).markup("'></span></button>")},_renderAltDataMessages:function(e,t){var s=this.options;function i(s,i,a,o){e.markup("<div class='"+s+" a-GV-altMessage' style='display:none;'><div class='a-GV-altMessage-icon'>").markup("<span aria-hidden='true' class='a-Icon "+a+"'></span>").markup("</div><span class='a-GV-altMessage-text'").optionalAttr("id",t?t+i+"_msg":null).markup(">").markup(o).markup("</span></div>")}i("a-GV-noDataMsg","_no",s.noDataIcon,s.noDataMessage),i("a-GV-moreDataMsg","_more","icon-warning",s.moreDataMessage)},_renderLoadMore:function(e){var t=this.options;t.pagination.scroll&&t.pagination.loadMore&&!this.scrollPaging&&e.markup("<div class='a-GV-loadMore'><button type='button' class='js-load a-GV-loadMoreButton'>").content(l("LOAD_MORE")).markup("</button></div>")},_renderFooter:function(e,t){var s,i,a=this.options;function o(){var s=l("PAGE_RANGE");e.markup("<span class='js-rangeDisplay'").optionalAttr("id",t?t+"_pageRange":null).attr("title",s).markup("><span class='u-vh'>").content(s).markup("</span><span class='a-GV-pageRange'></span></span>")}a.footer&&(e.markup("<div class='a-GV-footer'><div class='a-GV-stateIcons'></div><div").optionalAttr("id",t?t+"_status":null).markup(" class='a-GV-status'></div><div class='a-GV-pagination'>"),a.pagination&&(s=!1,i=this.model.getOption("hasTotalRecords"),a.pagination.scroll||(i&&a.pagination.firstAndLastButtons&&this._renderButton(e,"a-GV-pageButton a-GV-pageButton--nav js-pg-first","icon-first",l("FIRST_PAGE")),this._renderButton(e,"a-GV-pageButton a-GV-pageButton--nav js-pg-prev","icon-prev",l("PREV_PAGE"))),i&&(a.pagination.showPageLinks||a.pagination.showPageSelector)?e.markup("<span class='a-GV-pageSelector'></span>"):a.pagination.showRange&&(o(),s=!0),a.pagination.scroll||(this._renderButton(e,"a-GV-pageButton a-GV-pageButton--nav js-pg-next","icon-next",l("NEXT_PAGE")),i&&a.pagination.firstAndLastButtons&&this._renderButton(e,"a-GV-pageButton a-GV-pageButton--nav js-pg-last","icon-last",l("LAST_PAGE"))),!s&&a.pagination.showRange&&o()),e.markup("</div></div>"))},_refreshPagination:function(e){var t=this.options;this.scrollPaging=t.pagination.scroll&&(this.model.getOption("hasTotalRecords")||!t.pagination.loadMore),this.lastScrollTop=0,this.lastScrollLeft=0,e.length&&(t.hasSize||(e=t.scrollParentOverride?o(t.scrollParentOverride):o(window)),this.lastScrollLeft=e.scrollLeft(),this.lastScrollTop=e.scrollTop())},_paginationHasFocus:function(){var e,t=o(document.activeElement);if(t.closest(".a-GV-footer").length>0){if(t.parent().hasClass("a-GV-pageSelector-item"))return t.parent().attr("data-value");if(e=/js-pg-\S+/.exec(t.attr("class")))return"."+e[0]}return!1},_restorePaginationFocus:function(e){var t,s;e&&((t=e)>=0&&(t="[data-value='"+e+"'] button"),(s=this.footer$.find(t))[0]&&s[0].disabled&&(s=this.footer$.find(":focusable").eq(0)),s.focus())},_initPaginationFooter:function(e){var t=this,s=this.options,i=this.element.hasClass("u-RTL")?"right":"left";this.pageKey=null,this.footer$=this.element.find(".a-GV-footer"),this.status$=this.footer$.find(".a-GV-status"),this.stateIcons$=this.footer$.find(".a-GV-stateIcons"),this.pageRange$=this.footer$.find(".a-GV-pageRange"),this.pageSelector$=this.footer$.find(".a-GV-pageSelector"),this.noData$=this.element.find(".a-GV-noDataMsg"),this.moreData$=this.element.find(".a-GV-moreDataMsg"),o.ui.tooltip&&this.stateIcons$.tooltip({content:function(){var e=o(this).attr("data-state");return t.stateIconMessages[e]},items:"[data-state]",show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip",position:{my:i+" bottom",at:i+" top-10",collision:"flipfit"}}),this._updateScrollHandler(e),s.pagination.scroll&&(this.pageOffset=0,this.pageCount=0),!s.hasSize&&s.footer&&s.stickyFooter&&o.apex.stickyWidget&&this.footer$.stickyWidget({isFooter:!0,toggleWidth:!0,stickToEnd:!0,top:function(){return t.element.offset().top+t._getHeaderHeight()}}),s.pagination.showPageLinks?this.pageSelector$.click((function(e){var s=o(e.target).parent();s.length&&t.gotoPage(parseInt(s.attr("data-value"),10)),e.preventDefault()})):s.pagination.showPageSelector&&this.pageSelector$.change((function(e){t.gotoPage(parseInt(o(e.target).val(),10))})),this.footer$.find(".js-pg-first").click((function(){t.firstPage()})),this.footer$.find(".js-pg-prev").click((function(){t.previousPage()})),this.footer$.find(".js-pg-next").click((function(){t.nextPage()})),this.footer$.find(".js-pg-last").click((function(){t.lastPage()})),this.element.find(".js-load").click((function(){t.loadMore()}))},_footerHeight:function(){return this.footer$&&this.footer$.outerHeight()||0},_addNextPage(){if(this.renderInProgress)return!1;let e=this.model.getTotalRecords();return(e<0||this.pageOffset+this.pageCount<e)&&(this.pageOffset+=this.pageCount,this._addPageOfRecords()),!0},_addPageOfRecords:function(e){var t,s,i,a,n,r,l=this._hasControlBreaks(),d=this,c=this.options,g=this._getDataRenderContext();function u(e,t,s,i,a){var o;return e>=t||(s.attr("data-start",e),s.attr("data-end",t),o=Math.floor((t-e)/i)*a,s.css("height",o),!1)}if(!this.renderInProgress){if(n=d.noData$.parent().children().not(".a-GV-altMessage"),(this.noData||this.moreData$.is(":visible"))&&(this.noData$.hide(),this.moreData$.hide(),n.show(),this.resize()),a=d._getDataContainer(),0!==this.pageOffset&&c.pagination.scroll||(this.pageFirstOffset="",this.pageLastOffset=""),this.controlBreakCollapsed=!!l&&null,l)if(0!==this.pageOffset&&c.pagination.scroll){let e=this.model.getOption("metaField");if(e){let t,s=this.model.recordAt(this.pageOffset-1);s&&(t=this.model.getValue(s,e),r=!0===t.endControlBreak)}}else r=!0;t=0,s=this.pageSize,c.pagination.scroll||(this.pageOffset=h(this.pageOffset,this.pageSize)),i=this.pageOffset,this.renderInProgress=!0,this.model.forEachInPage(this.pageOffset,s,(function(h,p,f){var m,_,v;h&&(_=(m=f?this.model.getRecordMetadata(f):{}).serverOffset,l&&!m.agg&&(!0,r&&(r=!1,v=this._controlBreakLabel(h),this._renderBreakRecord(g,!0,v,_)),m.endControlBreak&&(r=!0)),this._renderRecord(g,h,p,f,m),void 0!==_&&(_+=1,""===this.pageFirstOffset&&(this.pageFirstOffset=_),this.pageLastOffset=_),t+=1),t!==s&&h||function(){var s,r,l,h,p,f=null,m=d.model.getOption("hasTotalRecords"),_=d.displayPageHeight/d.displayPageSize;if(d.pageCount=t,0===d.pageOffset&&0===t)d.noData=!0,n.hide(),d.moreData$.hide(),d.noData$.show(),c.autoAddRecord&&d.model.allowAdd()&&d._autoAddRecord();else{if(0===t)return void(c.pagination.scroll||(d.pageOffset-=d.pageSize,d.pageOffset<0&&(d.pageOffset=0),d.renderInProgress=!1,d._addPageOfRecords()));d.noData=!1,d.noData$.hide(),d.model.getDataOverflow()&&c.moreDataMessage?(d.moreData$.show(),n.hide()):(d.moreData$.hide(),n.show()),d.scrollPaging&&m?(s=a.last().find(".a-GV-scrollFiller"),p=l=d.model.getTotalRecords(),0===s.length?(r=d._getDataRenderContext(),d._renderFillerRecord(r,"a-GV-scrollFiller"),(s=d._insertFiller(r,null)).attr("data-start",0),s.attr("data-end",l),s=s.last()):0===s.last().next().length&&(p=parseInt(s.last().attr("data-end"),10)),2===a.length&&(f=a.first().find(".a-GV-scrollFiller")),l!==p&&(s.last().attr("data-end",l),f&&f.last().attr("data-end",l)),h=d._getRecordsPerRow(),s.each((function(e){var a,n=!1,l=!1,c=o(f?[f[e],this]:this),p=parseInt(c.last().attr("data-start"),10),m=parseInt(c.last().attr("data-end"),10);if(i<=p?(n=u(i+t,m,c,h,_),d._insertData(g,i,t,c,"before"),l=!0):i+t<m?(u(i+t,m,c,h,_),r=d._getDataRenderContext(),d._renderFillerRecord(r,"a-GV-scrollFiller"),a=d._insertFiller(r,c),u(p,i-1,a,h,_),n=d._insertData(g,i,t,c,"before"),l=!0):i+t!==m+1&&e!==s.length-1||(n=u(p,i-1,c,h,_),d._insertData(g,i,t,c,"after"),l=!0),l)return n&&c.remove(),!1}))):d._insertData(g,i,t)}if(d._updateTotalRecords(),d.renderInProgress=!1,c.pagination.scroll&&(d.controlBreakCollapsed||!m&&a.last().height()<d.scrollParent$.height())){let t=d.model.getTotalRecords();if(t<0||d.pageOffset+d.pageCount<t){let t=!0;d.pageOffset+=d.pageCount,d.scrollPaging&&m&&(t=!1,(s=a.last().find(".a-GV-scrollFiller")).each((function(){if(d.pageOffset===parseInt(o(this).attr("data-start"),10))return t=!0,!1}))),t&&d._addPageOfRecords(e)}}else e&&e()}()}),this)}},_initPageSize:function(){var t,s,i,a,n=this.options,r=n.hasSize?this.scrollParent$[0]:document;r||(r=document),t=this._getRecordHeight(),r===document?(s=o(window).height(),this.footer$.hasClass("js-stickyWidget-toggle")&&(s-=this._footerHeight()),(a=this._getStickyTop())>0&&(s-=a+this._getHeaderHeight())):s=r.offsetHeight,s-=e.getScrollbarSize().height,t<=0&&(t=24),(i=Math.floor(s/t))<1&&(i=1),this.displayPageSize=i,this.displayPageHeight=i*t,i*=this._getRecordsPerRow(),this.options.rowsPerPage||(this.pageSize=n.pagination.scroll?Math.max(40,2*i):i)},_updateStatus:function(){var e,t=this._selectedCount(),s="";this.options.hideDeletedRows&&(e=this._deletedCount()),t>0&&(s+=i.format(this._selectedStatusMessage(),t)),e>0&&(s&&(s+=", "),s+=d("DELETED_COUNT",e)+" "),this.status$.text(s)},_setModelValue:function(e,t,s,i,a){var o,n,r,d,h;e&&e.removeClass("is-active"),o=t.getValue(),a||(this.ignoreFieldChange=i),h=this.model.getRecordId(s),null!==(n=this.model.getValue(s,i))&&"object"==typeof n&&n.hasOwnProperty("v")&&(o={v:o,d:t.displayValueFor(o)}),"DUP"===this.model.setValue(s,i,o)?(this._setColumnItemValue(t,s,i),apex.message.alert(l("DUP_REC_ID"))):(r=t.getValidity(),d=this.model.getRecordId(s),r.valid?this.model.setValidity("valid",d,i):this.model.setValidity("error",d,i,t.getValidationMessage()),d!==h&&this._identityChanged(h,d)),a||(this.ignoreFieldChange=null)},_initColumnItems:function(e){var t,i,r,l,d,h=!0;for(this.columnItems={},this.columnItemsContainer$=null,t=0;t<e.length;t++)d=null,(l=(i=e[t]).elementId)&&(n[l]?r=(d=this.columnItems[i.property]=n[l]).item:(r=a(l)).node&&(h=!1,n[l]=d=this.columnItems[i.property]={element$:o("#"+l).closest(".a-GV-columnItem"),item:r}),d&&!this.columnItemsContainer$&&(this.columnItemsContainer$=d.element$.parent()));this.columnItemsContainer$?h||this.columnItemsContainer$.find(":tabbable").addClass("js-tabbable").attr("tabindex",-1):this.editable&&s.error("An editable "+this.widgetName+" must have at least one column with a column item.")},_activateColumnItem:function(e,t){var s=e.element$;s.find(".js-tabbable").attr("tabindex",0).removeClass("js-tabbable"),t&&s.find(":tabbable").first().attr("aria-labelledby",t)},_deactivateColumnItem:function(e,t){var s=e.element$,i=s.find(":tabbable");i.first().removeAttr("aria-labelledby"),this.columnItemsContainer$.append(s),i.addClass("js-tabbable").attr("tabindex",-1)},_renderFieldDataValue:function(t,s,i,a,o){var n,l,d,h=null,c=this.options;(o&&o.url||s.linkTargetColumn)&&!a.agg&&(h=s.linkTargetColumn?this.model.getValue(i,s.linkTargetColumn)||null:o.url),n=this.model.getValue(i,s.property),(a.agg||a.inserted&&s.readonly)&&this.model.isIdentityField(s.property)&&(n=""),(s.linkText||s.linkAttributes||s.cellTemplate)&&(l={model:this.model,record:i}),h&&(t.markup("<a").attr("href",h),s.linkAttributes&&t.markup(r(s.linkAttributes,l)),t.markup(" tabindex='-1'>")),h&&s.linkText?t.markup(r(s.linkText,l)):s.cellTemplate?a.agg?(n=null==n?"":n,t.content(""+n)):(n=r(s.cellTemplate,l),c.highlighter&&(n=c.highlighter(c.highlighterContext,n,s)),t.markup(n)):null!==n&&""!==n||!(c.showNullAs||a.agg||h)?(null===n&&(n=""),"object"==typeof n&&n.hasOwnProperty("d")?n=n.d:(d=this.columnItems[s.property])&&(n=d.item.displayValueFor(n,{readonly:o&&!!o.ck||s.readonly||a.deleted||!1,disabled:o&&o.disabled||!1})),!1!==s.escape&&(n=e.escapeHTML(""+n)),c.highlighter&&(n=c.highlighter(c.highlighterContext,n,s)),t.markup(n)):(n=a.agg||a.inserted||o&&(o.changed||o.error||o.warning)?"":h||c.showNullAs,t.content(n)),h&&t.markup("</a>")},_beginSetColumnItems:function(){this.reinitCallbacks=[]},_setColumnItemValue:function(e,t,s,i){var a,o=null,n=this.model.getValue(t,s);null!==n&&"object"==typeof n&&n.hasOwnProperty("d")&&(o=n.d,n=n.v),this.reinitCallbacks?(a=e.reinit(n,o))&&this.reinitCallbacks.push(a):e.setValue(n,o),i&&(i.fields&&i.fields[s]&&i.fields[s].disabled?e.disable():e.enable())},_endSetColumnItems:function(){var e,t=this.reinitCallbacks;if(t)for(e=0;e<t.length;e++)t[e]();this.reinitCallbacks=null},_autoAddRecord:function(e){var t=this.model.insertNewRecord(null,e);this.model.getRecordMetadata(t).autoInserted=!0},_triggerBeginEditing:function(e,t){this.element.trigger("apexbeginrecordedit",[{model:this.model,record:e,recordId:t}])},_triggerEndEditing:function(e,t){this.element.trigger("apexendrecordedit",[{model:this.model,record:e,recordId:t}])},_updateHighlights:function(){var e,t,s=this.options,i=[],a="";for(e in s.highlights)s.highlights.hasOwnProperty(e)&&((t=s.highlights[e]).id=e,i.push(t));for(i.sort((function(e,t){return t.seq-e.seq})),e=0;e<i.length;e++)(t=i[e]).cssClass||(t.cssClass=(t.row?"hlr_":"hlc_")+t.id),(t.color||t.background)&&(t.row?a+="."+t.cssClass+" td":a+="td."+t.cssClass,a+=" { ",t.color&&(a+="color: "+t.color+" !important; "),t.background&&(a+="background-color: "+t.background+" !important; "),a+="}\n");!this.gridStyles$&&a&&(this.gridStyles$=o("<style type='text/css'></style>"),o("head").append(this.gridStyles$)),this.gridStyles$&&(this.gridStyles$=this.gridStyles$.text(a))},_setOption:function(e,t){var i=this.options;this._super(e,t),"noDataMessage"===e?this.element.find(".a-GV-altMessage > .a-GV-altMessage-text").text(t):"noDataIcon"===e?this.element.find(".a-GV-altMessage > .a-GV-altMessage-icon span").attr("class","a-Icon "+t):"rowsPerPage"===e?(i.pagination.scroll&&(i.rowsPerPage=null),i.rowsPerPage&&(this.pageSize=i.rowsPerPage)):"hideDeletedRows"===e?(this.element.toggleClass("a-GV--hideDeleted",t),!0===t&&this.element.find(".is-deleted").removeClass("is-selected").removeAttr("aria-selected"),this._updateStatus()):"scrollParentOverride"===e&&(i.hasSize?s.warn("Ignoring scrollParentOverride when hasSize is true."):this._updateScrollHandler())},_updateScrollHandler:function(e){var t=this,s=this.options,i=s.hasSize,a=this.scrollParent$,n=s.scrollParentOverride;i?(this.scrollParent$=e,this.scrollDelta=0):(this.scrollParent$=o(n||window),this.scrollDelta=this.element.offset().top-this._getStickyTop()),this.scrollPaging&&(a&&this._scrollHandler?a.off("scroll",null,this._scrollHandler):this._scrollHandler=function(){t.element[0].clientWidth>0&&t._scrollPage()},this.scrollParent$.on("scroll",null,this._scrollHandler))},_scrollPage:function(){var e=this,t=!this.model.getOption("hasTotalRecords"),s=this.scrollParent$.scrollTop();s!==this.lastScrollTop&&(this.lastScrollTop=s,this.scrollPageTimer||(this.scrollPageTimer=setTimeout((function(){e.options;var s,i,a,n,r,l,d,c,g=e.displayPageHeight/e.displayPageSize;e.scrollPageTimer=null,e.renderInProgress||(r=e.scrollParent$.height(),d=(l=0-r/2)+(r*=2),t?(a=(i=e._getDataContainer().first()).height(),0-((e.scrollParent$[0]===window?i.offset().top:i.position().top)-e.scrollParent$.scrollTop())+1.5*r>a&&((c=e.model.getTotalRecords())<0||e.pageOffset+e.pageCount<c?(e.pageOffset+=e.pageCount,e._addPageOfRecords()):e.scrollParent$.off("scroll",null,e._scrollHandler))):((s=e._getDataContainer().first().find(".a-GV-scrollFiller")).length||e.scrollParent$.off("scroll",null,e._scrollHandler),n=e.pageOffset,s.each((function(){var t,s,i=o(this),a=i.height(),c=parseInt(i.attr("data-start"),10),u=parseInt(i.attr("data-end"),10);if(c!==u)return t=(s=(e.scrollParent$[0]===window?i.offset().top:i.position().top)-e.scrollParent$.scrollTop())+a,s<=d&&t>=l?(e.pageOffset=a<2*r||s>l?c:h(t<d?u:c+Math.floor((a-t)/g),e.pageSize),e.pageOffset!==n&&e._addPageOfRecords(),!1):void 0}))))}),300)))},_updateTotalRecords:function(){var e,t,s,i,a,n,r,h,c=null,g=null,u=this.options,p=u.pagination,f=this.model.getTotalRecords(),m=this.model.getServerTotalRecords();if(f>=0&&(c=Math.ceil(f/this.pageSize),g=Math.floor(this.pageOffset/this.pageSize)),null!==this.lastScrollLeft&&(this.scrollParent$.scrollLeft(this.lastScrollLeft),this.scrollParent$.scrollTop(this.lastScrollTop),this.lastScrollLeft=null,this.lastScrollTop=null),this.onLastPage=!1,0===this.pageCount&&0===this.pageOffset?(i="",this.onLastPage=!0,this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr("disabled",!0)):(this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr("disabled",!1),this.element.find(".js-load").attr("disabled",!1),0===this.pageOffset&&this.footer$.find(".js-pg-prev,.js-pg-first").attr("disabled",!0),f>0&&g===c-1&&(this.onLastPage=!0,this.footer$.find(".js-pg-next,.js-pg-last").attr("disabled",!0),this.element.find(".js-load").attr("disabled",!0)),r=this.model.getOption("hasTotalRecords"),i=this.scrollPaging&&r?d("TOTAL_PAGES",m):r?p.hideSinglePage&&1===c?d("TOTAL_PAGES",m):d("PAGE_RANGE_XYZ",this.pageFirstOffset,this.pageLastOffset,m):d("PAGE_RANGE_XY",this.pageFirstOffset,this.pageLastOffset)),document.activeElement&&document.activeElement.disabled&&o(document.activeElement).hasClass("js-load")&&this.focus(),this.pageRange$.text(i),c>0){if(p.showPageLinks){if(n=f+"_"+this.pageSize+"_"+g,this.pageKey!==n){for(h="<li class='a-GV-pageSelector-item'>&hellip;</li>",this.pageKey=n,a="<ul class='a-GV-pageSelector-list'>",(t=g-Math.floor(p.maxLinks/2))<0&&(t=0),(s=t+p.maxLinks)>=c&&(t=(s=c)-p.maxLinks)<0&&(t=0),t>0&&(a+=h),e=t;e<s;e++)a+="<li class='a-GV-pageSelector-item' data-value='"+e+"'><button class='a-GV-pageButton' type='button'>"+(e+1)+"</button></li>";s<c&&(a+=h),a+="</ul>",this.pageSelector$.html(a)}this.pageSelector$.find(".is-selected").removeClass("is-selected"),this.pageSelector$.find("[data-value="+g+"]").addClass("is-selected")}else if(p.showPageSelector){if(n=f+"_"+this.pageSize,this.pageKey!==n){for(this.pageKey=n,a="<select class='a-GV-pageSelectlist' size='1' aria-label='"+l("PAGE_SELECTION")+"'>",e=0;e<c;e++)a+="<option value='"+e+"'>"+d("SELECT_PAGE_N",e+1)+"</option>";a+="</select>",this.pageSelector$.html(a)}this.pageSelector$.children("select").val(g)}}else this.pageSelector$.empty(),this.pageKey=null;p.hideSinglePage&&!p.scroll&&this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last"+(r?"":",.js-rangeDisplay")).add(this.pageSelector$)[1===c?"hide":"show"](),u.hideEmptyFooter&&this.footer$[this.noData?"hide":"show"]()},_getHeaderHeight:function(){return 0},_getStickyTop:function(){return 0},_getRecordsPerRow:function(){return 1},_getDataRenderContext:function(){return e.htmlBuilder()},_getDataContainer:function(){return o()},_selectedCount:function(){return 0},_selectedStatusMessage:function(){return i.getMessage(this.options.selectionStatusMessageKey)},_deletedCount:function(){return 0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(e){return[]},_renderFillerRecord:function(e,t){},_insertFiller:function(e,t){return o()},_insertData:function(e,t,s,i,a){},_controlBreakLabel:function(e){return{label:""}},_renderBreakRecord:function(e,t,s,i){e.markup("<h3>").content(s.label).markup("</h3>")},_renderRecord:function(e,t,s,i,a){},_removeRecord:function(e){},_insertRecord:function(e,t,s,i,a){return o()},_afterInsert:function(e,t){},_identityChanged:function(e,t){},_replaceRecord:function(e,t,s,i,a){},_updateRecordField:function(e,t,s,i){},_removeFocus:function(e){},_updateRecordState:function(e,t,s,i){}});var c=o.ui.keyCode;o.widget("apex.tableModelView",o.apex.tableModelViewBase,{version:"19.1",widgetEventPrefix:"tableModelView",options:{beforeTemplate:"<ul>",recordTemplate:null,afterTemplate:"</ul>",collectionClasses:null,iconClassColumn:null,imageURLColumn:null,imageAttributes:null,labelColumn:null,linkTarget:!1,linkTargetColumn:null,linkAttributes:null,useIconList:!1,iconListOptions:{},constrainNavigation:!0,selectionChange:null,pageChange:null},_create:function(){var e=this.options,t=this.element;s.info("TabelModelView '"+t[0].id+"' created. Model: "+e.modelName),t.addClass("a-TMV"),this.rowHeight=null,this.recPerRow=null,this._super(),this._initModel(e.modelName),this._on(this._eventHandlers),this._initRecordTemplate(),this.refresh(),e.disabled&&this._setOption("disabled",e.disabled)},_eventHandlers:{keydown:function(e){var t,s=this.options,i=e.which;s.useIconList&&!e.isDefaultPrevented()&&(!(t=this.getIconList().options).navigation&&t.noNavKeyContent&&o(e.target).closest(t.noNavKeyContent).length||(i!==c.DOWN&&i!==this.getIconList().forwardKey||!s.pagination.loadMore?(i===c.UP||i===this.getIconList().backwardKey)&&s.pagination.loadMore&&o(e.target).hasClass("js-load")&&(this.getIconList().focus(),e.preventDefault()):this.element.find(".js-load").not(":disabled").focus()[0]&&e.preventDefault(),!s.constrainNavigation||i!==c.DOWN&&i!==c.UP&&i!==c.LEFT&&i!==c.RIGHT&&i!==c.PAGE_UP&&i!==c.PAGE_DOWN||e.preventDefault()))},resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())}},_destroy:function(){this._tableModelViewDestroy(),this.element.removeClass("a-TMV is-disabled").empty(),this.data$=null,this._initModel(null)},_setOption:function(e,t){this.options;if(s.info("TabelModelView '"+this.element[0].id+"' set option '"+e+"' to: ",t),"iconListOptions"===e)throw new Error("TabelModelView "+e+" cannot be set. Set options directly on the iconList widget");if(this._super(e,t),"disabled"===e){if(this.element.toggleClass("is-disabled",t),this.options.useIconList)return this.getIconList().option(e,t);t&&this.resize()}else"modelName"===e?(this._initModel(t),this.refresh(!1)):"highlights"===e?this._updateHighlights():"beforeTemplate"===e||"recordTemplate"===e||"afterTemplate"===e||"collectionClasses"===e||"iconClassColumn"===e||"imageURLColumn"===e||"imageAttributes"===e||"labelColumn"===e||"linkTarget"===e||"linkTargetColumn"===e||"linkAttributes"===e?(this._initRecordTemplate(),this.refresh()):"footer"!==e&&"useIconList"!==e&&"pagination"!==e||this.refresh()},refresh:function(e){var t,s=!1,i=this,a=this.element;!0!==e&&(s=this._paginationHasFocus()),void 0===e&&(e=o(document.activeElement).closest(a).length>0),this._refreshCheckIfVisible()&&(this.data$&&(t=this.getSelectedRecords()),this._refreshPagination(a.find(".a-TMV-w-scroll")),this._initView(),this._updateStatus(),this.resize(),this._addPageOfRecords((function(){s&&(i._restorePaginationFocus(s),e=!1),t&&t.length>0&&i.setSelectedRecords(t,e)})))},resize:function(){var e,t,s,i,a=this.element,n=this.options,r=a.height(),l=a.children().first(),d=a.find(".a-TMV-w-scroll");null!==a[0].offsetParent&&(l.length&&!this.pendingRefresh?(e=a.width(),d.width(e),this.rowHeight=null,this.recPerRow=null,n.hasSize&&(t=r-this._footerHeight(),l.height(t),d.height(t)),n.useIconList&&(this.data$.iconList("resize"),this.scrollPaging&&(s=this._getRecordsPerRow(),i=this._getRecordHeight(),this.data$.find(".a-GV-scrollFiller").each((function(){var e,t=o(this),a=parseInt(t.last().attr("data-start"),10),n=parseInt(t.last().attr("data-end"),10);e=Math.floor((n-a)/s)*i,t.css("height",e)})))),this._initPageSize()):this.refresh())},focus:function(){var e=this.getIconList();if(e)return e.focus();this.data$.find(":focusable").first().focus()},getSelection:function(){var e=this.getIconList();return e?e.getSelection():null},setSelection:function(e,t,s){var i=this.getIconList();if(i)return i.setSelection(e,t,s)},getRecords:function(e){var t,s,i=this,a=[];return e.each((function(){(t=o(this).attr("data-id"))&&(s=i.model.getRecord(t))&&a.push(s)})),a},getSelectedRecords:function(){return this.options.useIconList&&this.data$?this.getRecords(this.getSelection()):null},setSelectedRecords:function(e,t,s){var i,a=[],n={};if(this.options.useIconList&&this.data$){for(i=0;i<e.length;i++)n[this.model.getRecordId(e[i])]=1;this.data$.children().each((function(){var e=o(this).attr("data-id");n[e]&&a.push(this)})),this.setSelection(o(a),t,s)}},getIconList:function(){return this.options.useIconList&&this.data$?this.data$.data("apex-iconList"):null},_initRecordTemplate:function(){var e,t,s=this.options;if(!s.recordTemplate){if(s.collectionClasses||(s.collectionClasses="a-TMV-defaultIconView"),!s.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");s.beforeTemplate="<ul>",s.afterTemplate="</ul>",e="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",s.linkTarget||s.linkTargetColumn?(e+="<a href='&"+(s.linkTargetColumn?s.linkTargetColumn:"APEX$ROW_URL")+".' class='a-IconList-content'"+(s.linkAttributes?" "+s.linkAttributes+" ":"")+">",t="</a>"):(e+="<span class='a-IconList-content'>",t="</span>"),(s.iconClassColumn||s.imageURLColumn)&&(e+="<span class='a-IconList-icon'>",s.iconClassColumn?e+="<span class='&"+s.iconClassColumn+".'></span>":e+="<img src='&"+s.imageURLColumn+".'"+(s.imageAttributes?" "+s.imageAttributes+" ":"")+"/>",e+="</span>"),e+="<span class='a-IconList-label'>&"+s.labelColumn+".</span>",e+=t+"</li>",s.recordTemplate=e}/^\s*<[\w]+[^>]*>/.exec(r(s.recordTemplate))||(r(s.beforeTemplate).toLowerCase().match(/<ul|<ol/)?s.recordTemplate="<li>"+s.recordTemplate+"</li>":s.recordTemplate="<div>"+s.recordTemplate+"</div>")},_initView:function(){var e,t=this,s=this.options,i=this._getDataRenderContext();this.recordElement="div",(e=/<([^ <>]*)/.exec(r(s.recordTemplate)))&&e.length>1&&(this.recordElement=e[1].toLowerCase()),i.markup("<div").attr("class","a-TMV-body").markup(">"),this._renderAltDataMessages(i),i.markup("<div").attr("class","a-TMV-w-scroll").markup(">").markup(r(s.beforeTemplate)).markup("<"+this.recordElement+" class='js-data-placeholder' style='display:none;'></"+this.recordElement+">").markup(r(s.afterTemplate)),this._renderLoadMore(i),i.markup("</div></div>"),this._renderFooter(i),this.element.html(i.toString()),this.data$=this.element.find(".js-data-placeholder").parent(),this.data$.empty().addClass(s.collectionClasses||""),s.useIconList&&(this.data$.iconList(s.iconListOptions),this.data$.on("iconlistselectionchange",(function(e){t._updateStatus(),t._trigger("selectionChange",e)}))),this._initPaginationFooter(this.element.find(".a-TMV-w-scroll"))},_initRecordMetrics:function(){var e,t=this.options;this.recPerRow=1,(e=this.data$.children().filter(":visible").first()).length?(t.useIconList&&(this.recPerRow=this.getIconList().getColumns()),this.rowHeight=e.outerHeight()):(e=o(r(t.recordTemplate)),e=this.data$.append(e),t.useIconList&&(this.getIconList().refresh(),this.recPerRow=this.getIconList().getColumns()),this.rowHeight=e.outerHeight(),this.data$.empty())},_getRecordHeight:function(){return this.rowHeight||this._initRecordMetrics(),this.rowHeight},_getRecordsPerRow:function(){return this.recPerRow||this._initRecordMetrics(),this.recPerRow},_getDataContainer:function(){return this.data$},_selectedCount:function(){return this.options.useIconList?this.getIconList().getSelection().length:0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(e){var t,s,i=[];for(t=0;t<e.length;t++)(s=this.data$.children("[data-id='"+e[t]+"']"))[0]&&i.push(s);return i},_renderFillerRecord:function(e,t){e.markup("<"+this.recordElement+" class='"+t+"'></"+this.recordElement+">")},_insertFiller:function(e,t){var s=o(e.toString());return t?t.before(s):this.data$.html(s),s},_insertData:function(e,t,s,i,a){var o,n;i?i[a](e.toString()):this.data$.append(e.toString()),this.options.useIconList&&(n=(o=this.element.find(".a-TMV-w-scroll")).scrollTop(),this.getIconList().refresh(),o.scrollTop(n)),this._trigger("pageChange",null,{offset:t,count:s})},_controlBreakLabel:function(e){return{label:""}},_renderBreakRecord:function(e,t,s,i){e.markup("<h3>").content(s.label).markup("</h3>")},_renderRecord:function(e,t,s,i,a){var o,n,l=this.options,d="",h={};a.agg||(h.APEX$ROW_ID=""+i,h.APEX$ROW_INDEX=""+(s+1),a.url&&(h.APEX$ROW_URL=a.url),a.deleted?d+=" is-deleted":(a.inserted?d+=" is-inserted":a.updated&&(d+=" is-updated"),a.error?d+=" is-error":a.warning&&(d+=" is-warning"),a.highlight&&((o=l.highlights[a.highlight])&&o.cssClass?d+=" "+o.cssClass:d+=" "+a.highlight)),d&&(h.APEX$ROW_STATE_CLASSES=d),n=r(this.options.recordTemplate,{extraSubstitutions:h,model:this.model,record:t}),l.highlighter&&(n=l.highlighter(l.highlighterContext,n)),e.markup(n))},_removeRecord:function(e){e.remove()},_insertRecord:function(t,s,i,a,n){var r,l=e.htmlBuilder();return this._renderRecord(l,s,null,i,a),r=o(l.toString()),"after"===n&&t?t.after(r):this.data$.prepend(r),this.options.useIconList&&this.getIconList().refresh(),r},_afterInsert:function(e,t){},_identityChanged:function(e,t){var s,i,a=this._elementsFromRecordIds([e])[0];a&&(s=this.model.getRecord(t),i=this.model.getRecordMetadata(t),this._replaceRecord(a,s,e,t,i))},_replaceRecord:function(t,s,i,a,o){var n=e.htmlBuilder();this._renderRecord(n,s,void 0,a,o),t.replaceWith(n.toString()),this.options.useIconList&&this.getIconList().refresh()},_removeFocus:function(e){},_updateRecordState:function(e,t,s,i){this._replaceRecord(e,s,t,t,i)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.jQuery);
!function(e,t,s,a,l,i,o,n){"use strict";var r=".a-GV-table",d=".a-GV-header,.a-GV-headerGroup,.a-GV-cell,.a-GV-controlBreakHeader",h="a-GV-controlBreak",c="a-GV-controlBreakHeader",u="is-selected",f="is-focused",p="is-active",m="aria-multiselectable",g="aria-readonly",C="none",b="label",v="true",_=n.ui.keyCode,w=0,G=e.invokeAfterPaint,H="wheel";"onwheel"in document.body||(H=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll");var I={begin:function(e,t,s){1===s.length&&t.records&&1===t.records.length?this.text="":(this.table=!0,this.text="<table><tbody>")},beginRow:function(){this.table&&(this.text+="<tr>")},cell:function(t,s,a,l){this.table?this.text+="<td>"+e.escapeHTML(l)+"</td>":this.text+=e.escapeHTML(l)},endRow:function(){this.table&&(this.text+="</tr>")},end:function(){this.table&&(this.text+="</tbody></table>")},toString:function(){return this.text}};function x(e,t){var s="";return"start"===e?s=" u-tS":"end"===e?s=" u-tE":"left"===e?s=" u-tL":"right"===e?s=" u-tR":"center"!==e||t||(s=" u-tC"),s}function V(e,t,s){var a;return e.highlight&&((a=t.highlights[e.highlight])&&a.cssClass?s+=" "+a.cssClass:s+=" "+e.highlight),s}function $(e,t,s,a,l){var i="a-GV-row";return e.agg?(i+=" is-aggregate",i+=" a-GV-aggregate--"+e.agg,e.grandTotal&&(i+=" is-grandTotal")):((e.sel||s)&&(i+=" "+u),e.deleted?i+=" is-deleted":(e.inserted?i+=" is-inserted":e.updated&&(i+=" is-updated"),e.error?i+=" is-error":e.warning&&(i+=" is-warning"),i=V(e,t,i),a.allowEdit(l)||(i+=" is-readonly"))),i}function y(e,t,s,a,l,i,o){var n=!1,r="a-GV-cell";return r+=x(e.alignment),e.columnCssClasses&&(r+=" "+e.columnCssClasses),e.cellCssClassesColumn&&(r+=" "+i.getValue(o,e.cellCssClassesColumn)),l&&(l.hasClass(u)&&(r+=" "+u),l.hasClass(f)&&(r+=" "+f),l.hasClass(p)&&(r+=" "+p)),s&&(t.deleted||(s.error?r+=" is-error":s.warning?r+=" is-warning":s.changed?r+=" is-changed":s.stale&&(r+=" is-stale")),r=V(s,a,r),s.disabled&&(r+=" is-disabled"),n=s.ck),(n||e.readonly)&&(r+=" is-readonly"),e.usedAsRowHeader&&!t.agg&&(r+=" a-GV-rowHeader"),r}function F(e){return a.getMessage("APEX.GV."+e)}function k(e){var t=Array.prototype.slice.call(arguments);return t[0]="APEX.GV."+e,a.formatMessage.apply(a,t)}function D(e,t){return e.offset-t.offset}function R(e){return e.parent().children().index(e)}function S(e){var t=n(e.toString());return t.find("a,button,input,select,textarea").prop("tabIndex",-1),t}function z(e){return n(e).closest(d)}function M(e){return n(e).closest(".a-GV-cell,.a-GV-controlBreakHeader")}function T(e){return n(e).closest(".a-GV-cell")}function E(e,t){var s,a,l=e.children();return l.last().hasClass("a-GV-headerGroup")?(a=0,l.each((function(){if((a+=parseInt(n(this).attr("colspan"),10)||1)>t)return s=n(this),!1}))):s=l.eq(t),s}function W(e){var t;return e.hasClass("a-GV-headerGroup")?(t=0,e.parent().children().each((function(){if(this===e[0])return!1;t+=parseInt(n(this).attr("colspan"),10)||1}))):t=R(e),t}function A(e){n("body").on("keydown.gridGlobalEscape",(function(t){t.which===_.ESCAPE&&(n("body").off("keydown.gridGlobalEscape"),e())}))}function P(){n("body").off("keydown.gridGlobalEscape")}function L(e){var t=e.groupName||null;return t&&e.useGroupFor&&e.useGroupFor.indexOf("heading")<0&&(t=null),t}var O=function(e,t,s){e.element.hasClass("a-GV")&&(e._updateStatus(),t&&e._trigger("selectionChange",s))},N=e.debounce(O,1),B=e.debounce(O,350);n.widget("apex.grid",n.apex.tableModelViewBase,n.extend(!0,{version:"20.2",widgetEventPrefix:"grid",options:{showNullAs:"-",stickyTop:!1,columns:null,columnGroups:null,columnSort:!0,columnSortMultiple:!0,resizeColumns:!0,reorderColumns:!0,collapsibleControlBreaks:!0,aggregateLabels:{},aggregateTooltips:{},tabbableCellContent:"a,button,input",allowEditMode:!0,allowDelete:!0,allowInsert:!0,allowCopy:!0,skipReadonlyCells:!1,rowHeader:C,rowHeaderCheckbox:!1,rowHeaderLabelColumn:null,rowHeaderWidth:null,selectCells:!1,multiple:!1,multipleCells:!0,selectAll:!0,allowSelectHidden:!1,persistSelection:!1,tooltip:{tooltipClass:"a-GV-tooltip"},dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},beginRow:function(e){e>0&&(this.text+="\r\n")},cell:function(e,t,s,a){e>0&&(this.text+="\t"),this.text+=a},endRow:function(){},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(I)}],constrainNavigation:!0,selectionChange:null,activateColumnHeader:null,activateCell:null,cancelColumnHeader:null,sortChange:null,columnReorder:null,columnResize:null,modeChange:null,pageChange:null},_create:function(){var e=this,t=this.options,a=this.element;s.info("Grid '"+a[0].id+"' created. Model: "+t.modelName),a.addClass("a-GV").attr("role","grid"),t.multiple&&a.attr(m,v),t.editable||a.attr(g,v),this.forwardKey=_.RIGHT,this.backwardKey=_.LEFT,"rtl"===a.css("direction")&&(a.addClass("u-RTL"),this.forwardKey=_.LEFT,this.backwardKey=_.RIGHT),this._enforceOptionConstraints(),this._super(),this.origLabelBy=a.attr("aria-labelledby"),this.idPrefix=a[0].id||"agv_"+w++,this.accContextId=this.idPrefix+"_ctx",this.curRowHeaders="",this.tableFrozenHeader$=null,this.tableHeader$=null,this.tableFrozenData$=null,this.tableData$=null,this.lastEditModeCell=null,this.frozenColumnCount=0,this.controlBreaks=[],this.editMode=!1,this.columns=null,this.columnsStale=!0,this.columnGroups=null,this.lastFrozenColIndex=-1,this.lastFocused=null,this.lastRow$=null,this.focusInHeader=!1,this.lastHoverCell=null,this.lastHoverRow=null,this.lastColIndex=null,this.columnControls$=null,this.scrollTimerId=null,this.deactivateDelayTimer=null,this.lastFloatingPos={},this.allSelected=!1,this.gotoCellPending=null,this._initContextMenu("tr",(function(t){return n(t.target).closest("a").length>0||e.editMode}),(function(t){var s;if((s=T("keydown"===t.type?this.lastFocused:t.target)).length){if(e.options.selectCells){if(!s.hasClass(u))return s}else if(!s.parent().hasClass(u))return s;return!0}return!1}),(function(t){e.options.selectCells?t.selectedRange=e.getSelectedRange():t.selectedRecords=e.getRecords(t.selection)})),this._initModel(t.modelName),this._on(this._eventHandlers),t.allowCopy&&i.addHandler(a[0],(function(t){return!e.editMode&&(e._copy(t),!0)})),this._updateHighlights(),this.refresh(),this._setSelectionMode(),t.disabled&&this._setOption("disabled",t.disabled)},_eventHandlers:{resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())},click:function(e){var t,s=this.options,a=n(e.target);if(a.closest("a,button,.a-GV-footer").length)(t=a.closest(".a-GV-header,.a-GV-headerGroup")).length?(this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1)):(t=a.closest(".a-GV-cell,.a-GV-controlBreakHeader")).length&&!this.editMode&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,"none",!1,!1),a.focus());else if(!(a.closest(".a-GV-floatingItem").length>0)){if((t=a.closest(".a-GV-selHeader.a-GV-header")).length)return this.focusInHeader=!0,this.lastColIndex=null,void(s.rowHeaderCheckbox&&s.multiple&&s.selectAll&&!s.selectCells?(t.find(".u-selector").attr("aria-checked")===v?this.setSelection(n()):this.selectAll(),this._select(t,e,!0,!1),this._setFocusable(t[0])):this._select(t,e,!0,!1));if((t=a.closest(".a-GV-headerGroup")).length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();if((t=a.closest(".a-GV-header")).length&&0===a.closest("button").length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),this._activateColumnHeader(e,t),void e.preventDefault();if((t=a.closest(".a-GV-selHeader")).length)return s.rowHeaderCheckbox&&!s.selectCells&&(e.ctrlKey=!0,e.shiftKey=!1),this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();(t=a.closest(".a-GV-cell")).length&&(this.focusInHeader=!1,this.lastColIndex=null,t.hasClass(p)||(this._checkInteractWithCellItem(e,a,t),this._select(t,e,!0,!1),e.preventDefault())),(t=a.closest(".a-GV-controlBreakHeader")).length&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),e.preventDefault())}},dblclick:function(e){var t=this.options,s=n(e.target).closest(".a-GV-cell").not(".a-GV-selHeader");s.length&&(t.editable&&t.allowEditMode?this.editMode||this.setEditMode(!0):this._fireActivate(e,s))},mousedown:function(e){var t,s=n(e.target);0!==e.originalEvent.button||s.closest("a,button,.a-GV-footer").length?this.focusInHeader=s.closest(".a-GV-header,.a-GV-headerGroup").length>0:!s.closest(".a-GV-expandCollapse").length&&this.editMode?(t=s.closest(".a-GV-cell"),this.editMode&&t.length&&!t.hasClass(p)&&this._checkInteractWithCellItem(null,s,t)):e.preventDefault()},keydown:function(e){var t,s,a,l,i,o,r,d,h,u=this,f=this.options,p=null,m=e.which,g=n(e.target);function C(){a.hasClass("a-GV-selHeader")?a.find(".u-selector").click():(u._activateColumnHeader(e,a),e.preventDefault())}function v(e,t){var s,a=null;for(s=e+=t;s>=0&&s<u.columns.length;s+=t)if(!u.columns[s].hidden){a=s;break}return a}if(!(g.closest(".a-GV-footer").length>0)){if(m!==_.PAGE_UP&&m!==_.PAGE_DOWN||(o=this.displayPageSize),m===_.HOME)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.first(),e.preventDefault());else if(m===_.END)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.last(),e.preventDefault());else if(m===_.PAGE_DOWN)this.focusInHeader||this.editMode&&!z(this.lastFocused).hasClass("a-GV-selHeader")||e.altKey||(!(p=this._getNextCellDown(M(this.lastFocused),o))&&f.pagination.loadMore&&this.element.find(".js-load").focus(),e.preventDefault());else if(m===_.PAGE_UP)this.focusInHeader||this.editMode&&!z(this.lastFocused).hasClass("a-GV-selHeader")||e.altKey||(p=this._getPrevCellUp(M(this.lastFocused),o,!0),e.preventDefault());else if(m===_.DOWN){if(a=z(this.lastFocused),f.columnSort&&e.altKey&&a.hasClass("a-GV-header"))return void u._sortChange(e,a,"desc");(!this.editMode||this.focusInHeader||a.hasClass("a-GV-selHeader")||a.hasClass(c))&&this.lastFocused&&!e.altKey&&(!(p=this._getNextCellDown(a,1))&&f.pagination.loadMore&&this.element.find(".js-load").focus()[0]&&e.preventDefault(),(p||f.constrainNavigation)&&e.preventDefault()),g.closest(".js-menuButton").length&&e.stopPropagation()}else if(m===_.UP){if(a=z(this.lastFocused),f.columnSort&&e.altKey&&a.hasClass("a-GV-header"))return void u._sortChange(e,a,"asc");(!this.editMode||this.focusInHeader||a.hasClass("a-GV-selHeader")||a.hasClass(c))&&this.lastFocused&&!e.altKey&&(g.hasClass("js-load")?(this.focus(),e.preventDefault()):p=this._getPrevCellUp(a,1),(p||f.constrainNavigation)&&e.preventDefault(),e.stopPropagation())}else if(m===this.backwardKey){if(e.altKey)return;if(a=z(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(a.hasClass("a-GV-header")||a.hasClass("a-GV-headerGroup"))&&(!a.hasClass("a-GV-selHeader")||"sequence"===f.rowHeader||f.rowHeader===b)&&(i=parseInt(a.attr("data-idx"),10),!isNaN(i)||e.ctrlKey||"sequence"===f.rowHeader||f.rowHeader===b))if(i>=0&&(l=this.columns[i]),e.shiftKey&&f.reorderColumns){if(e.preventDefault(),a.hasClass("a-GV-headerGroup"))r=R(a.parent()),i>0&&(this.moveColumnGroup(r,i,i-1),a=n(this.lastFocused).closest(".a-GV-headerGroup"));else if(i=v(i,-1))return void this.moveColumn(l,i)}else if(e.ctrlKey&&f.resizeColumns&&!a.hasClass("a-GV-headerGroup"))return void(l?a.outerWidth()>40&&((h=a.outerWidth()-10)<40&&(h=40),this.setColumnWidth(l,h)):u.rowHeaderWidth>40&&((h=u.rowHeaderWidth-10)<40&&(h=40),u.rowHeaderWidth=h,this._calculateColumnWidths(a,!0)));(!this.editMode||this.focusInHeader||a.hasClass(c))&&this.lastFocused&&(this.lastColIndex=null,(s=this.lastRow$.index(a))>0&&(s-=1,p=this.lastRow$.eq(s)),e.preventDefault())}else if(m===this.forwardKey){if(e.altKey)return;if(a=z(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(a.hasClass("a-GV-header")||a.hasClass("a-GV-headerGroup"))&&(!a.hasClass("a-GV-selHeader")||"sequence"===f.rowHeader||f.rowHeader===b)&&(i=parseInt(a.attr("data-idx"),10),!isNaN(i)||e.ctrlKey||"sequence"===f.rowHeader||f.rowHeader===b))if(i>=0&&(l=this.columns[i]),e.shiftKey&&f.reorderColumns){if(e.preventDefault(),a.hasClass("a-GV-headerGroup"))r=R(a.parent()),i<this.columnGroups[r].length-1&&(this.moveColumnGroup(r,i,i+1),a=n(this.lastFocused).closest(".a-GV-headerGroup"));else if(i=v(i,1))return void this.moveColumn(l,i)}else if(e.ctrlKey&&f.resizeColumns&&!a.hasClass("a-GV-headerGroup"))return void(l?this.setColumnWidth(l,a.outerWidth()+10):(u.rowHeaderWidth+=10,this._calculateColumnWidths(a,!0)));(!this.editMode||this.focusInHeader||a.hasClass(c))&&this.lastFocused&&(this.lastColIndex=null,(s=this.lastRow$.index(a))<this.lastRow$.length-1&&(s+=1,p=this.lastRow$.eq(s)),e.preventDefault())}else if(65===m&&e.ctrlKey&&!this.editMode)this.selectAll(null),e.preventDefault();else if(m===_.SPACE){if("BUTTON"===e.target.nodeName)return;if((a=g.filter(".a-GV-selHeader").find(".u-selector")).length)return a.click(),void e.preventDefault();if((a=z(this.lastFocused)).hasClass("a-GV-header"))C();else if(a.hasClass("a-GV-cell")&&(!this.editMode||a.hasClass("a-GV-selHeader"))){let t=this._checkInteractWithCellItem(e,g,a);this._select(a,e,!0,!0),t||e.preventDefault()}}else if(m===_.ENTER){if(!g.hasClass("a-GV-expandCollapse")&&g.closest("a,button,.js-uses-enter").length>0)return;if((a=g.filter(".a-GV-selHeader").find(".u-selector")).length)return void a.click();a=z(this.lastFocused),this.editMode&&(a.hasClass("a-GV-cell")||a.hasClass(c))?e.shiftKey?(p=this._getPrevCellUp(a,1,!0),e.shiftKey=!1):p=this._getNextCellDown(a,1):(e.preventDefault(),f.editable&&f.allowEditMode&&a.hasClass("a-GV-cell")&&!a.hasClass("a-GV-selHeader")?this.setEditMode(!0):a.hasClass("a-GV-header")?C():f.editable&&f.allowEditMode||!a.hasClass("a-GV-cell")||this._fireActivate(e,a))}else if(113===m)(a=T(this.lastFocused)).length&&f.editable&&f.allowEditMode&&!this.editMode&&this.setEditMode(!0);else if(m===_.ESCAPE)f.editable&&f.allowEditMode&&this.editMode&&this._doEscapeKey(e);else if(m===_.DELETE){if(f.editable&&f.allowDelete&&!this.editMode&&!this.focusInHeader){for(d=this.getSelectedRecords(),t=0;t<d.length;t++)this.model.allowDelete(d[t])||(d.splice(t,1),t-=1);d.length>0&&this.model.deleteRecords(d)}}else 45===m?f.editable&&f.allowInsert&&!this.editMode&&!f.selectCells&&this.model.allowAdd()&&((d=this.getSelectedRecords()).length>0?this.model.insertNewRecord(null,d[d.length-1]):this.model.insertNewRecord()):112===m&&e.altKey?this._doHelpKey():m===_.TAB&&this.editMode&&(this.lastKeyTab=!0);p&&(this._select(p,e,!0,!0),e.preventDefault())}},focusin:function(e){var t,s,a=null,l=this,i=n(e.target);i.closest(".a-GV-floatingItem").length?this._clearDeactivate():0!==(t=i.closest(d)).length?(t.addClass(f),this.lastEditModeCell!==t[0]?(this.editMode?(this.focusInHeader=!1,s=n(this.lastEditModeCell),this._clearDeactivate(),s.length&&this._deactivateCell(s),t.hasClass("a-GV-cell")||t.hasClass(c)?!t.hasClass("a-GV-selHeader")&&!t.hasClass(c)||this.lastKeyTab?(i.closest("a,button").length&&(a=e.target),setTimeout((function(){l.editMode&&!t.hasClass(p)&&l._activateCell(t,a)}),0)):(this._clearTabTraps(),this.lastEditModeCell=null,this._setFocusable(e.target),this._setTabTraps(t)):(this.focusInHeader=!0,this.lastEditModeCell=null,this._setFocusable(e.target))):this._setFocusable(e.target),this.lastKeyTab=!1):this._clearDeactivate()):i.hasClass("js-tabTrap")||(this.lastEditModeCell=null)},focusout:function(e){var t=n(e.target).closest(d),s=this._getColumnMetadata(t),a=s&&this.columnItems[s.property];t.removeClass(f),this.editMode&&t.hasClass("a-GV-cell")&&(null===this.lastEditModeCell&&this._clearTabTraps(),a&&a.item.isDisabled()||this._beginDeactivate(t))},mousemove:function(e){var t,s,a,l,i,o=n(e.target),r=this.options,c=o.closest(d);c.length?c[0]!==this.lastHoverCell&&((t=c.parent())[0]!==this.lastHoverRow&&(this._clearHoverStates(),this.lastHoverRow=t[0],!t.hasClass("a-GV-row")&&!t.hasClass(h)||this.columnReordering||this.columnWidthDragging||this._setRowHoverState(t)),this.lastHoverCell=c[0],this.columnControls$.hide(),this.columnHandle$.hide(),"TH"!==c[0].nodeName||c.hasClass("a-GV-cell")||t.hasClass(h)||(l=this.columns[c.attr("data-idx")],!r.columnSort||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")||c.hasClass("a-GV-headerGroup")||!l.canSort||(c.append(this.columnControls$.show()),this._updateColumnControls(l)),!r.reorderColumns||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")||(this.columnReorderCell$=c,c.append(this.columnHandle$.show().css("left",""))),!r.resizeColumns||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")&&"sequence"!==r.rowHeader&&r.rowHeader!==b||(s=c.closest("div")[0],a=c[0].offsetLeft+s.offsetLeft-s.scrollLeft,this.element.hasClass("u-RTL")||(a+=c.outerWidth()),this.columnWidthHandle$.show().css("left",a-this.columnWidthHandle$.width()/2),i=c.attr("data-idx"),this.columnWidthCell$=i?this._columnFromIndex(i):this.element.find(".a-GV-header.a-GV-selHeader")))):null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())},mouseleave:function(){null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())}},_doEscapeKey:function(e){var t=T(this.lastFocused);t.length&&this._setFocusable(t[0]),t.focus(),this.setEditMode(!1),t.length&&this._setFocus(this._getCellFocusable(t)),e.stopPropagation()},_doHelpKey:function(){var e,t=z(this.lastFocused);t.hasClass("a-GV-selHeader")||t.hasClass("a-GV-headerGroup")||t.hasClass(c)||(e=this._getColumnMetadata(t))&&e.helpid&&(this.editMode&&t.focus(),apex.theme.popupFieldHelp(e.helpid,$v("pInstance")))},_initTooltips:function(t){var a,l=this;n.ui.tooltip?(this.tooltipOptions&&(this.element.find(".a-GV-bdy").filter(":data('ui-tooltip')").tooltip("destroy"),this.tooltipOptions=null),t&&((a=this.tooltipOptions=n.extend(!0,{show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip"},t)).items="td,th",a._originalContent=a.content,a.content=function(t){var s,i,o,r=n(this),d=r.parent(),h=null,c=null,u=l._getColumnMetadata(r);if((s=d.attr("data-id"))&&(h=l.model.getRecordMetadata(s)),u&&h&&h.fields&&(c=h.fields[u.property]),h&&!h.deleted){if(c&&(c.error||c.warning))return"<span class='"+(i=c.error?"is-error":"is-warning")+"'>"+e.escapeHTML(c.message)+"</span>";if((h.error||h.warning)&&r.hasClass("a-GV-selHeader"))return"<span class='"+(i=h.error?"is-error":"is-warning")+"'>"+e.escapeHTML(h.message)+"</span>";if(h.agg&&u&&(o=l.options.aggregateTooltips[h.agg+"|"+u.property]))return"<span class='"+i+"'>"+e.escapeHTML(o)+"</span>"}return a._originalContent?a._originalContent.call(this,t,l.model,h,c,u):null},a.open=function(e,t){t.tooltip.find(".is-error").length&&t.tooltip.addClass("is-error"),t.tooltip.find(".is-warning").length&&t.tooltip.addClass("is-warning")},this.element.find(".a-GV-bdy,.a-GV-hdr").tooltip(a))):s.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;this._tableModelViewDestroy(),e.removeClass("a-GV is-disabled u-RTL").removeAttr("role").removeAttr(m).removeAttr(g).attr("aria-labelledby",this.origLabelBy).empty(),i.removeHandler(e[0]),s.info("Grid '"+e[0].id+"' destroyed. Model: "+this.options.modelName),this.tableData$=null,this.tableFrozenData$=null,this._initModel(null),this.gridStyles$&&this.gridStyles$.remove(),this._destroyContextMenu()},_setOption:function(e,t){var a=this.element,l=this.options;if(s.info("Grid '"+a[0].id+"' set option '"+e+"' to: ",t),this._checkContextMenuOptions(e,t),"allowCopy"===e)throw new Error("Grid "+e+" cannot be set");"editable"===e&&!t&&this.editMode?this.setEditMode(!1):"multiple"===e&&this.setSelection(n()),this._super(e,t),this._enforceOptionConstraints(),"disabled"===e?(a.toggleClass("is-disabled",t),this.lastFocused&&(t?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),t&&this.resize()):"selectCells"===e?this._setSelectionMode():"multiple"===e?(t?a.attr(m,v):a.removeAttr(m),l.rowHeader!==C&&l.rowHeaderCheckbox&&this.refreshColumns(),this.refresh()):"modelName"===e?(this.editMode&&this.setEditMode(!1),this._initModel(t),this.refresh(!1)):"highlights"===e?this._updateHighlights():"tooltip"===e?this._initTooltips(t):"rowHeader"!==e&&"rowHeaderCheckbox"!==e&&"rowHeaderLabelColumn"!==e&&"columnSort"!==e&&"resizeColumns"!==e&&"reorderColumns"!==e&&"editable"!==e&&"pagination"!==e&&"selectAll"!==e&&"footer"!==e&&"autoAddRecord"!==e||("editable"===e&&(t?a.removeAttr(g):a.attr(g,v)),this._refreshGrid())},_enforceOptionConstraints:function(){var e=this.options;e.rowHeaderCheckbox&&e.rowHeader===C&&(s.warn("Option rowHeaderCheckbox cannot be true when rowHeader is 'none'."),e.rowHeaderCheckbox=!1),!e.multiple||e.rowHeader!==C&&e.rowHeaderCheckbox||!apex.userHasTouched()||(e.rowHeader===C&&(e.rowHeader="plain"),e.rowHeaderCheckbox=!0),e.editable&&e.allowEditMode||(e.autoAddRecord=!1),e.rowHeader!==C&&(e.rowHeaderWidth?this.rowHeaderWidth=e.rowHeaderWidth:(e.rowHeaderCheckbox?this.rowHeaderWidth=34:this.rowHeaderWidth=16,"sequence"!==e.rowHeader&&e.rowHeader!==b||(this.rowHeaderWidth+=38)))},refresh:function(e){var t,a,l,i,o,r,d,h,c=!1,u=null,f=null,p=null,m=this,g=this.options,C=this.element;if(s.info("Grid '"+C[0].id+"' refreshed. Model: "+g.modelName),!0!==e&&(c=this._paginationHasFocus()),void 0===e&&(e=n(document.activeElement).closest(C[0]).length>0),this._refreshCheckIfVisible()){if((u=C.find(".is-active.a-GV-cell")).length&&this._deactivateCell(u),this.focusInHeader?this.columnsStale&&this.columns&&(p=R(n(this.lastFocused).closest("tr")),(a=n(this.lastFocused).closest("th").attr("data-idx"))&&(a=this.columns[a].property),this.lastFocused=null):this.lastFocused=null,this.tableData$&&(!g.persistSelection||g.selectCells))if(g.selectCells)(l=this.getSelection()).length>0&&(u=l[0].first(),i=R(u),this.tableFrozenData$&&0===u.closest(this.tableFrozenData$).length&&(i+=this.tableFrozenData$.find("tr").first().children().length),f={rowIndex:R(u.parent()),colIndex:i});else{for(l=this.getSelection(),f=[],t=0;t<l.length;t++)void 0!==(r=l[t].first().attr("data-id"))&&f.push(r);0===f.length&&(f=null)}this._refreshPagination(C.find(".a-GV-w-scroll")),this.columnsStale||!this.columns?this._initGrid():(this.tableFrozenData$&&this.tableFrozenData$.empty(),this.tableData$.empty(),this._clearChildrenRowCache(),this._updateScrollHandler(C.find(".a-GV-w-scroll"))),this.controlBreaks=[],this._updateStatus(),this.noData||this.resize(),d=C.find(".a-GV-hdr"),null!==p&&a&&((h=g.columns[0][a])&&(a=h.seq-1,d.find("thead").each((function(){if((u=n(this).children().eq(p).find("th[data-idx='"+a+"']")).length)return!1}))),u&&u.length||(u=d.find("thead").first().find("tr").eq(p).children().first()),u&&u.length&&(m._select(u,null,e,!1,!0),e=!1)),this.allSelected=!1,this._addPageOfRecords((function(){var t,s,a,r,h=!1;if(c&&(m._restorePaginationFocus(c),e=!1),C.find(".a-GV-header .u-selector").attr("aria-disabled",m.noData?v:"false").toggleClass("is-disabled",m.noData),m._updateAccLabel(),g.hasSize&&m._calculateColumnWidths(null,!0,!0),m.lastHoverCell=null,m.lastHoverRow=null,m.lastFocused&&n(m.lastFocused).is(":visible")||(m.lastRow$=null,m.lastFocused=m._getCellFocusable(C.children(".a-GV-bdy").find("tbody tr").first().children().first()),m.lastFocused?(m.selectAnchor=m.lastFocused,m.focusInHeader=!1):(m.lastFocused=m._getCellFocusable(d.find("thead").first().find("tr").last().children().first()),m.focusInHeader=!0),m.lastFocused&&!g.disabled&&(m._setFocusable(m.lastFocused),m._setCurrentRow(m.lastFocused))),f){if(g.selectCells)m.tableData$.find(".a-GV-row").length>f.rowIndex&&(i=f.colIndex,o=m.tableData$,m.tableFrozenData$&&(a=m.tableFrozenData$.find("tr").first().children().length,i>a?i-=a:o=m.tableFrozenData$),s=o.find(".a-GV-row").eq(f.rowIndex).children(),i>=s.length&&(i=s.length-1),m.setSelection([s.eq(i)],e),h=!0);else{for(l=[],t=0;t<f.length;t++)(r=m.model.getRecord(f[t]))&&l.push(r);l.length>0&&(h=0!==m.setSelectedRecords(l,e))}h||(m._trigger("selectionChange",{}),e&&m.focus())}else e&&m.focus()}))}},focus:function(){this.lastFocused&&this.lastFocused.focus()},gotoCell:function(e,t){var a,l,i,o,n=this.options,r=!1,d=null,h=null,c=this.element.find("[data-id='"+e+"']");if(this.gotoCellPending=null,this.tableData$){if(t&&((d=n.columns[0][t])?d.hidden&&d.canHide&&(d.hidden=!1,r=!0,this.refreshColumns(),this.gotoCellPending={record:e,column:t}):s.warn("Warning column not found "+t)),!c.length){if(!(a=this.model.getRecord(e)))return void s.warn("Warning record not found "+e);l=this.model.indexOf(a),this.gotoCellPending={record:e,column:t},n.pagination.scroll?(i=this.scrollParent$,o=Math.floor(l/this.displayPageSize)*this.displayPageHeight,i.scrollTop(o)):(this.pageOffset=Math.floor(l/this.pageSize)*this.pageSize,r=!0)}r&&this.refresh(!1),this.gotoCellPending||(t&&d&&(h=this._cellFromColumn(c,t)),h||(h=c.children().first()),this._select(h,null,!0,!1))}},getActiveCellFromColumnItem:function(e){var t,s=this,a=null;return this.activeRecordId&&(t=this.element.find("[data-id='"+this.activeRecordId+"']"),n.each(this.columnItems,(function(l,i){e===i.item.node&&(a=s._cellFromColumn(t,l))}))),a},inEditMode:function(){return this.editMode},setEditMode:function(e){var t,a,l=!1,i=this;function o(){i.columnItemsContainer$.off("change.gridedit"),i.activeRecord=null,i.activeRecordId=null}this.tableData$&&(this.options.editable?(e=!!e,this.lastFloatingPos={},t=e!==this.editMode,this.editMode=e,this.element.toggleClass("a-GV--editMode",e),(a=T(this.lastFocused)).length&&(e?this._activateCell(a):(this.lastEditModeCell=null,this._clearDeactivate(),this._deactivateCell(a),this.activeRecord&&(this._deactivateRow(o),l=!0))),t&&(e?this.columnItemsContainer$.on("change.gridedit",(function(e){var t,s,a;if(i.activeRecord)for(t=0;t<i.columns.length;t++)if((s=i.columns[t]).elementId===e.target.id){a=s.property,i.setActiveRecordValue(a);break}})):l||o(),this._trigger("modeChange",null,{editMode:e}))):e&&s.warn("Grid is not editable."))},getSelection:function(){var e,t,s=[];return this.tableData$&&(this.options.selectCells?(t=this.tableData$.find(".is-selected").parent("tr"),this.tableFrozenData$&&(e=this.tableFrozenData$.find(".is-selected").parent("tr")),e&&e.length?e.each((function(e){s.push(n(this).find(".is-selected").filter("td,th").add(t.eq(e).find(".is-selected").filter("td,th")))})):t.each((function(){s.push(n(this).find(".is-selected").filter("td,th"))}))):(t=this.tableData$.find(".is-selected").filter("tr"),this.tableFrozenData$?(e=this.tableFrozenData$.find(".is-selected").filter("tr")).each((function(e){s.push(n([this,t[e]]))})):t.each((function(){s.push(n(this))})))),s},setSelection:function(e,t,s){var a,l,i=null,o=this.lastFocused,r=this.focusInHeader,d=[];if(this.tableData$){if(this.options.selectCells)n.isArray(e)||(e=[e]),l=e[0].first()[0],d.push(e[e.length-1].last()[0]),l!==d[0]&&(this._select(n(l),null,null,!1,!1),i={type:"click",shiftKey:!0});else if(n.isArray(e))for(a=0;a<e.length;a++)(l=e[a].children("td,th")[0])&&d.push(l);else e.each((function(){(l="TR"===this.nodeName?n(this).children("td,th")[0]:n(this).closest("td,th")[0])&&d.push(l)}));this.focusInHeader=!1,this._select(n(d),i,t,!1,s),t||(this.focusInHeader=r,r&&(this._setFocusable(o),this._setCurrentRow(o)))}},selectAll:function(e,t){var s=[],a=this.options,l=this.tableFrozenData$||this.tableData$;l&&a.multiple&&a.selectAll&&!a.selectCells&&(l.children().each((function(){s.push(n(this).children()[0])})),this.setSelection(n(s),e,t))},getRecords:function(e){var t,s,a,l=[];for(t=0;t<e.length;t++)void 0!==(s=e[t].first().attr("data-id"))&&(a=this.model.getRecord(s))&&l.push(a);return l},getSelectedRange:function(){var e,t,s,a,l,i,o,n=null;if(this.options.selectCells)for(n={columns:[],recordIds:[],values:[]},e=this.getSelection(),t=0;t<e.length;t++){if(l=e[t],0===t)for(s=0;s<l.length;s++)o=this._getColumnMetadata(l.eq(s)),n.columns.push(o?o.property:null);for(i=l.first().parent().attr("data-id"),n.recordIds.push(void 0!==i?i:null),a=[],s=0;s<l.length;s++)a.push(l.eq(s).text());n.values.push(a)}return n},getSelectedRecords:function(){var e=this.options;return e.selectCells?[]:e.persistSelection?this.model.getSelectedRecords():this.getRecords(this.getSelection())},setSelectedRecords:function(e,t,s){var a,l=0,i=[],o={},r=this.tableFrozenData$||this.tableData$;if(!r)return-1;if(this.options.selectCells)return-1;for(a=0;a<e.length;a++)o[this.model.getRecordId(e[a])]=!0;return r.children().each((function(){var e=n(this),t=e.attr("data-id");o[t]&&(i.push(e),l+=1)})),this.setSelection(i,t,s),l},activateRow:function(e,t){var s=!1,a=n(this.lastEditModeCell),l=e.parent().attr("data-id");this.editMode&&l===this.activeRecordId||(this.element.one("apexbeginrecordedit",(function(){t()})),s=!0),this.editMode?(a.length&&(a.removeClass(f),this._deactivateCell(a)),e.addClass(f),this._activateCell(e)):(this.lastFocused=e[0],this.setEditMode(!0)),s||t()},activateCell:function(e){var t=n(this.lastEditModeCell);return!!this.editMode&&(e[0]===this.lastEditModeCell||(t.length&&(t.removeClass(f),this._deactivateCell(t)),e.addClass(f),this._activateCell(e)))},copyDownSelection:function(e,t){return this._setSelectionValues(1,e,t)},fillSelection:function(e,t,s){return this._setSelectionValues(0,t,s,e)},_setSelectionValues:function(e,t,s,a){var l,i,o,r=this,d=this.editMode,h=this.lastFocused,c=0,u=this.options;function p(){for(var e,t,a;;){if(c>=l.length||!i.length){(a=n(r.lastEditModeCell)).removeClass(f),d?a.length&&r._deactivateCell(a):r.setEditMode(!1),r.setSelection(l),n(h).focus(),s&&s();break}if(c>0&&(o=u.selectCells?l[c]:l[c].children()),c+=1,e=o.first().parent().attr("data-id"),r.model.allowEdit(r.model.getRecord(e))){t=o.first(),!u.selectCells&&u.rowHeader!==C&&o.length>=2&&(t=o.eq(1)),r.activateRow(t,m);break}}}function m(){var e,t;for(e=0;e<i.length;e++)t=i[e],r.activateCell(o.eq(t.index))&&t.item.setValue(t.value,t.displayValue);p()}return!((l=this.getSelection()).length<=e)&&(t||(t=[],u.selectCells?this.getSelectedRange().columns.forEach((function(e){e&&t.push(e)})):this.columns.forEach((function(e){var s=e.property;!s||e.hidden||e.virtual||e.noCopy||r.model.isIdentityField(s)||!e.elementId||e.readonly||t.push(s)}))),o=u.selectCells?l[c]:l[c].children(),this.activateRow(o.first(),(function(){i=[],o.each((function(s){var l,o,d,h=n(this),c=r._getColumnMetadata(h);c&&t.indexOf(c.property)>=0&&c.elementId&&(o={index:s,item:l=r.columnItems[c.property].item},1===e?(o.value=l.getValue(),d=l.displayValueFor(o.value),o.value!==d&&(o.displayValue=d)):o.value=a,i.push(o))})),c=e,p()})),!0)},resize:function(){var e,t,s,a,l=this.element,i=this.options,o=l.height(),d=l.width(),h=l.children(".a-GV-hdr"),c=l.children(".a-GV-bdy");null!==l[0].offsetParent&&(c.length&&!this.pendingRefresh?(a=this.tableData$.prev().height(),l.find(".a-GV-bdy "+r).css("margin-top",-(a+parseInt(this.tableHeader$.find("th").first().css("border-bottom-width"),10))),e=d,this.tableFrozenData$&&(s=this.tableFrozenData$.closest(".a-GV-w-frozen").width(),l.find(".a-GV-w-frozen").width(s).toggleClass("a-GV-w-frozen--showLabels",s>200),this.tableData$.parent().parent().find(".a-GV-loadMoreButton").css("visibility",s>200?"hidden":"visible"),e-=s),l.find(".a-GV-w-scroll,.a-GV-w-hdr").width(e),n.apex.stickyWidget&&l.find(".js-stickyWidget-toggle").stickyWidget("refresh"),i.hasSize&&(t=o-h.height()-this._footerHeight(),c.children(".a-GV-w-scroll").addBack().height(t)),this._calculateColumnWidths(null,!0,i.hasSize||this.tableData$.parent().width()>e),this._initPageSize()):this.refresh())},expandControlBreak:function(e){this._expandCollapseControlBreak(e,!0)},collapseControlBreak:function(e){this._expandCollapseControlBreak(e,!1)},getColumns:function(){return this.columns},refreshColumns:function(){this.columnsStale=!0},setColumnWidth:function(e,t){var s=this._updateColumnWidth(e,t,!0);this._trigger("columnResize",null,{header$:s[1],column:s[0],width:t})},hideColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!0,this._refreshGrid()},showColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!1,this._refreshGrid()},freezeColumn:function(e){var t,s,a=this.columns,l=this._columnName(e);for(t=0;t<a.length&&(s=a[t],t<a.length-1&&(s.frozen=!0),s.property!==l);t++);this._refreshGrid()},unfreezeColumn:function(e){var t,s,a=this._columnName(e);for(t=this.columns.length-1;t>=0&&((s=this.columns[t]).frozen=!1,s.property!==a);t--);this._refreshGrid()},moveColumn:function(e,t){var s=this._moveColumn(e,t);this._refreshGrid(),s.header$=this._columnFromIndex(t),this._trigger("columnReorder",null,s)},moveColumnGroup:function(e,t,s){var a,l,i,o,n,r,d,h=[];if(!(i=this.columnGroups[e]))throw new Error("Invalid column group level: "+e);for(o=-1,a=0;a<i.length;a++)l=i[a],a===t&&(o=l.start,n=l.end),a===s&&(r=-1===o?l.start:l.end);if(s>t)for(a=o;a<=n;a++)(d=this._moveColumn(this.columns[o],r)).newPosition=r-(n-a),d.oldPosition=a,h.push(d),this._updateColumns();else for(a=n;a>=o;a--)(d=this._moveColumn(this.columns[n],r)).newPosition=r+(a-o),d.oldPosition=a,h.push(d),this._updateColumns();for(this._refreshGrid(),a=0;a<h.length;a++)(d=h[a]).header$=this._columnFromIndex(d.newPosition),this._trigger("columnReorder",null,d)},_refreshGrid:function(){var e;(e=this.element.find(".is-active.a-GV-cell")).length&&this._deactivateCell(e),this.refreshColumns(),this.refresh()},_cellFromColumn:function(e,t){var a,l,i=this.columns,o=this.options,n=null,r=0;if(!o.columns[0][t])return s.warn("Warning column not found "+t),null;for(o.rowHeader!==C&&(r=1),a=0;a<i.length;a++)if(!(l=i[a]).hidden){if(l.property===t){n=e.children().eq(r);break}r+=1}return a>=i.length&&s.warn("Warning column is hidden "+t),n},_columnFromIndex:function(e){return this.element.find(".a-GV-header[data-idx='"+e+"']")},_columnName:function(e){var t;if(t="object"==typeof e?e.property:e,!this.options.columns[0].hasOwnProperty(t))throw new Error("Unknown column: "+t);return t},_moveColumn:function(e,t){var s,a,l,i,o=this.columns,n=this._columnName(e);for(l=-1,s=0;s<o.length;s++)if((a=o[s]).property===n){l=s;break}if(i=o[t].seq,l!==t){if(l<t)for(s=t;s>l;s--)o[s].seq=o[s-1].seq;else for(s=t;s<l;s++)o[s].seq=o[s+1].seq;return o[l].frozen=t<=this.lastFrozenColIndex,o[l].seq=i,{column:a,newPosition:t,oldPosition:l}}},_updateColumns:function(){var e,t,s,a,l,i,o,r,d,h,c,u,f,p={},m=this.options,g=m.columns[0];for(a in this.columns=[],this.columnsStale=!1,this.columnGroups=[],this.breakColumns=[],this.fieldToColumnIndex={},g)g.hasOwnProperty(a)&&((s=g[a]).property=a,s.domId=s.elementId?s.elementId+"_HDR":this.idPrefix+"_h_"+s.property,s.seq=s.seq||"0",this.columns.push(s));for(this.columns.sort((function(e,t){return e.seq-t.seq})),this.lastFrozenColIndex=-1,e=0;e<this.columns.length;e++)if(!(s=this.columns[e]).hidden){if(!s.frozen)break;this.lastFrozenColIndex=e}for(c=m.rowHeader!==C?1:0,e=0;e<this.columns.length;e++)(s=this.columns[e]).controlBreakIndex>0&&this.breakColumns.push(s),s.hidden||(this.fieldToColumnIndex[s.property]=c,c+=1);for(this.breakColumns.sort((function(e,t){return e.controlBreakIndex-t.controlBreakIndex})),i=null,r=null,d=null,u=!0,c=0,o=0,t=0,f=[],e=0;e<this.columns.length;e++)if(!(s=this.columns[e]).hidden){if(null===i&&(i=[],this.columnGroups.push(i)),(h=L(s))!==r||e===this.lastFrozenColIndex+1){if(r=h,d&&(d.span=c-o,d.end=t,d.children=f,f=[]),o=c,h){if(!(d=n.extend({},m.columnGroups[h])))throw new Error("Unknown column group name: "+h);d.heading&&(u=!1,p[h]||(d.domId=this.idPrefix+"_g_"+h)),d.property=h,i.push(d)}else d={},i.push(d);d.start=e,e<=this.lastFrozenColIndex&&(d.frozen=!0,p[h]=1)}f.push(s),c+=1,t=e,null===d&&(d={start:e},this.lastFrozenColIndex>=0&&(d.frozen=!0),i.push(d))}for(d&&(d.span=c-o,d.end=t,d.children=f),u&&(this.columnGroups=[],i=null);i;){for(l=i,i=null,r=null,d=null,u=!0,c=0,f=[],e=0;e<l.length;e++){if((h=(s=l[e]).parentGroupName||null)!==r||s.frozen!==(!!d&&d.frozen)){if(r=h,null===i&&(i=[],this.columnGroups.unshift(i),c>0&&(d={},s.frozen&&(d.frozen=!0),i.push(d))),d&&(d.span=c-o,d.children=f,f=[]),o=c,h){if(!(d=n.extend({},m.columnGroups[h])))throw new Error("Unknown column group name: "+h);d.heading&&(u=!1,p[h]||(d.domId=this.idPrefix+"_g_"+h)),d.property=h,i.push(d)}else d={},i.push(d);d.start=s.start,s.frozen&&(d.frozen=!0,p[h]=1)}f.push(s),d.end=s.end,c+=s.span}d&&(d.span=c-o,d.end=s.end,d.children=f),u&&(this.columnGroups.shift(),i=null)}},_initGrid:function(){var t,a,l,i,r,d,c,u,f,p,m,g,b,v,w,I,x,V=0,$=0,y=0,F=0,k=null,D=this,R=this.options,S=this.element;function z(){V!==y&&(t[0].scrollLeft=V=y,a[0].scrollLeft=V,g.css("left",V)),$!==F&&($=F,l[0]&&(l[0].scrollTop=$),a[0].scrollTop=$),k=null}function M(e){var t;if(w){if(t=I*(e-w),I/=1.6,t>-2&&t<2)return void(I=0);l[0].scrollTop=a[0].scrollTop=$=F=l[0].scrollTop-t}w=e,G(M)}function T(){var e=D.element.find(".is-active.a-GV-cell");D.floatingItem$.hasClass("is-expanded")?D._collapseFloatingItem(e):D._expandFloatingItem(e)}s.info("Grid render and initialize."),this._updateColumns(),this.columnItems||this._initColumnItems(this.columns),this._renderGrid(),S.find(".a-GV-hdr :tabbable").prop("tabIndex",-1),R.tooltip&&this._initTooltips(R.tooltip),R.rowHeader!==C&&R.rowHeaderCheckbox&&(this.tableFrozenHeader$.parent().addClass("a-GV-table--checkbox"),this.tableFrozenData$.parent().addClass("a-GV-table--checkbox")),t=S.find(".a-GV-w-hdr"),a=S.find(".a-GV-w-scroll"),l=S.find(".a-GV-w-frozen").last(),f=(i=S.children(".a-GV-bdy")).find("col"),p=i.find("thead").find(".a-GV-header"),x=this.tableData$.parent().width()-e.getScrollbarSize().width,this.tableFrozenData$&&(x-=this.tableFrozenData$.parent().width()),t.add(a).width(x),f.each((function(e){var t=n(this),s=D.columns[t.attr("data-idx")];s&&(s.width?s.curWidth=s.width:s.curWidth=s.defWidth=p.eq(e).width(),s.curWidth<40&&(s.curWidth=40))})),g=this.tableData$.parent().parent().find(".a-GV-loadMoreButton"),a.on("scroll.gvss",(function(){y=this.scrollLeft,F=this.scrollTop,k||(k=G(z))})),t.on("scroll.gvss",(function(){y=this.scrollLeft,k||(k=G(z))})),l.on("scroll.gvss",(function(){F=this.scrollTop,k||(k=G(z))})),R.hasSize&&l.length&&(l.on(H,(function(e){var t=e.originalEvent.deltaY||e.originalEvent.detail||-1/40*e.originalEvent.wheelDelta;void 0!==e.originalEvent.deltaMode&&1!==e.originalEvent.deltaMode||(t*=30),F=this.scrollTop+t,k||(k=G(z)),e.preventDefault()})),apex.userHasTouched()&&((b=new Hammer(l[0])).get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),b.on("panup pandown",(function(e){F=v-e.deltaY,k||(k=G(z)),I=0,e.isFinal&&(e.velocityY>=.1||e.velocityY<=-.1)&&(w=0,I=e.velocityY,G(M))})),b.on("panstart",(function(){v=l[0].scrollTop})))),d=this.element.find(".js-tabTrap"),this.tabTraps$=d,2===d.length?c=0:(3===d.length?(c=1,u=0):(c=4,u=3,d.eq(0).on("focus",(function(){D.lastEditModeCell?D.tableData$.find(":tabbable").first().focus():D._prevCellWithWrap(n(D.lastFocused)).focus()})),d.eq(1).on("focus",(function(){D.tableData$.find(":tabbable").last().focus()})),d.eq(2).on("focus",(function(){D.tableFrozenData$.find(":tabbable").first().focus()}))),d.eq(u).on("focus",(function(){n(this).hasClass("js-autoAdd")?D._autoAddRecord(D.activeRecord):(D.tableFrozenData$?D.tableFrozenData$:D.tableData$).find(":tabbable").last().focus()}))),d.eq(c).on("focus",(function(){var e,t,s=n(D.lastEditModeCell).closest("tbody"),a=s.find(":tabbable").add(D.lastEditModeCell),l=a.index(D.lastEditModeCell);l>0?a.first().focus():D.tableFrozenData$&&0===d.eq(0).prop("tabIndex")?(s=s[0]===D.tableFrozenData$[0]?D.tableData$:D.tableFrozenData$).find(":tabbable").first().focus():(e=n(":tabbable"),t=D.element.find(":tabbable").first(),l=e.index(t),e.eq(l-1).focus())})),d.eq(c+1).on("focus",(function(){var e=n(D.lastEditModeCell).closest("tbody"),t=e.find(":tabbable").add(D.lastEditModeCell),s=t.index(D.lastEditModeCell);n(this).hasClass("js-autoAdd")?D._autoAddRecord(D.activeRecord):s<t.length-1?t.last().focus():D.tableFrozenData$&&(e=e[0]===D.tableFrozenData$[0]?D.tableData$:D.tableFrozenData$).find(":tabbable").last().focus()})),d.prop("tabIndex",-1),R.reorderColumns&&this._initColumnReorder(),this.columnWidthHandle$=n(),R.resizeColumns&&this._initColumnResize(),this.columnControls$.on("click","button",(function(e){var t=n(e.target);D._sortChange(e,t.closest(".a-GV-header"),t.closest("button").hasClass("js-asc")?"asc":"desc")})),this.floatingItem$.draggable({handle:".a-GV-cellMoveHandle",containment:"body",stop:function(e,t){var s=D._getColumnMetadata(D.element.find(".is-active.a-GV-cell")).property;D.lastFloatingPos[s]={left:t.position.left,top:t.position.top}}}).on("keydown",(function(e){var t=e.which;if(e.ctrlKey&&117===t)return T(),!1;112===t&&e.altKey?D._doHelpKey():t===_.ESCAPE&&D._doEscapeKey(e)})).on("mousedown",(function(e){n(e.target).hasClass("a-GV-cellMoveHandle")&&D._clearDeactivate()})).on("focusin",(function(){D._clearDeactivate()})).on("focusout",(function(){D.lastEditModeCell&&D._beginDeactivate(n(D.lastEditModeCell))})).children(".a-GV-expandCollapse").click(T),o.TouchProxy.addTouchListeners(this.floatingItem$[0]),this._initPaginationFooter(a),!R.hasSize&&R.stickyTop&&n.apex.stickyWidget&&(m={stickToEnd:!0,toggleWidth:!0,bottom:function(){return S.offset().top+S.outerHeight()-D._footerHeight()}},n.isFunction(R.stickyTop)&&(m.top=R.stickyTop),S.find(".a-GV-hdr").css("overflow","hidden").stickyWidget(m)),this.breakColumns.length>0&&R.collapsibleControlBreaks&&S.find(".a-GV-bdy").on("click",".js-toggleBreak",(function(){r=n(this).closest("."+h),D._expandCollapseControlBreak([r],!r.hasClass("is-expanded"))}))},_initColumnReorder:function(){var e,t,s,a,l,i,r,d,h,c,u,f,p,m,g=this.element.hasClass("u-RTL"),C=this.element.find(".a-GV-hdr"),b=this;C.append(this.columnMoveMarker$),m=parseInt(b.columnHandle$.css("margin-left"),10),g&&(m=-m),b.columnHandle$.draggable({appendTo:this.element,containment:C,cursor:"move",cursorAt:g?{right:-2*m}:{left:0},axis:"x",delay:100,distance:4,helper:function(){var e=n("<div class='a-GV-header-dragHelper'></div>"),t=b.columnReorderCell$;return e.append(t.find(".a-GV-headerLabel,.a-GV-columnHandle").clone()),e.width(t.outerWidth()),e},start:function(o,m){b.columnControls$.hide(),b._trigger("cancelColumnHeader",o,{}),e=b.columnReorderCell$.parent().offset().top-b.element.offset().top,t=e+b.element[0].offsetTop,i=C.css("position"),d="absolute",r=2,h=-C.offset().left,"relative"!==i&&("fixed"===i&&(h=0,e=t=b.columnReorderCell$.parent()[0].offsetTop+C[0].offsetTop,d="fixed",m.helper.css("margin-left",b.element.offset().left+"px")),r=parseInt(C.css("z-index"),10)+1),c=-b.columnMoveMarker$.width()/2,m.helper.css({top:t+"px",position:d,"z-index":r}),f=m.helper.outerWidth(),b.columnMoveMarker$.show().css({top:e+"px",left:b.columnReorderCell$.offset().left+h+(g?b.columnReorderCell$.width():0)+"px",position:d,"z-index":r}),b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").hide(),b.columnHandle$.hide(),b.columnWidthHandle$.hide(),A((function(){b.columnReorderCancel=!0})),u=parseInt(b.columnReorderCell$.attr("data-idx"),10),b.hdrScrollParent=b.element.find(".a-GV-w-hdr")[0],p=b.hdrScrollParent.scrollLeft,s=[],l=null,(a=b._getRowForCell(b.columnReorderCell$)).children().each((function(){var e=n(this),t=!0,a=e.offset().left+h;e.parent().parent().parent().parent()[0]===b.hdrScrollParent&&(a+=p,t=!1),s.push({colIdx:parseInt(e.attr("data-idx"),10),start:a,end:a+e.outerWidth(),frozen:t})})),b.columnReordering=!0,b.columnReorderCancel=!1},drag:function(e){var t=b.hdrScrollParent.scrollLeft,a=parseInt(b.columnMoveMarker$.css("left"),10);function i(){var i,o,n,r=!1,d=e.pageX-m+h+b.hdrScrollParent.scrollLeft;for(i=0;i<s.length;i++)if(d>=(o=s[i]).start&&d<o.end){i!==l&&(l=i,n=g?(o.colIdx<u?o.end:o.start)+c:(o.colIdx<u?o.start:o.end)+c,o.frozen||(n-=b.hdrScrollParent.scrollLeft),a=n,t=b.hdrScrollParent.scrollLeft,b.columnMoveMarker$.css("left",n+"px"),r=!0);break}r||t===b.hdrScrollParent.scrollLeft||(n=a-(b.hdrScrollParent.scrollLeft-t),b.columnMoveMarker$.css("left",n+"px"))}b.columnReorderCancel?e.preventDefault():(i(),b._headerScrollCheck(e.pageX-m,f)?b.scrollTimerId||b._headerScrollStart(e.pageX-m,f,i):b.scrollTimerId&&b._headerScrollStop())},stop:function(){var e=null;null!==l&&(e=s[l].colIdx),isNaN(e)&&l+1<s.length&&(e=s[l+1].colIdx),isNaN(e)||(b.columnReordering=!1,b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").show(),e===u&&(b.columnHandle$.show(),b.columnWidthHandle$.show(),b.columnControls$.show()),b.columnMoveMarker$.hide(),b.lastHoverCell=null,P(),b.scrollTimerId&&b._headerScrollStop(),b.columnReorderCancel||null===e||e===u||(b.columnReorderCell$.hasClass("a-GV-headerGroup")?b.moveColumnGroup(R(a),u,e):b.moveColumn(b.columns[u],e),b.focus()))}}),o.TouchProxy.addTouchListeners(b.columnHandle$[0])},_initColumnResize:function(){var e,t,s,a=this,l=this.element.hasClass("u-RTL")?-1:1,i=this.element.find(".a-GV-hdr"),r=i.find("tr").last();this.columnWidthHandle$=n("<div class='a-GV-columnWidthHandle'></div>").appendTo(i).css("top",r[0].offsetTop).height(r.height()),this.columnWidthHandle$.draggable({axis:"x",containment:i,start:function(l,i){a.columnWidthDragging=!0,a.columnWidthCancel=!1,a.columnWidthStartPos=i.position.left,a.columnWidthStartWidth=a.columnWidthCell$.first().outerWidth(),e=i.helper.outerWidth(),a.hdrScrollParent=a.element.find(".a-GV-w-hdr")[0],s=a.columnWidthCell$.parent().parent().parent().parent()[0]!==a.hdrScrollParent,t=a.hdrScrollParent.scrollLeft,A((function(){a.columnWidthCancel=!0}))},drag:function(i,o){function n(e){var i,n,r=a.columnWidthStartWidth+l*(o.position.left-a.columnWidthStartPos);i=a.hdrScrollParent.scrollWidth,s||(r+=a.hdrScrollParent.scrollLeft-t),r>40&&(a.columnWidthCell$.hasClass("a-GV-selHeader")?(a.rowHeaderWidth=r,a._calculateColumnWidths()):a._updateColumnWidth(a._getColumnMetadata(a.columnWidthCell$.first()),r)),(n=a.hdrScrollParent.scrollWidth-i)<0&&!e&&a.hdrScrollParent.scrollLeft!==t&&(a.hdrScrollParent.scrollLeft+=n,t+=n)}a.columnWidthCancel?i.preventDefault():(n(),a._headerScrollCheck(o.offset.left,e)?a.scrollTimerId||a._headerScrollStart(o.offset.left,e,(function(){n(!0)})):a.scrollTimerId&&a._headerScrollStop())},stop:function(e,i){var o=a.columnWidthStartWidth+l*(i.position.left-a.columnWidthStartPos);s||(o+=a.hdrScrollParent.scrollLeft-t),a.columnWidthDragging=!1,P(),a.scrollTimerId&&a._headerScrollStop(),a.columnWidthCancel&&(o=a.columnWidthStartWidth),o<40&&(o=40),a.columnWidthCell$.hasClass("a-GV-selHeader")?(a.rowHeaderWidth=o,a._calculateColumnWidths(null,!0)):a.setColumnWidth(a._getColumnMetadata(a.columnWidthCell$.first()),o)}}),o.TouchProxy.addTouchListeners(this.columnWidthHandle$[0])},_updateColumnWidth:function(e,t,s){var a,l,i,o=this._columnName(e);return(a=this.options.columns[0][o]).width=t,a.curWidth=t,i=this.columns.indexOf(a),l=this._columnFromIndex(i),this._calculateColumnWidths(l,s),[a,l]},_calculateColumnWidths:function(t,s,a){var l,i,o,r,d,h,c,u,f,p,m,g,C=this.options.hasSize,b=this.element,v=this;function _(e){var t,s;for(t=e+1;t<v.columns.length;t++)if(!(s=v.columns[t]).hidden&&!s.noStretch&&t!==p)return!1;return!0}function w(e,t){var s,a=t.parent().find("col"),l=e.parent().find("col");return s=0,l.each((function(e){var t,l=n(this),i=l.attr("data-idx");t=i?v.columns[i].curWidth:v.rowHeaderWidth,l[0].width=t,a[e].width=t,s+=t})),t.parent().width(s),e.parent().width(s),s}if(a)for(l=0;l<this.columns.length;l++)(i=this.columns[l]).curWidth=i.width||i.defWidth,i.curWidth<40&&(i.curWidth=40);if(s&&this.tableFrozenHeader$&&this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each((function(){n(this).find(".a-GV-header").first().css("height","")})),t&&(h=t.parent().parent()[0],p=parseInt(t.attr("data-idx"),10)),!this.tableFrozenData$||h&&h!==this.tableFrozenHeader$[0]||(w(this.tableFrozenData$,this.tableFrozenHeader$),r=this.tableFrozenData$.parent().outerWidth(),b.find(".a-GV-w-frozen").width(r),o=b.width()-r,b.find(".a-GV-w-scroll,.a-GV-w-hdr").width(o)),o=h&&h!==this.tableHeader$[0]?this.tableData$.parent().width():w(this.tableData$,this.tableHeader$),s){if(d=b.find(".a-GV-w-scroll")[0].clientWidth,C&&0===this.tableData$.children().length&&(d-=e.getScrollbarSize().width),o<d){if((d=d-o-1)>10)for(f=d,l=0;l<this.columns.length;l++)(i=this.columns[l]).hidden||i.frozen||i.noStretch||l===p||(_(l)?i.curWidth+=f:(u=Math.floor(d*(i.curWidth/o)),i.curWidth+=u,f-=u));else for(l=this.columns.length-1;l>0;l--)if(!((i=this.columns[l]).hidden||i.frozen||i.noStretch||l===p)){i.curWidth=i.curWidth+d;break}w(this.tableData$,this.tableHeader$)}this.tableFrozenHeader$&&(g=this.tableFrozenHeader$.find(".a-GV-header").outerHeight())!==(m=this.tableHeader$.find(".a-GV-header").outerHeight())&&(m=Math.max(g,m),this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each((function(){n(this).find(".a-GV-header").first().css("height",m+"px")})))}C&&(c=b.children(".a-GV-bdy"),this._adjustSizeForScrollBars(c.height(),c.find(".a-GV-w-scroll").width()))},_renderGrid:function(){var t,s,a,l,i=this,o=this.element,r=this.options,d=r.hasSize||r.stickyTop,h=e.htmlBuilder(),c="<table role='presentation' class='a-GV-table'>",u="<thead role='rowgroup'>",f="<span class='js-tabTrap u-vh is-focusable' aria-hidden='true' tabindex='-1'></span>";function p(e,t){var s,a;for(t&&r.rowHeader!==C&&e.markup("<col").optionalAttr("width",i.rowHeaderWidth).markup("/>"),s=0;s<i.columns.length;s++)((a=i.columns[s]).frozen||!1)!==t||a.hidden||e.markup("<col").optionalAttr("width",a.width).attr("data-idx",s).markup("/>")}function m(e,t,s){var a,o,n,d,h,c,u,f,p,m=i.columns,g=i.lastFrozenColIndex+1,_=m.length;for(o=0;o<i.columnGroups.length;o++){for(c=i.columnGroups[o],e.markup("<tr class='a-GV-row' role='row'>"),a=0;a<c.length;a++)for(t&&r.rowHeader!==C&&(e.markup("<th role='columnheader' class='a-GV-headerGroup a-GV-selHeader'"),s&&e.markup(" style='visibility: hidden;'"),e.markup(">")),a=0;a<c.length;a++)((n=c[a]).frozen||!1)===t&&(d="a-GV-headerGroup",d+=x(n.headingAlignment||"center",!0),p=s?null:n.domId,e.markup("<th role='columnheader' ").attr("class",d).attr("colspan",n.span).attr("data-idx",a),s&&e.markup(" style='visibility: hidden;'"),e.markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",p).markup(">"+(n.heading||"")).markup("</span></th>"));e.markup("</tr>")}for(e.markup("<tr class='a-GV-row' role='row'>"),t&&(r.rowHeader!==C&&(f=null,s&&(f="visibility: hidden;"),e.markup("<th role='columnheader' class='a-GV-header a-GV-selHeader'").optionalAttr("style",f).markup("><span class='u-vh a-GV-headerLabel'").optionalAttr("id",s?null:i.idPrefix+"_shh").markup(">").markup(F("ROW_HEADER")).markup("</span>"),r.rowHeaderCheckbox&&r.multiple&&r.selectAll&&e.markup("<span class='u-selector' role='checkbox' aria-checked='false'").attr("title",F("SELECT_ALL")).markup("></span>"),"sequence"===r.rowHeader?e.markup("<span class='a-GV-rownum' aria-hidden='true'></span>"):r.rowHeader===b&&e.markup("<span class='a-GV-rowLabel'></span>"),e.markup("</th>")),g=0,_=i.lastFrozenColIndex+1),a=g;a<_;a++)(n=m[a]).hidden||(d="a-GV-header",d+=x(n.headingAlignment||"center",!0),n.isRequired&&(d+=" is-required"),n.elementId&&!n.readonly||(d+=" is-readonly"),n.headingCssClasses&&(d+=" "+n.headingCssClasses),u=null,1===n.sortIndex&&("asc"===n.sortDirection?u="ascending":"desc"===n.sortDirection&&(u="descending")),f=null,s?(f="visibility: hidden;",p=null):p=n.domId,e.markup("<th role='columnheader' ").attr("class",d).attr("data-idx",a).optionalAttr("style",f).optionalAttr("aria-sort",u).optionalAttr("aria-haspopup",r.activateColumnHeader?v:null).markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",p).markup(">").markup(n.heading).markup("</span>"),n.sortDirection&&(h=k("asc"===n.sortDirection?"SORTED_ASCENDING":"SORTED_DESCENDING",l>1?n.sortIndex:""),e.markup("<span class='a-GV-header-sort'><span aria-hidden='true'").attr("class","a-Icon "+("asc"===n.sortDirection?"icon-irr-sort-asc":"icon-irr-sort-desc")).attr("title",h).markup("></span><span class='u-vh'>").content(" "+h).markup("</span>"),l>1&&e.markup("<span aria-hidden='true'>").content(n.sortIndex).markup("</span>"),e.markup("</span>")),e.markup("</th>"));e.markup("</tr>")}for(a=this.lastFrozenColIndex>=0||r.rowHeader!==C,l=0,t=0;t<this.columns.length;t++)this.columns[t].sortDirection&&(l+=1);h.markup("<div class='a-GV-hdr"+(d?" a-GV-hdr--fixed":"")+"'>"),a&&(h.markup("<div class='a-GV-w-frozen'>"+c),p(h,!0),h.markup(u),m(h,!0,!1),h.markup("</thead></table></div>")),h.markup("<div class='a-GV-w-hdr'>"+c),p(h,!1),h.markup(u),m(h,!1,!1),h.markup("</thead></table></div></div><div class='a-GV-bdy'>"),this._renderAltDataMessages(h,this.idPrefix),h.markup("<div class='u-vh'").attr("id",this.accContextId).markup("></div>"),a&&(h.markup(f+"<div class='a-GV-w-frozen'>"+c),p(h,!0),h.markup(u),m(h,!0,!0),h.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(h),h.markup("</div>"+f+f)),h.markup("<div class='a-GV-w-scroll' tabindex='-1'>"+c),p(h,!1),h.markup(u),m(h,!1,!0),h.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(h),h.markup("</div>"),(a||r.autoAddRecord&&this.model.allowAdd())&&h.markup(f),h.markup("</div>"),r.editable&&h.markup("<div class='a-GV-floatingItem' tabindex='-1' style='display: none;'>").markup("<div class='a-GV-cellMoveHandle'></div>").markup("<button type='button' class='a-GV-expandCollapse' tabindex='-1'><span aria-hidden='true' class='a-Icon'></span></button>"+f+"<div class='a-GV-floatingItemContent'></div>"+f+"</div>"),this._renderFooter(h,this.idPrefix),r.columnSort&&(h.markup("<div class='a-GV-columnControls' style='display:none'>"),this._renderButton(h,"a-Button js-asc","icon-up-chevron",F("SORT_ASCENDING")),this._renderButton(h,"a-Button js-desc","icon-down-chevron",F("SORT_DESCENDING")),h.markup("</div>")),r.reorderColumns&&h.markup("<div class='a-GV-columnHandle' style='display:none'></div>").markup("<div class='a-GV-colMoveMarker' style='display:none'>").markup("<span class='a-GV-colMoveMarker-x'></span></div>"),this.floatingItem$&&this.floatingItem$.remove(),o.html(h.toString()),this._updateAccLabel(),this.pageKey=null,s=o.find(".a-GV-table>tbody,.a-GV-table>thead"),a?(this.tableFrozenHeader$=s.eq(0),this.frozenColumnCount=this.tableFrozenHeader$.children().last().children().length,this.tableHeader$=s.eq(1),this.tableFrozenData$=s.eq(3),this.tableData$=s.eq(5)):(this.tableFrozenHeader$=null,this.frozenColumnCount=0,this.tableFrozenData$=null,this.tableHeader$=s.eq(0),this.tableData$=s.eq(2)),this._clearChildrenRowCache(),this.accContext$=n("#"+this.accContextId),this.columnControls$=o.find(".a-GV-columnControls"),this.columnControls$.find("button").attr("tabindex",-1),this.columnHandle$=o.find(".a-GV-columnHandle"),this.columnMoveMarker$=o.find(".a-GV-colMoveMarker"),this.floatingItem$=o.find(".a-GV-floatingItem")},_updateAccLabel:function(){var e=this.origLabelBy;this.noData?e+=" "+this.idPrefix+"_msg":this.options.footer&&(e+=" "+this.idPrefix+"_pageRange "+this.idPrefix+"_status"),this.element.attr("aria-labelledby",e)},_calcSpanAllColumns:function(e){var t,s,a,l;for(s=0,e?(a=0,l=this.lastFrozenColIndex+1,this.options.rowHeader!==C&&(s+=1)):(a=this.lastFrozenColIndex+1,l=this.columns.length),t=a;t<l;t++)this.columns[t].hidden||(s+=1);return s},_getHeaderHeight:function(){return this.element.find(".a-GV-hdr").outerHeight()},_getStickyTop:function(){return n.isFunction(this.options.stickyTop)?this.options.stickyTop():0},_selectedCount:function(){var e=0,t=this.options;if(this.tableData$)return t.selectCells?(e=this.tableData$.find(".is-selected").filter("td,th").length,this.tableFrozenData$&&(e+=this.tableFrozenData$.find(".is-selected").filter("td,th").length)):e=t.persistSelection?this.model.getSelectedCount():this.tableData$.find("tr.is-selected").length,e},_selectedStatusMessage:function(){var e=this.options;return a.getMessage(e.selectCells?"APEX.GV.SELECTION_CELL_COUNT":e.selectionStatusMessageKey)},_deletedCount:function(){return this.tableData$.find("tr.is-deleted").length},_hasControlBreaks:function(){return this.breakColumns.length>0},_getRecordHeight:function(){var e,t;return(e=this.tableData$.find("tr").filter(":visible").first()).length?t=e.outerHeight():(e=n("<tr class='a-GV-row'><td class='a-GV-cell'></td></tr>"),t=(e=this.tableData$.append(e)).outerHeight(),this.tableData$.empty()),t},_getDataRenderContext:function(){return{hasFrozenColumns:this.lastFrozenColIndex>=0||this.options.rowHeader!==C,dataOut:e.htmlBuilder(),frozenOut:e.htmlBuilder()}},_getDataContainer:function(){return this.tableFrozenData$?n([this.tableFrozenData$[0],this.tableData$[0]]):this.tableData$},_insertFiller:function(e,t){var s,a;return e.hasFrozenColumns&&(a=n(e.frozenOut.toString()),t?t.first().before(a):this.tableFrozenData$.html(a)),s=n(e.dataOut.toString()),t?t.last().before(s):this.tableData$.html(s),e.hasFrozenColumns&&(s=n([a[0],s[0]])),this._clearChildrenRowCache(),s},_insertData:function(e,t,s,a,l){var i,o,r,d,h,c=this;e.hasFrozenColumns&&(r=S(e.frozenOut)),o=S(e.dataOut),a?(e.hasFrozenColumns&&a.first()[l](r),a.last()[l](o)):(e.hasFrozenColumns&&this.tableFrozenData$.append(r),this.tableData$.append(o)),this._clearChildrenRowCache(),this.allSelected&&this.options.pagination.scroll&&(d=o.map((function(e,t){return n(t).children()[0]})),h=this.focusInHeader,this.focusInHeader=!1,this._select(d,"add",null,!1),this.focusInHeader=h),this.options.hasSize&&(i=this.element.children(".a-GV-bdy"),this._adjustSizeForScrollBars(i.height(),i.find(".a-GV-w-scroll").width())),this.gotoCellPending&&setTimeout((function(){c.gotoCell(c.gotoCellPending.record,c.gotoCellPending.column)}),0),this._trigger("pageChange",null,{offset:t,count:s})},_controlBreakLabel:function(t){var s,a,l,i,o=this.options,n="",r=[];for(s=0;s<this.breakColumns.length;s++)a=this.breakColumns[s],s>0&&(n+=", "),l=this.model.getValue(t,a.property),r[s]=l,null===l&&(l=""),"object"==typeof l&&l.hasOwnProperty("d")?l=l.d:(i=this.columnItems[a.property])&&(l=i.item.displayValueFor(l)),""===l&&o.showNullAs&&(l=o.showNullAs),!1!==a.escape&&(l=e.escapeHTML(l)),(a.label||a.heading)&&(n+="<span class='a-GV-breakLabel'>"+(a.label?e.escapeHTML(a.label):a.heading)+":</span> "),n+="<span class='a-GV-breakValue'> "+l+"</span>";return{label:n,values:r}},_renderBreakRecord:function(e,t,s,a){var l=s.label;e.hasFrozenColumns&&(this._renderBreakRow(e.frozenOut,!0,t,l,a),t=!1),this._renderBreakRow(e.dataOut,!1,t,l,a),this.controlBreakCollapsed=!1,this.controlBreaks.push({offset:a+1,label:l,values:s.values}),this.controlBreaks.sort(D)},_renderFillerRecord:function(e,t){e.hasFrozenColumns&&e.frozenOut.markup("<tr class='"+t+"'><td ").attr("colspan",this._calcSpanAllColumns(!0)).markup("></td></tr>"),e.dataOut.markup("<tr class='"+t+"'><td ").attr("colspan",this._calcSpanAllColumns(!1)).markup("></td></tr>")},_renderRecord:function(e,t,s,a,l){e.hasFrozenColumns&&this._renderRow(e.frozenOut,t,s,a,l,!0),this._renderRow(e.dataOut,t,s,a,l,!1)},_insertRecord:function(t,s,a,l,i){var o,r=this,d=this.lastFrozenColIndex>=0||this.options.rowHeader!==C,c=e.htmlBuilder(),u=[];function f(e){var o;r._renderRow(c,s,null,a,l,e),o=S(c),u.push(o[0]),"after"===i&&t?(e?t.first():t.last()).after(o):(e?r.tableFrozenData$:r.tableData$).prepend(o)}return!t&&r._hasControlBreaks()&&((o=n(this.lastFocused).closest("."+h)).length||(o=this.tableData$.find("."+h).first()),1===o.length&&this.tableFrozenHeader$&&(t=o.add(this._getOtherTable(o)[this._rowIndex(o)])),t&&this._expandCollapseControlBreak([t],!0),i="after"),d&&(f(!0),c.clear()),f(!1),this._clearChildrenRowCache(),n(u)},_afterInsert:function(e,t){var s,a,l=!!this.element.find("."+f).length||n(document.activeElement).hasClass("js-autoAdd"),i=e[0].find(".a-GV-cell").first();for(s=0;s<this.columns.length;s++)if(!(a=this.columns[s]).hidden&&!a.readonly&&this.columnItems[a.property]){i=E(e[0],this.fieldToColumnIndex[a.property]);break}if(this._hasControlBreaks()&&!t&&e[0]){let t,l,i,o=e[0].prev().attr("data-rownum");if(null!=o)for(t=this._getControlBreak(parseInt(o,10)),l=this.model.getRecord(e[0].attr("data-id")),i=t.values,s=0;s<this.breakColumns.length;s++)(a=this.breakColumns[s]).readonly||this.model.setValue(l,a.property,i[s])}setTimeout(()=>{this._select(i,null,l,!1,!1),l&&this.options.editable&&!this.editMode&&this.setEditMode(!0)},0)},_updateRecordField:function(t,s,a,l){var i,o,n,r,d=this.fieldToColumnIndex[a],h=e.htmlBuilder();void 0!==d&&(i=E(t,d),this.editMode&&s===this.activeRecord&&!this.ignoreItemChange&&(o=this.columnItems[a])&&this._setColumnItemValue(o.item,s,a),i.hasClass(p)||(n=this.options.columns[0][a],r=null,l.fields&&(r=l.fields[n.property]),h=e.htmlBuilder(),this._renderFieldDataValue(h,n,s,l,r),i.html(h.toString())))},_updateRecordState:function(e,t,s,a){var l,i,o,n,r,d=this.options,h=!this.tooltipOptions;if(n=$(a,d,e.hasClass(u),this.model,s),e.attr("class",n),h&&(a.message?e.first().find(".a-GV-selHeader").attr("title",a.message):e.first().find(".a-GV-selHeader").removeAttr("title")),a.fields)for(l in a.fields)if(a.fields.hasOwnProperty(l)){if(i=a.fields[l],void 0===(r=this.fieldToColumnIndex[l]))continue;o=E(e,r),n=y(d.columns[0][l],a,i,d,o,this.model,s),o.attr("class",n),h&&(i.message&&!a.deleted?o.attr("title",i.message):o.removeAttr("title"))}},_removeRecord:function(e){e.remove()},_identityChanged:function(e,t){this._elementsFromRecordIds([e])[0].attr("data-id",t),this.activeRecordId===e&&(this.activeRecordId=t)},_replaceRecord:function(t,s,a,l,i){var o,r,d,h,c,p,m,g,b=null,v=null,_=[],w=t.first().children().first().find(".a-GV-rownum").text()||null,G=this.lastFrozenColIndex>=0||this.options.rowHeader!==C,H=e.htmlBuilder();w&&(w=parseInt(w,10)-1),this.activeRecordId===a&&(this.activeRecord=this.activeRecordId=null),r=t.hasClass(u),(d=t.find(this.lastFocused).length)&&(c=z(g=this.lastFocused).hasClass(f)),(h=t.find(this.lastEditModeCell).length&&n(this.lastEditModeCell).hasClass(f))&&(g=this.lastEditModeCell),g&&(b=0,v=R(M(g))),G&&(g&&t.last().find(g).length&&(b=1),this._renderRow(H,s,w,l,i,!0),o=S(H),_.push(o[0]),t.first().replaceWith(o),H.clear()),this._renderRow(H,s,w,l,i,!1),o=S(H),_.push(o[0]),t.last().replaceWith(o),this._clearChildrenRowCache(),o=n(_),r&&o.add(o.find(".a-GV-selHeader .u-selector")).addClass(u).attr("aria-selected",!0),h?this._activateCell(E(o.eq(b),v)):d&&(m=E(o.eq(b),v),p=this._getCellFocusable(m),this._setFocusable(p),this._setCurrentRow(m[0]),c&&this._setFocus(p))},_removeFocus:function(e){var t,s,a;((t=n(this.lastFocused).closest("tr"))[0]===e[0]||e.length>1&&t[0]===e[1])&&(s=T(this.lastFocused),(a=this._getNextCellDown(s,1))||(a=this._getPrevCellUp(s,1)),a&&this._select(a,null,!0,!1))},_elementsFromRecordIds:function(e){var t,s,a=!0,l=[],i={};for(t=0;t<e.length;t++)i[e[t]]=t,l[t]=null;return this.tableFrozenData$||(a=!1),a&&(s=this.tableFrozenData$.children()),this.tableData$.children().each((function(e){var t=n(this),o=t.attr("data-id");void 0!==i[o]&&(l[i[o]]=a?n([s[e],this]):t)})),l},_renderBreakRow:function(e,t,s,a,l){var i;i=this._calcSpanAllColumns(t),e.markup("<tr role='row' class='"+h+" is-expanded'").optionalAttr("data-rownum",null!=l?l+1:null).markup("><th role='rowheader' class='a-GV-controlBreakHeader'").attr("colspan",i).markup(">"),s&&this.options.collapsibleControlBreaks&&this._renderButton(e,"a-Button js-toggleBreak","icon-down-arrow",F("BREAK_COLLAPSE")),e.markup("<span class='a-GV-controlBreakLabel'>").markup(a).markup("</span></th></tr>")},_getControlBreak:function(e){var t,s=null;return this.breakColumns.length>0&&(t=function(e,t,s){for(var a,l,i=0,o=e.length-1;i<=o;)if((l=s(t,e[a=o+i>>1]))>0)i=a+1;else{if(!(l<0))return a;o=a-1}return i}(this.controlBreaks,{offset:e},D),(s=this.controlBreaks[t])&&s.offset===e||(s=this.controlBreaks[t-1])),s},_renderRow:function(e,t,s,a,l,i){var o,n,r,d,c,f,p,m,g=null,_=null,w=null,G=this.options,H=this.columns,I=this.lastFrozenColIndex+1,x=H.length,V=!this.tooltipOptions;for(r=$(l,G,null,this.model,t),l.agg?g=l.grandTotal?G.aggregateLabels[l.agg].overallLabel:G.aggregateLabels[l.agg].label:!l.deleted&&l.message&&V&&(_=l.message),f=void 0!==l.serverOffset?l.serverOffset+1:"",null===this.controlBreakCollapsed&&this._hasControlBreaks()&&(this.controlBreakCollapsed=!1,(m=this._getControlBreak(f))&&(this.tableData$.find("."+h+"[data-rownum='"+m.offset+"']").hasClass("is-expanded")||this._controlBreakLabel(t).label!==m.label||(this.controlBreakCollapsed=!0))),e.markup("<tr role='row'").attr("data-id",a).optionalAttr("data-rownum",f).attr("class",r).optionalAttr("title",g).optionalAttr("aria-selected",l.sel?v:null).optionalAttr("style",this.controlBreakCollapsed&&!l.agg?"display:none;":null).markup(">"),i&&G.rowHeader!==C&&(p=l.agg||G.rowHeader===b,e.markup("<th role='rowheader'").attr("class","a-GV-cell a-GV-selHeader"+(p?" a-GV-rowHeader":"")).optionalAttr("title",_).markup(">"),l.agg||(G.rowHeaderCheckbox&&(d=G.multiple?"u-selector":"u-selector u-selector--single",l.sel&&(d+=" "+u),e.markup("<span class='"+d+"'").attr("title",F("SELECT_ROW")).markup("></span>")),"sequence"===G.rowHeader&&e.markup("<span class='a-GV-rownum' aria-hidden='true'>").content(f).markup("</span>")),p&&(e.markup("<span class='a-GV-rowLabel'>"),l.agg?e.content(G.aggregateLabels[l.agg][l.grandTotal?"overallLabel":"label"]):G.rowHeaderLabelColumn&&e.markup(this.model.getValue(t,G.rowHeaderLabelColumn)),e.markup("</span>")),e.markup("</th>")),i&&(I=0,x=this.lastFrozenColIndex+1),o=I;o<x;o++)n=H[o],c=null,l.fields&&(c=l.fields[n.property]),n.hidden||(r=y(n,l,c,G,null,this.model,t),w=null,V&&(c&&c.message?w=c.message:l.agg&&(w=G.aggregateTooltips[l.agg+"|"+n.property])),e.markup("<td role='gridcell' tabindex='-1'").attr("class",r).optionalAttr("title",w).markup(">"),this._renderFieldDataValue(e,n,t,l,c),e.markup("</td>"));e.markup("</tr>")},_getColumnMetadata:function(e){var t,s;if(e.hasClass("a-GV-cell"))t=R(e),s=(e.closest(".a-GV-w-frozen").length?this.tableFrozenHeader$:this.tableHeader$).children().last().children().eq(t);else{if(!e.hasClass("a-GV-header"))return null;s=e}return t=parseInt(s.attr("data-idx"),10),isNaN(t)?null:this.columns[t]},_activateColumnHeader:function(e,t){var s=this._getColumnMetadata(t);s.noHeaderActivate||this._trigger("activateColumnHeader",e,{header$:t,column:s})},_activateRow:function(e){var t,s,a,l,i,o,n,r=e.parent(),d=r.attr("data-id"),h=this;for(l=this.model.getRecord(d),i=this.model.getRecordId(l),n=this.model.allowEdit(l),o=this.model.getRecordMetadata(i),r.addClass(p),this._beginSetColumnItems(),t=0;t<this.columns.length;t++)a=this.columns[t].property,(s=this.columnItems[a])&&this._setColumnItemValue(s.item,l,a,n?o:null);this.activeRecord=l,this.activeRecordId=i,this._endSetColumnItems(),setTimeout((function(){h._triggerBeginEditing(h.activeRecord,h.activeRecordId)}),0)},_deactivateRow:function(e){var t,s,a,l,i,o,n=this.element.find(".a-GV-row.is-active");if(this.activeLockCount>0)this.activeUnlockCallback=e;else{if(n.removeClass(p),(l=this.model.getRecordMetadata(this.activeRecordId))&&!l.deleted&&this.model.allowEdit(this.activeRecord))for(t=0;t<this.columns.length;t++)a=this.columns[t].property,(s=this.columnItems[a])&&((o=s.item.isDisabled())?this.model.setValidity("valid",this.activeRecordId,a):s.item.getValidity().valid||this.model.setValidity("error",this.activeRecordId,a,s.item.getValidationMessage()),((i=l.fields?l.fields[a]:null)&&i.hasOwnProperty("disabled")||o)&&(i||(l.fields||(l.fields={}),i={},l.fields[a]=i),i.disabled=o));this._triggerEndEditing(this.activeRecord,this.activeRecordId),this.activeRecord=null,this.activeRecordId=null,e()}},_beginDeactivate:function(e,t){var s=this;this.deactivateDelayTimer||(this.deactivateDelayTimer=setTimeout((function(){s.lastEditModeCell=null,s._deactivateCell(e),t&&(s.dontFocusEditableItem=!0,e.focus()),s.deactivateDelayTimer=null}),10))},_clearDeactivate:function(){this.deactivateDelayTimer&&(clearTimeout(this.deactivateDelayTimer),this.deactivateDelayTimer=null)},_setTabTraps:function(e){var t,s,a,l,i,o=this.options.autoAddRecord&&this.model.allowAdd(),n=this.tabTraps$;e.attr("tabindex",-1),t=this._nextCellWithWrap(e).attr("tabindex",0),s=this._prevCellWithWrap(e).attr("tabindex",0),l=null,this.tableFrozenData$?(l=3,a=5,n.eq(0).prop("tabIndex",s.length?0:-1),i=1===e.parent().children().length,n.eq(1).prop("tabIndex",i?0:-1),n.eq(2).prop("tabIndex",i?0:-1)):o?(l=0,a=2):a=1,null!==l&&(o&&this.onLastPage&&0===t.length?n.eq(l).prop("tabIndex",0).addClass("js-autoAdd"):n.eq(l).prop("tabIndex",t.length?0:-1).removeClass("js-autoAdd")),o&&this.onLastPage&&0===t.length?n.eq(a).prop("tabIndex",0).toggleClass("js-last",!t.length).addClass("js-autoAdd"):n.eq(a).prop("tabIndex",t.length?0:-1).toggleClass("js-last",!t.length).removeClass("js-autoAdd")},_clearTabTraps:function(){this.element.find(".a-GV-cell[tabindex='0'],.a-GV-controlBreakHeader[tabindex='0']").attr("tabindex",-1),this.tabTraps$.prop("tabIndex",-1)},_activateCell:function(e,t){var s,a,l=this,i=!1,o=null,r=null,d=e.hasClass(c);function h(e){(t=t||l._getCellFocusable(e))!==e[0]&&t.focus()}function f(){(s=l._getColumnMetadata(e))&&(o=l.columnItems[s.property]),o&&l.model.allowEdit(l.activeRecord)&&!s.readonly&&!e.hasClass("is-readonly")?(e.addClass(p),(a=o.item.getPopupSelector())&&n(document.body).on("focusin.gridpopup",(function(e){n(e.target).closest(a).length&&l._clearDeactivate()})).on("focusout.gridpopup",(function(e){var t;n(e.target).closest(a).length&&(t=n(l.lastEditModeCell),l._beginDeactivate(t,!0))})),r=o.element$.height(),o.element$=o.element$.detach(),r>e.height()?(e.empty(),l.floatingItem$.children(".a-GV-floatingItemContent").append(o.element$),l._expandFloatingItem(e)):e.empty().append(o.element$),l._activateColumnItem(o,s.domId),l.dontFocusEditableItem||o.item.isDisabled()||o.item.setFocus(),l.dontFocusEditableItem=!1,i=!0,l._savedActivationtarget&&(l._interactWithCellItem(n.Event("activate",{target:l._savedActivationtarget}),e,s,o.item),l._savedActivationtarget=null)):h(e)}if(this.lastEditModeCell=e[0],e.parent().hasClass(u)?this.lastRow$&&this.lastRow$.index(e)>=0||this._setCurrentRow(e[0]):this._select(e,null,!1,!1),this._setFocusable(e[0]),this._setTabTraps(e),!this.activeRecord||this.activeRecordId!==e.parent().attr("data-id")){if(this.activeRecord)return void this._deactivateRow((function(){d?h(e):(l._activateRow(e),f())}));d?h(e):this._activateRow(e)}return d?h(e):f(),i},_checkInteractWithCellItem:function(e,t,s){var a,l=!1,i=this._getColumnMetadata(s),o=i&&this.columnItems[i.property];return o&&(o=o.item)&&o.getInteractionSelector&&(a=o.getInteractionSelector(),t.closest(a).length&&(e?(this._interactWithCellItem(e,s,i,o),l=!0):this._savedActivationtarget=t[0])),l},_interactWithCellItem:function(e,t,s,a){var l=t.parent().attr("data-id"),i=this.model.getRecord(l);"activate"===e.type?a.onInteraction(e):!this.model.allowEdit(i)||s.readonly||t.hasClass("is-readonly")||a.onInteraction(e,this.model,i,s.property)},_expandFloatingItem:function(e){var t,s,a,l=this.element.hasClass("u-RTL")?"right top":"left top",i=e.outerWidth(),o=this._getColumnMetadata(e).property;this.floatingItem$.css("position","").css("min-width",i+"px").appendTo("body").show().addClass("is-expanded").draggable("enable").attr("data-owning-region",this.element[0].id).find(".a-GV-expandCollapse span").removeClass("icon-ig-expand").addClass("icon-ig-restore"),this.floatingItem$.children(".a-GV-floatingItemContent").show().css({width:"",height:""}),(a=this.lastFloatingPos[o])?this.floatingItem$.css({left:a.left,top:a.top}):this.floatingItem$.position({my:l,at:l,of:e,collision:"fit fit"}),this.floatingItem$.find(".js-tabTrap").not(".js-last").attr("tabindex",0),(t=this._getColumnMetadata(e))&&((s=this.columnItems[t.property]).item.isDisabled()||s.item.setFocus())},_collapseFloatingItem:function(e){var t=e.innerWidth(),s=e.innerHeight();this.floatingItem$.css({position:"relative",left:"",top:""}).appendTo(e).draggable("disable").removeClass("is-expanded ui-state-disabled").removeAttr("data-owning-region").find(".a-GV-expandCollapse span").removeClass("icon-ig-restore").addClass("icon-ig-expand"),this.floatingItem$.children(".a-GV-floatingItemContent").hide().width(t).height(s),this.floatingItem$.find(".a-GV-expandCollapse").focus(),this.floatingItem$.find(".js-tabTrap").not(".js-last").attr("tabindex",-1)},_deactivateCell:function(t){var s,a,l,i,o=null;t.length<=0||(this._clearTabTraps(),this._setFocusable(t[0]),(s=this._getColumnMetadata(t))&&(o=this.columnItems[s.property]),o&&t.hasClass(p)&&(n(document.body).off(".gridpopup"),this._setModelValue(t,o.item,this.activeRecord,s.property),i=null,(l=this.model.getRecordMetadata(this.activeRecordId)).fields&&(i=l.fields[s.property]),this.debugDontDeactivateCell?t.addClass(f+" "+p):(this.floatingItem$.appendTo("body"),this.floatingItem$.hide(),this._deactivateColumnItem(o),a=e.htmlBuilder(),this._renderFieldDataValue(a,s,this.activeRecord,l,i),t.html(a.toString())),this._updateRecordState(this.lastRow$.parent(),this.activeRecordId,this.activeRecord,l)))},_finishEditing:function(e){var t,s=n(this.lastEditModeCell);s.length&&(t=s.hasClass(f),this._clearDeactivate(),this._deactivateCell(s),t&&this._activateCell(s)),e.resolve()},_setFocus:function(e){e.tabIndex=0,e.focus()},_setFocusable:function(t){var s,a,l,i,o,d,u,f,p,m,g,C,b,v=this,_=this.options.tabbableCellContent,w=z(t);function G(e){var t,s,a,l;for(t=0;t<v.columnGroups.length;t++)for(a=v.columnGroups[t],s=0;s<a.length;s++)if((l=a[s]).property===e)return l;return null}if(this.lastFocused&&(n(this.lastFocused).removeAttr("aria-labelledby").closest("td,th").removeAttr("id"),a=z(this.lastFocused),w[0]!==a[0]&&a.add(a.find(_).not(":disabled,.js-asc,.js-desc")).prop("tabIndex",-1)),f=(C=w.closest("tr")).attr("data-rownum"),p=null,(w.hasClass(c)||w.hasClass("a-GV-headerGroup"))&&(p=this.lastColIndex),null===p&&(p=W(w)),this.tableFrozenHeader$&&!w.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")&&(p+=this.frozenColumnCount),p+=1,C.hasClass(h)?(f+="b",m=F("BREAK_CONTEXT")):C.hasClass("is-aggregate")?m=F("AGG_CONTEXT"):w.hasClass("a-GV-header")?m=F("HEADER_CONTEXT"):w.hasClass("a-GV-headerGroup")?m=F("GROUP_CONTEXT"):(f!==this.curRowNum&&p!==this.curColNum?m=k("ROW_COLUMN_CONTEXT",f,p):f!==this.curRowNum?m=k("ROW_CONTEXT",f):p!==this.curColNum&&(m=k("COLUMN_CONTEXT",p)),(b=this._getControlBreak(parseInt(f,10)))&&b.offset!==this.curControlBreak&&(m=F("BREAK_CONTEXT")+" "+e.stripHTML(b.label)+"."+m)),m&&this.accContext$.text(m+" "),l=0,w.children(".a-GV-columnItem")[0]||(l=w.find(_).not(":disabled,.js-asc,.js-desc").prop("tabIndex",0).length),l||w.prop("tabIndex",0),this.lastFocused=t,i="",f!==this.curRowNum&&(this.curRowHeaders&&n(this.curRowHeaders).removeAttr("id"),this.curRowHeaders="",(C=this._getRowForCell(w)).find(".a-GV-rowHeader").not(w).each((function(e){var t=v.idPrefix+"_rh_"+e;n(this).attr("id",t),i+=t+" ",v.curRowHeaders&&(v.curRowHeaders+=","),v.curRowHeaders+="#"+t}))),p!==this.curColNum&&!this.focusInHeader)if((s=this._getColumnMetadata(w))&&s.domId){for(o="",d=L(s);d;)(u=G(d))&&u.domId&&(o=u.domId+" "+o),d=u.parentGroupName;o+=s.domId,i+=o+" "}else w.hasClass("a-GV-selHeader")&&(i+=this.idPrefix+"_shh ");g=this.idPrefix+"_cur",i+=g,i=this.accContextId+" "+i,n(t).attr("aria-labelledby",i).closest("td,th").attr("id",g),this.curRowNum=f,this.curColNum=p,this.curControlBreak=b?b.offset:null},_getCellFocusable:function(e){var t=e.find(this.options.tabbableCellContent).not(":disabled,.js-asc,.js-desc");return t.length?t[0]:e[0]},_getPrevCellUp:function(e,t,s){var a,l=null,i=null;return(e.hasClass(c)||e.hasClass("a-GV-headerGroup"))&&(i=this.lastColIndex),null===i&&(i=W(e),this.lastColIndex=i),e.closest("tr").prevAll(":visible").each((function(e){var s=n(this);return!s.hasClass("a-GV-scrollFiller")&&(a=s,e<t-1)})),this.focusInHeader||s||a||(this.focusInHeader=!0,a=e.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")?this.tableFrozenHeader$.children().last():this.tableHeader$.children().last()),a&&(l=a.hasClass(h)?a.children().first():E(a,i)),l},_getNextCellDown:function(e,t){var s,a=null,l=null;return(e.hasClass(c)||e.hasClass("a-GV-headerGroup"))&&(l=this.lastColIndex),null===l&&(l=W(e),this.lastColIndex=l),e.closest("tr").nextAll(":visible").each((function(e){var a=n(this);return!a.hasClass("a-GV-scrollFiller")&&(s=a,e<t-1)})),this.focusInHeader&&!s&&(this.focusInHeader=!1,s=e.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")?this.tableFrozenData$.children().first():this.tableData$.children().first()),s&&(a=s.hasClass(h)?s.children().first():E(s,l)),a},_copy:function(e){var t,s,a,l,i,o,n,r,d,h,c=this.model,u=this.options,f=u.dataTransferFormats;if(u.selectCells){if(r=[],!(a=this.getSelectedRange())||!a.values.length)return;for(r=a.columns.map((function(e){return e?u.columns[0][e]:null})),f.forEach((function(e){e.writer.begin(c,a,r)})),t=0;t<a.values.length;t++){for(d=a.recordIds[t],n=null!==d?c.getRecord(d):null,f.forEach((function(e){e.writer.beginRow(t,n,d)})),o=a.values[t],s=0;s<o.length;s++)h=n&&r[s]?c.getValue(n,r[s].property):"",f.forEach((function(e){e.writer.cell(s,r[s],h,o[s])}));f.forEach((function(e){e.writer.endRow()}))}}else{if(!(a=this.getSelection()).length)return;for(r=[],"NONE"!==u.rowHeader&&r.push(null),this.getColumns().forEach((function(e){e.hidden||r.push(e)})),f.forEach((function(e){e.writer.begin(c,a,r)})),t=0;t<a.length;t++){for(l=a[t],d=l.first().attr("data-id"),n=null!==d?c.getRecord(d):null,f.forEach((function(e){e.writer.beginRow(t,n,d)})),i=l.children(),s=0;s<i.length;s++)h=n&&r[s]?c.getValue(n,r[s].property):"",f.forEach((function(e){e.writer.cell(s,r[s],h,i.eq(s).text())}));f.forEach((function(e){e.writer.endRow()}))}f.forEach((function(e){e.writer.end()}))}f.forEach((function(t){t.writer.end(),e.setData(t.format,t.writer.toString())}))},_setSelectionMode:function(){var e=this.options,t=this.element.children(".a-GV-bdy").find(".is-selected");this.element.toggleClass("a-GV--selectCells",e.selectCells),t.removeClass(u).removeAttr("aria-selected"),e.persistSelection&&this.model.clearSelection(),this.allSelected=!1,this.lastFocused&&t[0]&&this._select(n(this.lastFocused),null,!1)},_select:function(t,s,a,l,i){var o,r,d,h,c,f,p,m,g,C,b,w,G,H,I,x,V,$,y,F,k,D,S,z=!1,M=this.options,T="set",E=this;function W(e,t){var s;M.persistSelection&&(s=e.length,E.tableFrozenHeader$&&(s/=2),e.each((function(e){var a;if(e>=s)return!1;a=n(this).attr("data-id"),t&&!1===I[a]?delete I[a]:I[a]=t})))}function A(e,t){var s=n(t);if(e>d)return!1;e>=r&&s.hasClass("a-GV-row")&&!s.hasClass("is-aggregate")&&(M.allowSelectHidden||s.is(":visible"))&&s.children().slice(F,k).addClass(u).attr("aria-selected",!0)}function P(e,t){var s=n(t);s.hasClass("a-GV-row")&&!s.hasClass("is-aggregate")&&(M.allowSelectHidden||s.is(":visible"))&&G.push(t)}if(M.persistSelection&&(I={}),"unset"===s||M.allowSelectHidden||(t=t.filter(":visible")),m=t.parent("tr"),x=this.lastRow$&&this.lastRow$.index(t.first())>=0,this.tableFrozenHeader$&&(G=[],w=E._getOtherTable(m.first()),m.each((function(){G.push(w[E._rowIndex(n(this))])})),m=m.add(n(G))),s&&(M.selectCells&&M.multipleCells||!M.selectCells&&M.multiple)&&("string"==typeof s?T=s:"click"===s.type?s.ctrlKey||s.metaKey?T="toggle":s.shiftKey&&(T="range"):"keydown"===s.type&&(s.which===_.SPACE?T=s.ctrlKey?"toggle":s.shiftKey?"range":"add":s.ctrlKey?T="none":s.shiftKey&&(T="range")),M.selectCells&&"range"!==T&&(T="set"),s.target||(s=null)),"range"!==T||this.selectAnchor&&!this.focusInHeader||(T="set"),!this.focusInHeader)if("set"!==T&&"range"!==T||(D=this.element.children(".a-GV-bdy").find(M.selectCells?"td.is-selected,th.is-selected":"tr.is-selected"),M.rowHeaderCheckbox&&D.find(".u-selector").removeClass(u),D.removeClass(u).removeAttr("aria-selected"),M.persistSelection&&this.model.clearSelection()),M.selectCells)"range"===T?(V=n(this.selectAnchor),r=R(V.parent()),d=R(t.last().parent()),r>d&&(f=d,d=r,r=f),h=R(V),$=this.tableFrozenData$&&V.closest(this.tableFrozenData$).length>0,c=R(t.last()),($===(y=this.tableFrozenData$&&t.last().closest(this.tableFrozenData$).length>0)&&h>c||$!==y&&!$)&&(f=c,c=h,h=f,f=y,y=$,$=f),this.tableData$&&!y&&(F=h,k=c+1,$!==y&&(F=0),this.tableData$.children().each(A)),$&&this.tableFrozenData$&&(F=h,k=c+1,$!==y&&(k=void 0),this.tableFrozenData$.children().each(A))):(t.addClass(u).attr("aria-selected",!0),this.selectAnchor=t[0]);else if(o=m.hasClass(u),g=m.filter(".a-GV-row").not(".is-aggregate"),"set"===T||"add"===T||"toggle"===T&&!o?(g.addClass(u).attr("aria-selected",!0),this.selectAnchor=g[0],z=!0):"range"===T?(r=this._rowIndex(n(this.selectAnchor)),d=this._rowIndex(m.last()),r>d&&(f=d,d=r,r=f),d+=1,G=[],this.tableDataChildren$.slice(r,d).each(P),this.tableFrozenData$&&this.tableFrozenDataChildren$.slice(r,d).each(P),(g=n(G)).addClass(u).attr("aria-selected",!0),z=!0):("toggle"===T&&o||"unset"===T)&&(g.removeClass(u).removeAttr("aria-selected"),this.selectAnchor=g[0],M.rowHeaderCheckbox&&g.find(".u-selector").removeClass(u),W(g,!1)),z&&(M.rowHeaderCheckbox&&g.find(".u-selector").addClass(u),W(g,!0)),M.multiple&&M.selectAll&&(C=(this.tableFrozenData$||this.tableData$).children(".a-GV-row").not(".is-aggregate"),M.allowSelectHidden||(C=C.filter(":visible")),this.allSelected=b=C.length>0&&C.length===C.filter(".is-selected").length,M.rowHeaderCheckbox&&this.tableFrozenHeader$.find(".u-selector").first().toggleClass(u,b).attr("aria-checked",b?v:"false").closest(".a-GV-selHeader").toggleClass(u,b)),M.persistSelection)for(H in I)I.hasOwnProperty(H)&&this.model.setSelectionState(H,I[H]);t.length>0&&null!==a&&(p=this._getCellFocusable(t.first()),a?this._setFocus(p):this._setFocusable(p),x||this._setCurrentRow(t[0])),this.focusInHeader||"toggle"!==T&&"unset"!==T&&("range"!==T||!M.selectCells&&o)&&("add"!==T||o)&&("set"!==T||!M.selectCells&&e.arrayEqual(D,g))||(S=!(i||M.navigation&&s&&"click"===s.type),l?B(this,S,s):N(this,S,s))},_clearChildrenRowCache:function(){this.tableFrozenDataChildren$=this.tableDataChildren$=null},_getOtherTable:function(e){var t,s=e.closest(r).parent().hasClass("a-GV-w-frozen");return e.parents(".a-GV-bdy").length?s?(this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),t=this.tableDataChildren$):(this.tableFrozenDataChildren$||(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),t=this.tableFrozenDataChildren$):t=(s?this.tableHeader$:this.tableFrozenHeader$).children(),t},_rowIndex:function(e){var t=e.closest(r).parent().hasClass("a-GV-w-frozen");return e.parents(".a-GV-bdy").length?(this.tableFrozenData$&&!this.tableFrozenDataChildren$&&(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),(t?this.tableFrozenDataChildren$:this.tableDataChildren$).index(e)):R(e)},_getRowForCell:function(e){var t=e.closest("tr");return this.tableFrozenHeader$&&(t=t.add(this._getOtherTable(t).eq(this._rowIndex(t)))),t},_setCurrentRow:function(e){this.lastRow$=this._getRowForCell(n(e)).children()},_fireActivate:function(e,t){var s=this._getRowForCell(t);this._trigger("activateCell",e,{cell$:t,row$:s})},_nextCellWithWrap:function(e){var t,s=this.options.skipReadonlyCells,a=this;function l(e){for(;s&&e.hasClass("is-aggregate")||e.not(":visible").length;)e=e.next();return e.children().first()}function i(e){var t,s,i,o=e.next();return o.length||(t=e.closest("tr"),a.tableFrozenHeader$?(s=a._getOtherTable(t),i=a._rowIndex(t),o=t.closest(r).parent().hasClass("a-GV-w-frozen")?s.eq(i).children().first():l(t=s.eq(i+1))):o=l(t=t.next())),o}if(t=i(e),s)for(;t.hasClass("is-readonly");)t=i(t);return t},_prevCellWithWrap:function(e){var t,s=this.options.skipReadonlyCells,a=this;function l(e){for(;s&&e.hasClass("is-aggregate")||e.not(":visible").length;)e=e.prev();return e.children().last()}function i(e){var t,s,i,o=e.prev();return o.length||(t=e.closest("tr"),a.tableFrozenHeader$?(s=a._getOtherTable(t),i=a._rowIndex(t),t.closest(r).parent().hasClass("a-GV-w-frozen")?(i-=1)>=0&&(o=l(t=s.eq(i))):o=s.eq(i).children().last()):o=l(t=t.prev())),o}if(t=i(e),s)for(;t.hasClass("is-readonly");)t=i(t);return t},_clearHoverStates:function(){this.element.find(".is-hover").removeClass("is-hover"),this.columnControls$.hide(),this.columnHandle$.hide()},_setRowHoverState:function(e){this.element.find(".is-hover").removeClass("is-hover"),(e=this._getRowForCell(e.children().eq(0))).addClass("is-hover")},_sortChange:function(e,t,s){var a,l="set",i=this._getColumnMetadata(t);i.canSort&&(a=s===i.sortDirection,this.options.columnSortMultiple&&e.shiftKey?(l="add",l=a?"remove":i.sortDirection?"change":"add"):a&&(l="clear"),this._trigger("sortChange",e,{header$:t,column:i,direction:s,action:l}))},_updateColumnControls:function(e){var t,s,a=!1,l=!1;"asc"===e.sortDirection?(t=F("SORT_OFF"),s=F("SORT_DESCENDING"),a=!0):"desc"===e.sortDirection?(t=F("SORT_ASCENDING"),s=F("SORT_OFF"),l=!0):(t=F("SORT_ASCENDING"),s=F("SORT_DESCENDING")),this.columnControls$.find(".js-asc").attr("title",t).attr("aria-label",t).toggleClass(p,a),this.columnControls$.find(".js-desc").attr("title",s).attr("aria-label",s).toggleClass(p,l)},_adjustSizeForScrollBars:function(t,s,a){var l=this.element.children(),i=l.filter(".a-GV-bdy").children(".a-GV-w-frozen"),o=l.filter(".a-GV-hdr").children(".a-GV-w-hdr"),n=function(e,t){var s=e.parent()[0],a={h:!1,v:!1};return e.outerHeight()+(t||parseInt(e.css("margin-top"),10))>s.clientHeight&&(a.v=!0),e.outerWidth()>s.clientWidth&&(a.h=!0),a}(this.tableData$.parent(),a);n.h&&(t-=e.getScrollbarSize().height),i.height(t),n.v&&(s-=e.getScrollbarSize().width),o.width(s)},_headerScrollCheck:function(e,t,s){var a,l,i,o=0,r=this.hdrScrollParent;return r&&(i=n(this.hdrScrollParent).offset().left,this.element.hasClass("u-RTL")?(e-t-i<10?o=-10:i+r.offsetWidth-e<10&&i+r.offsetWidth-e>0&&(o=10),s&&o&&((a=r.scrollLeft+o)>0?(r.scrollLeft=0,o=0):a>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=a)):(i+r.offsetWidth-(e+t)<10?o=10:e-i<10&&e-i>0&&(o=-10),s&&o&&((a=r.scrollLeft+o)<0?(r.scrollLeft=0,o=0):a>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=a)),l=!!o),l},_headerScrollStart:function(e,t,s){var a=this,l=0,i=[151,134,119,106,95,86,79,74,71];this.scrollTimerId&&this._headerScrollStop(),function o(){a.scrollTimerId=setTimeout((function(){a._headerScrollCheck(e,t,!0)?(s(),o()):a._headerScrollStop()}),i[l]),l<i.length-1&&(l+=1)}()},_headerScrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_expandCollapseControlBreak:function(e,t){var s,a,l,i,o,r,d,c=[],f=!this.options.allowSelectHidden;function p(e,s){var a=n(s);if(a.hasClass("a-GV-row")&&!a.hasClass("is-aggregate"))!t&&f&&a.hasClass(u)&&c.push(a.children("td,th")[0]),a[t?"show":"hide"]();else{if(a.hasClass(h))return r=!0,!1;if(a.hasClass("a-GV-scrollFiller"))return d=parseInt(a.attr("data-start"),10),!1}}for(n.isArray(e)||(e=[e]),s=0;s<e.length;s++)if((a=e[s]).hasClass(h))if(2!==a.length&&this.tableFrozenHeader$&&(l=this._getOtherTable(a),a=n([a[0],l[this._rowIndex(a)]])),r=!1,a.first().nextAll().each(p),f=!1,2===a.length&&a.last().nextAll().each(p),t)i=F("BREAK_COLLAPSE"),a.addClass("is-expanded").find(".js-toggleBreak").attr("aria-expanded",v).attr("title",i).attr("aria-label",i).children(".a-Icon").removeClass("icon-right-arrow").addClass("icon-down-arrow");else{let t=this.model.getOption("hasTotalRecords");i=F("BREAK_EXPAND"),a.removeClass("is-expanded").find(".js-toggleBreak").attr("aria-expanded","false").attr("title",i).attr("aria-label",i).children(".a-Icon").removeClass("icon-down-arrow").addClass("icon-right-arrow"),s===e.length-1&&this.scrollPaging&&(r?!t&&this.tableData$.height()<this.scrollParent$.height()&&this._addNextPage():t?d>=0&&(this.pageOffset=d,this._addPageOfRecords()):this._addNextPage())}c.length&&(o=this.focusInHeader,this.focusInHeader=!1,this._select(n(c),"unset",n(document.activeElement).closest(this.element[0]).length>0,null),this.focusInHeader=o)},debugCellEdit:function(e){this.debugDontDeactivateCell=!!e}},apex.widget.contextMenuMixin)),n.ui.dialog&&n.widget("ui.dialog",n.ui.dialog,{_allowInteraction:function(e){return n(e.target).closest(".a-GV-floatingItem").length>0||this._super(e)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.clipboard,apex.widget.util,apex.jQuery);
!function(e,t,i,o,r,l,s){"use strict";var d=".u-Form-fieldContainer",n="show",a="hide",c="delete-record",u="next-record",h="previous-record",f="insert-record",p=s.ui.keyCode;var m=[{align:"start",controls:[{type:"MENU",labelKey:"APEX.RV.SETTINGS_MENU",iconOnly:!0,icon:"icon-gear",menu:{items:[{type:"toggle",action:"exclude-null-values"},{type:"toggle",action:"exclude-hidden"}]}}]},{align:"end",controls:[{type:"STATIC",id:"status",label:""},{type:"BUTTON",iconOnly:!0,action:h},{type:"STATIC",id:"recordNumber",label:""},{type:"BUTTON",iconOnly:!0,action:u}]}];function g(e){var t=e.groupName||null;return t&&e.useGroupFor&&e.useGroupFor.indexOf("srv")<0&&(t=null),t}s.widget("apex.recordView",s.apex.tableModelViewBase,{version:"19.1",widgetEventPrefix:"recordview",options:{idPrefix:null,actionsContext:null,recordOffset:0,recordParent:null,showNullAs:"-",fields:null,fieldGroups:null,alwaysEdit:!1,skipDeletedRecords:!1,toolbar:m,showExcludeNullValues:!0,showExcludeHiddenFields:!0,formCssClasses:null,labelAlignment:"end",tabbableFieldContent:"a,button,input",modeChange:null,recordChange:null},_create:function(){var e=this,t=this.options,i=this.element;i.addClass("a-RV"),this._super(),delete this.firstPage,delete this.previousPage,delete this.nextPage,delete this.lastPage,delete this.loadMore,delete this.gotoPage,this.editMode=!1,this.fields=null,this.excludeNullValues=!1,this.excludeHiddenFields=!1,this.lastFocused=null,this.lastField=null,this.toolbar$=null,this.currentRecord=null,this.currentRecordId=null,t.actionsContext?this.actions=t.actionsContext:this.actions=l.createContext("recordView",i[0]),this.actions.remove(["exclude-null-values","exclude-hidden",u,h,f,"refresh-record","revert-record",c,"duplicate-record"]),this.actions.add([{name:"exclude-null-values",labelKey:"APEX.RV.EXCLUDE_NULL",get:function(){return e.excludeNullValues},set:function(o){t.showExcludeNullValues&&(e.excludeNullValues=o,i.toggleClass("a-RV--excludeNull",o))}},{name:"exclude-hidden",labelKey:"APEX.RV.EXCLUDE_HIDDEN",get:function(){return e.excludeHiddenFields},set:function(o){t.showExcludeHiddenFields&&(e.excludeHiddenFields=o,i.toggleClass("a-RV--excludeHidden",o))}},{name:u,labelKey:"APEX.RV.NEXT_RECORD",shortcut:"Alt+Page Down",icon:"icon-next",action:function(){var i,o;if("tree"===e.modelShape){if(!(o=e._nextTreeRecord()))return;t.recordParent=o.parent,t.recordOffset=o.offset}else{if(!((i=e.model.getTotalRecords())<0||t.recordOffset+1<i))return;t.recordOffset+=1}e.direction=1,e.refresh(!1)}},{name:h,labelKey:"APEX.RV.PREV_RECORD",shortcut:"Alt+Page Up",icon:"icon-prev",action:function(){var i;if("tree"===e.modelShape){if(!(i=e._previousTreeRecord()))return;t.recordParent=i.parent,t.recordOffset=i.offset}else{if(!(t.recordOffset>0))return;t.recordOffset-=1}e.direction=-1,e.refresh(!1)}},{name:f,labelKey:"APEX.RV.INSERT",action:function(){if(t.editable)return e.model.insertNewRecord("tree"===e.modelShape?t.recordParent:null,e.getRecord()),e.actions.invoke(u),e.editMode||e.setEditMode(!0),e.focus(),!0}},{name:"refresh-record",labelKey:"APEX.RV.REFRESH",action:function(){e.model.fetchRecords([e.getRecord()])}},{name:"revert-record",labelKey:"APEX.RV.REVERT",action:function(){t.editable&&e.model.revertRecords([e.getRecord()])}},{name:c,labelKey:"APEX.RV.DELETE",action:function(){t.editable&&e.model.deleteRecords([e.getRecord()])}},{name:"duplicate-record",labelKey:"APEX.RV.DUPLICATE",action:function(){if(t.editable){var i=e.getRecord();return e.model.copyRecords([i],null,i),e.actions.invoke(u),e.editMode||e.setEditMode(!0),e.focus(),!0}}}]),this._updateMenuActions(),this._initModel(t.modelName),this._on(this._eventHandlers),this.direction=1,this.refresh(),t.disabled&&this._setOption("disabled",t.disabled)},_eventHandlers:{resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())},dblclick:function(e){var t=this.options;s(e.target).closest(d).length&&!t.alwaysEdit&&t.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0))},click:function(e){var t=s(e.target).closest(".u-Form-label");t.length&&t.closest(d).find(":tabbable").first().focus()},keydown:function(e){var t,i,o=this.options,r=e.which;if(r===p.ENTER){if(s(e.target).closest("a,button").length>0)return;s(e.target).closest(d).length&&!o.alwaysEdit&&o.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0))}else if(113===r)s(e.target).closest(d).length&&!o.alwaysEdit&&o.editable&&!this.editMode&&(e.preventDefault(),this.setEditMode(!0));else if(r===p.ESCAPE)!o.alwaysEdit&&o.editable&&this.editMode&&(this.setEditMode(!1),e.stopPropagation());else if(112===r&&e.altKey&&(t=s(e.target).closest(d).find(".js-itemHelp")).length&&(i=t.attr("data-itemhelp")))return apex.theme.popupFieldHelp(i,$v("pInstance")),!1},focusin:function(e){var t,i,o=this;function r(){o.deactivateDelayTimer&&(clearTimeout(o.deactivateDelayTimer),o.deactivateDelayTimer=null)}0!==(i=s(e.target).closest(d)).length?(i.addClass("is-focused"),this.lastFocused=i[0],i[0]!==this.lastField?(this.lastField=i[0],this.editMode&&(r(),(t=this.element.find(".is-active")).length&&this._deactivateField(t),this._activateField(i))):r()):this.lastField=null},focusout:function(e){var t=this,i=s(e.target).closest(d);0!==i.length&&(i.removeClass("is-focused"),this.editMode&&(this.deactivateDelayTimer=setTimeout((function(){t.lastField=null,t._deactivateField(i),t.deactivateDelayTimer=null}),10)))}},_destroy:function(){this.element.removeClass("a-RV is-disabled u-RTL a-RV--excludeHidden a-RV--excludeNull").empty(),this._initModel(null)},_setOption:function(e,t){"editable"===e&&!t&&this.editMode&&this.setEditMode(!1),this._super(e,t),"disabled"===e?(this.element.toggleClass("is-disabled",t),t&&this.resize()):"showExcludeNullValues"===e||"showExcludeHiddenFields"===e?this._updateMenuActions():"recordOffset"===e||"recordParent"===e?this.refresh():"modelName"===e?(this.editMode&&this.setEditMode(!1),this._initModel(t),this.refresh()):"editable"!==e&&"alwaysEdit"!==e&&"toolbar"!==e&&"formCssClasses"!==e&&"labelAlignment"!==e||this._refreshView()},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},refresh:function(e){var t,i=this,o=this.options,r=this.element;this._refreshCheckIfVisible()&&((t=r.find(".u-Form-fieldContainer.is-active")).length&&this._deactivateField(t),this.fields||this._initView(),!this.editMode&&o.alwaysEdit&&this.setEditMode(!0),this._updateRecord(null,null,(function(){e&&i.focus()})))},focus:function(){this.lastField=null,this.body$.find(":tabbable").first().focus()},gotoField:function(e,t){var o,r,l,s,d,n=this.options,a=null;if(r=this.model.getRecord(e)){if(e!==this.currentRecordId&&(n.recordOffset=this.model.indexOf(r),this.refresh()),t)if(s=n.fields[0][t]){for(s.hidden&&s.canHide&&this.excludeHiddenFields&&this.actions.set("exclude-hidden",!1),null!==(d=this.model.getValue(r,t))&&""!==d||!this.excludeNullValues||this.actions.set("exclude-null-values",!1),o=0;o<this.fields.length;o++)if(!((l=this.fields[o]).virtual||!l.canHide&&l.hidden)&&l.property===t){a=this.element.find("[data-idx='"+o+"']");break}o>=this.fields.length&&i.warn("Warning field is hidden "+t)}else i.warn("Warning field not found "+t);a?(this.lastField=null,a.find(":tabbable").first().focus()):this.focus()}else i.warn("Warning record not found "+e)},getFields:function(){return this.fields},refreshFields:function(){this.fields=null},fieldElement:function(e){return this.mapFieldToLabelId&&this.mapFieldToLabelId[e]?s("#"+this.mapFieldToLabelId[e]).closest(d):s()},inEditMode:function(){return this.editMode},setEditMode:function(e){var t,o,r=this.element,l=this;this.scrollWrap$&&(this.options.editable?(e=!!e,o=this.editMode,e!==o&&((t=s(this.lastFocused)).length&!e&&l._deactivateField(t),this._updateRecord(e,o,(function(){l.editMode=e,r.toggleClass("a-RV--editMode",e),e&&!t.length&&(l.focus(),t=s(l.lastFocused)),t.length&&(t.find(":tabbable").first().focus(),l.deactivateDelayTimer&&(clearTimeout(l.deactivateDelayTimer),l.deactivateDelayTimer=null),e&&l._activateField(t)),e?l.body$.on("change.rvedit",(function(e){var t,i,o;if(l.activeRecord&&!s(e.target).closest(".u-Form-fieldContainer.is-active").length)for(t=0;t<l.fields.length;t++)if((i=l.fields[t]).elementId===e.target.id){o=i.property,l.setActiveRecordValue(o);break}})):(l._forEachField(!0,(function(e,t){l.columnItems.hasOwnProperty(t.property)&&l._deactivateColumnItem(l.columnItems[t.property])})),l.body$.off("change.rvedit"),l.activeRecord=null,l.activeRecordId=null),l._trigger("modeChange",null,{editMode:e})})))):e&&i.warn("View is not editable."))},getRecord:function(){return this.currentRecord},resize:function(){var e,t=this.element,i=t.height();null!==t[0].offsetParent&&(this.scrollWrap$&&!this.pendingRefresh||(this.refresh(),this.fields))&&this.options.hasSize&&(e=i-(this.toolbar$?this.toolbar$.outerHeight():0),this.scrollWrap$.height(e))},expandGroup:function(e){},collapseGroup:function(e){},_initModel:function(t){var i,o=this.options,r=this;this._super(t,(function(t,l){var s,d,n,a,c,f,p,m;function g(e,s){var d,n;for(d=0;d<e.length;d++)(n=e[d])===r.currentRecordId&&("delete"===t?i&&o.skipDeletedRecords?(r.currentRecord=null,r.currentRecordId=null,r.activeRecord=null,r.activeRecordId=null,r.actions.invoke(u),null===r.currentRecord&&r.actions.invoke(h)):r._updateRecord():"clearChanges"===t&&s?r.actions.invoke(u):"refreshRecords"===t?(n=l.newIds[n]||n,r._updateRecord()):"revert"===t?r._updateRecord():r._updateRecordState())}r.pendingRefresh||("refresh"===t?("tree"===r.modelShape?(r.recordOffset=-1,r.recordParent=null):"table"===r.modelShape&&r.currentRecordId?(p=r.model.getRecord(r.currentRecordId),m=r.model.indexOf(p),o.recordOffset=m>-1?m:0):o.recordOffset=0,r.refresh(!0)):"insert"===t||"copy"===t?r.noData&&r.refresh():"refreshRecords"===t?g(l.recordIds):"clearChanges"===t?(g(l.deletedIds,!0),g(l.changedIds)):l.recordIds?g(l.recordIds):"set"===t?null!==r.ignoreFieldChange&&r.ignoreFieldChange===l.field||(l.oldIdentity&&r._identityChanged(l.oldIdentity,r.model.getRecordId(l.record)),r.model.getRecordId(l.record)===r.currentRecordId&&(s=r.columnItems[l.field],r.editMode&&s?r.ignoreItemChange||r._setColumnItemValue(s.item,l.record,l.field):(a=r.fieldElement(l.field)).length&&(n=r._getFieldMetadata(a),f=null,(c=r.model.getRecordMetadata(r.currentRecordId)).fields&&(f=c.fields[n.property]),d=e.htmlBuilder(),r._renderFieldDataValue(d,n,l.record,c,f),a.find(".a-RV-fieldValue").html(d.toString())),r._updateRecordState())):"metaChange"===t&&(null!==r.ignoreFieldChange&&r.ignoreFieldChange===l.field||l.recordId!==r.currentRecordId||r._updateRecordState()))})),t&&(i=this.model.getOption("onlyMarkForDelete"),this.modelShape=this.model.getOption("shape"),"record"===this.modelShape&&(this.actions.hide(u),this.actions.hide(h),this.actions.hide(f),this.actions.hide("duplicate-record"),this.actions.hide(c)))},_updateMenuActions:function(){var e=this.options;this.actions[e.showExcludeNullValues?n:a]("exclude-null-values"),this.actions[e.showExcludeHiddenFields?n:a]("exclude-hidden")},_updateFields:function(){var e,t,i,o=this.options,r={},l=o.fields[0];for(t in this.fields=[],l)l.hasOwnProperty(t)&&((e=l[t]).property=t,this.fields.push(e),(i=g(e))&&(!r[i]||e.seq<r[i])&&(r[i]=e.seq));this.fields.sort((function(e,t){return g(e)===g(t)?e.seq-t.seq:g(e)?g(t)?(r[g(e)]||0)-(r[g(t)]||0):-1:1}))},_initView:function(){var e=this.options,t=this.editMode;this._updateFields(),this.columnItems||this._initColumnItems(this.fields),this.toolbar$=null,t&&this.setEditMode(!1),this._renderView(),(t||e.alwaysEdit)&&this.setEditMode(!0),e.toolbar&&(this.toolbar$=this.element.children(".a-RV-toolbar").toolbar({idPrefix:this._getIdPrefix()+"tb",actionsContext:this.actions,data:e.toolbar,small:!0}),"record"===this.modelShape&&this.toolbar$.toolbar("hideControl","recordNumber")),this.resize()},_refreshView:function(){this.refreshFields(),this.refresh()},_forEachField:function(e,t){var i,o,r,l,s,d=this.fields;for(e&&(l=this.element.find(".a-RV-fieldValue")),r=0,i=0;i<d.length;i++)(o=d[i]).virtual||!o.canHide&&o.hidden||(s=null,e&&(s=l.eq(r)),t.call(this,i,o,s),r+=1)},_getIdPrefix:function(){return(this.options.idPrefix||this.element[0].id||"rv")+"_"},_renderView:function(){var t,i,r,l=this.options,d=this.element,n=e.htmlBuilder();function a(){n.markup("<div").attr("class","u-Form"+(l.formCssClasses?" "+l.formCssClasses:"")).markup(">"),i=!0}l.toolbar&&n.markup("<div class='a-RV-toolbar'></div>"),this._renderAltDataMessages(n),n.markup("<div class='a-RV-w-scroll'>").markup("<div class='a-RV-body'>"),this.mapFieldToLabelId={},t=null,i=!1,this._forEachField(!1,(function(e,s){var d,c,u,h,f,p,m,v=this._getIdPrefix()+e,R=this.columnItems[s.property];if(this.mapFieldToLabelId[s.property]=v,r=g(s),t!==r){if(r){if(!(c=l.fieldGroups[r]))throw new Error("Unknown field group name: "+r);u=c.label||c.heading}else u=o.getMessage("APEX.RV.NOT_GROUPED_LABEL");i&&n.markup("</div>"),n.markup("<h3 class='u-Form-groupHeading'><button type='button'>").content(u).markup("</button></h3>"),a(),t=r}i||a(),d="u-Form-fieldContainer",s.hidden&&(d+=" a-RV-field--hidden"),s.fieldCssClasses&&(d+=" "+s.fieldCssClasses),s.isRequired&&(d+=" is-required"),h=s.label||s.heading,f=null,s.fieldColSpan&&((f=parseInt(s.fieldColSpan,10))>0&&f<13?n.markup("<div class='apex-col apex-col-"+f+"'>"):f=null),n.markup("<div").optionalAttr("id",s.elementId?s.elementId+"_CONTAINER":null).attr("data-idx",e).attr("class",d).markup("><div").attr("id",v).attr("class","u-Form-labelContainer "+function(e,t){var i="";return"start"===e?i=" u-tS":"end"===e?i=" u-tE":"left"===e?i=" u-tL":"right"===e?i=" u-tR":"center"!==e||t||(i=" u-tC"),i}(l.labelAlignment)).markup(">"),m=null,R&&R.item.setLabel||(m=s.elementId?s.elementId+"_LABEL":null,n.markup("<span").optionalAttr("id",m).attr("class","u-Form-label").markup(">").content(h).markup("</span>")),n.markup("</div><div class='u-Form-inputContainer'><div class='a-RV-fieldValue'></div>"),s.helpid&&(p=o.formatMessage("APEX.ITEM.HELP_TEXT",h),n.markup("<button class='t-Button t-Button--noUI t-Button--helpButton js-itemHelp' tabindex='-1' type='button'").attr("data-itemhelp",s.helpid).attr("aria-label",p).attr("title",p).markup("><span class='a-Icon icon-help' aria-hidden='true'></span></button>")),n.markup("</div></div>"),f&&n.markup("</div>")})),i&&n.markup("</div>"),n.markup("</div></div>"),d.html(n.toString()).find(".u-Form-groupHeading").each((function(){var e=s(this);e.collapsible({heading:".u-Form-groupHeading",controllingElement:"button",universalTheme:!0,collapsed:!1,content:e.next()})})),this.scrollWrap$=d.find(".a-RV-w-scroll"),this.body$=d.find(".a-RV-body"),this.noData$=d.find(".a-GV-noDataMsg")},_updateRecord:function(e,t,i){var o,r=this,l=this.currentRecordId,s=this.options;function d(){var e,t,i,o,l,s;for(o=r.model.getRecordMetadata(r.currentRecordId),e=0;e<r.fields.length;e++)t=r.fields[e].property,(i=r.columnItems[t])&&(s=i.item.isDisabled(),i.element$.is(":visible")&&!s?i.item.getValidity().valid||r.model.setValidity("error",r.currentRecordId,t,i.item.getValidationMessage()):r.model.setValidity("valid",r.currentRecordId,t),o&&((l=o.fields?o.fields[t]:null)&&l.hasOwnProperty("disabled")||s)&&(l||(o.fields||(o.fields={}),l={},o.fields[t]=l),l.disabled=s));r._triggerEndEditing(r.currentRecord,r.currentRecordId),r.activeRecord=null,r.activeRecordId=null}function n(o,n,a){var c,u,h,f=r.body$;if(o){if(c=r.model.getRecordMetadata(a)||{},r.scrollWrap$.show(),r.noData$.hide(),c.agg||c.deleted&&s.skipDeletedRecords)return"tree"===r.modelShape?(u=r[r.direction>0?"_nextTreeRecord":"_previousTreeRecord"]())&&(s.recordParent=u.parent,s.recordOffset=u.offset):(s.recordOffset+=r.direction,h=r.model.getTotalRecords(),s.recordOffset<0?(s.recordOffset=0,r.direction=-r.direction):h>=0&&s.recordOffset>=h&&(s.recordOffset=h-1,r.direction=-r.direction)),r._updateRecord(e,t,i),void r._updateRecord();s.editable&&r.currentRecord&&(e&&!1!==t||!0===t)&&d(),s.recordOffset=n,r.currentRecordId=a,r.currentRecord=null,r.activeRecord=null,r._renderRecordFields(e,o,n,a,c),r.currentRecord=o,e&&(r.activeRecord=o,r.activeRecordId=a),f.children(".t-Alert").remove(),f.find(".t-Form-error").remove(),r._updateRecordState(),r._updateRecordNumber(),s.editable&&e&&r._triggerBeginEditing(r.currentRecord,r.currentRecordId),null!==l&&l===r.currentRecordId||setTimeout((function(){r._trigger("recordChange",null,{recordOffset:s.recordOffset,recordId:r.currentRecordId})}),1)}else s.editable&&r.currentRecord&&(e&&!1!==t||!0===t)&&d(),r.currentRecordId=null,r.currentRecord=null,r._renderRecordFields(e,null,-1,null,{}),r.scrollWrap$.hide(),r.noData$.show(),r._updateActions(),r._updateRecordNumber()}if(null==e&&(e=this.editMode),this.activeLockCount>0)this.activeUnlockCallback=function(){r._updateRecord(e,t,i)};else{switch(this.modelShape){case"record":n(o=this.model.getRecord(),0,o?this.model.getRecordId(o):null);break;case"table":this.model.forEachInPage(s.recordOffset,1,(function(e,t,i){n(e,t,i)}),this);break;case"tree":null===s.recordParent?(o=this.model.root(),s.recordOffset=-1,n(o,s.recordOffset,o?this.model.getRecordId(o):null)):n(o=this.model.child(s.recordParent,s.recordOffset),s.recordOffset,o?this.model.getRecordId(o):null)}i&&i()}},_renderRecordFields:function(t,i,o,r,l){var d=null,n=this.options.tabbableFieldContent,a=!1,c=e.htmlBuilder(),u=this.columnItemsContainer$?this.columnItemsContainer$[0]:null;t&&i&&(a=this.model.allowEdit(i)),this._forEachField(!0,(function(e,t,o){var r,h,f,p,m=null,g=!1;r="u-Form-fieldContainer",i&&(null!==(h=this.model.getValue(i,t.property))&&""!==h||(r+=" a-RV-field--null"),t.hidden&&(r+=" a-RV-field--hidden"),t.fieldCssClasses&&(r+=" "+t.fieldCssClasses),t.isRequired&&(r+=" is-required"),l.fields&&(d=l.fields[t.property]),d&&(d.disabled&&(r+=" is-disabled"),g=d.ck),(g||t.readonly)&&(r+=" is-readonly",g=!0)),(f=this.columnItems[t.property])&&f.item.setLabel||(m=t.elementId+"_LABEL"),a&&f&&!g&&!t.volatile?f.element$.parent()[0]===u&&(o.empty().append(f.element$),this._activateColumnItem(f,m),m||f.item.setLabel(t.label||t.heading)):(f&&f.element$.closest(this.element).length&&(this._deactivateColumnItem(f),m||f.item.setLabel(null)),i?(c.clear(),m||((d=s.extend(!0,{},d)).ck="X"),this._renderFieldDataValue(c,t,i,l,d),m||c.markup("<span class='u-Form-label'>").content(t.label||t.heading).markup("</span>"),o.html(c.toString()),(p=o.find(n)).length&&(o.attr("aria-labelledby",m).attr("role","group"),p.filter("[tabindex]").attr("tabindex",0))):o.empty()),o.parent().parent().attr("class",r)})),a&&i&&(this._beginSetColumnItems(),this._forEachField(!0,(function(e,t,o){var r=this.columnItems[t.property];!r||o.hasClass("is-readonly")||t.volatile||this._setColumnItemValue(r.item,i,t.property,a?l:null)})),this._endSetColumnItems())},_updateRecordState:function(){var e,t,i,r,l,d="",n=this.body$;if(t=this.model.getRecordMetadata(this.currentRecordId)||{},n.removeClass("is-deleted is-inserted is-updated is-error is-warning is-readonly"),t.deleted?(n.addClass("is-deleted"),d=o.getMessage("APEX.GV.ROW_DELETED")):t.inserted?(n.addClass("is-inserted"),d=o.getMessage("APEX.GV.ROW_ADDED")):t.updated&&(n.addClass("is-updated"),d=o.getMessage("APEX.GV.ROW_CHANGED")),this.model.allowEdit(this.currentRecord)||n.addClass("is-readonly"),t.error||t.warning?((i=n.children(".t-Alert")).length||(i=s("<div class='t-Alert'></div>"),n.prepend(i)),i.text(t.message),n.addClass(t.error?"is-error":"is-warning")):n.children(".t-Alert").remove(),t.fields)for(e in t.fields)t.fields.hasOwnProperty(e)&&(r=t.fields[e],(l=this.fieldElement(e)).removeClass("is-changed is-stale is-error is-warning is-readonly"),r.error||r.warning?((i=l.find(".t-Form-error")).length||(i=s("<span class='t-Form-error'></span>"),l.find(".u-Form-inputContainer").append(i)),i.text(r.message),l.addClass(r.error?"is-error":"is-warning")):(l.find(".t-Form-error").remove(),r.changed?l.addClass("is-changed"):r.stale&&l.addClass("is-stale")),r.ck&&l.addClass("is-readonly"));this._updateActions(),this.toolbar$&&this.toolbar$.toolbar("findElement","status").text(d)},_hasPrevious:function(){var e=this.options;switch(this.modelShape){case"record":return!1;case"table":return e.recordOffset>0;case"tree":return null!==this._previousTreeRecord()}},_hasNext:function(){var e,t=this.options;switch(this.modelShape){case"record":return!1;case"table":return(e=this.model.getTotalRecords())<0||t.recordOffset+1<e;case"tree":return null!==this._nextTreeRecord()}},_nextTreeRecord:function(){var e,t,i=this.options,o=i.recordOffset,r=i.recordParent;if(t=null===r?this.model.root():this.model.child(r,o),this.model.childCount(t)>0)return{parent:t,offset:0};for(;r;){if((e=this.model.childCount(r))>0&&o+1<e)return{parent:r,offset:o+1};o=this.model.indexOf(r),r=this.model.parent(r)}return null},_previousTreeRecord:function(){var e=this,t=this.options,i=t.recordOffset,o=t.recordParent;return null===o?null:o&&i>0?function t(i){var o=e.model.childCount(i);return o>0?t(e.model.child(i,o-1)):{parent:e.model.parent(i),offset:e.model.indexOf(i)}}(this.model.child(o,i-1)):{parent:this.model.parent(o),offset:this.model.indexOf(o)}},_updateActions:function(){var e=this.options,t=this.actions,i=this.currentRecord,o=e.editable,r=this.model,l="tree"===this.modelShape?e.recordParent:null,s=o&&r.allowAdd(l,"new"),d=o&&i&&r.allowAdd(l,"copy"),n=o&&i;function a(e,i){t[e?"enable":"disable"](i)}a(n&&r.canRevertRecord(i),"revert-record"),a(n&&r.allowDelete(i),c),a(s,f),a(d,"duplicate-record"),a(i&&this._hasNext(),u),a(i&&this._hasPrevious,h)},_getFieldMetadata:function(e){var t=parseInt(e.attr("data-idx"),10);return isNaN(t)?null:this.fields[t]},_activateField:function(e){var t,i;e.length<=0||null===this.currentRecord||((t=this._getFieldMetadata(e))&&(i=this.columnItems[t.property]),i&&this.model.allowEdit(this.currentRecord)&&!e.hasClass("is-readonly")&&e.addClass("is-active"))},_deactivateField:function(e){var t,i=null;e.length<=0||null===this.currentRecord||((t=this._getFieldMetadata(e))&&(i=this.columnItems[t.property]),i&&!e.hasClass("is-readonly")&&e.hasClass("is-active")&&(this._setModelValue(e,i.item,this.currentRecord,t.property),this._updateRecordState()))},_updateRecordNumber:function(){var e,t,i="",r=this.options;this.toolbar$&&(this.currentRecord&&("tree"===this.modelShape?(t=this.model.parent(this.currentRecord))&&(e=this.model.childCount(t)):e=this.model.getTotalRecords(),i=e>0?o.formatMessage("APEX.RV.REC_XY",r.recordOffset+1,e):o.formatMessage("APEX.RV.REC_X",r.recordOffset+1)),this.toolbar$.toolbar("findElement","recordNumber").text(i))},_identityChanged:function(e,t){e===this.currentRecordId&&(this.currentRecordId=t,this.activeRecordId&&(this.activeRecordId=t))}}),s.apex.recordView.copyDefaultToolbar=function(){var e,t=[];for(e=0;e<m.length;e++)t.push(s.extend(!0,{},m[e]));return t},s.apex.recordView.createModelEditDialog=function(i,r){var d,u,h,m,g,v,R,b,E,C,y,x,_,I,w,V,O,M=s,T=[],F=M("#"+i),P=r.modelOptions.shape||"table",A=r.okLabelKey?o.getMessage(r.okLabelKey):null,D=e.htmlBuilder();function S(e){I&&(v&&I.expand(I.getSelection().first()),O&&clearTimeout(O),O=setTimeout((function(){I[v?"setSelectedNodes":"setSelectedRecords"]([e]),O=null}),1))}r.appendToTop&&(M=e.getTopApex().jQuery),x=M("body").context,F.length||(F=M("<div id='"+i+"'></div>"),M(r.appendTo||"body").append(F)),"tree"===P?u=s.apex.treeView.makeModelNodeAdapter(r.modelName,r.modelOptions,null):("record"===P&&(T=null),u=t.create(r.modelName,r.modelOptions,T,0,!1)),E=u.getOption("shape"),C=u.getOption("fields"),y=u.getOption("editable"),_=y&&u.getOption("sequenceField"),D.markup("<form novalidate><section class='a-IGDialog-region a-IGDialog-body'>"),"record"!==E&&D.markup("<aside class='a-IGDialog-side resize'><div class='nav resize'></div><div class='tb'></div></aside>"),D.markup("<main class='a-IGDialog-main resize'><div class='rv resize'></div></main></section></form>"),(d=s.extend({closeText:o.getMessage("APEX.DIALOG.CLOSE"),noDataMessage:null},r,{autoOpen:!1,modal:!0,create:function(){var e,t,o,d,p=l.createContext("ModelEditDialog",F[0]);if(M(this).closest(".ui-dialog").css("position","fixed"),(g=s("#"+i,x).find(".rv")).recordView({modelName:r.modelName,noDataMessage:r.noDataMessage,idPrefix:r.idPrefix||r.modelName,fields:[C],actionsContext:p,toolbar:null,editable:!0,alwaysEdit:!0,hasSize:!0,skipDeletedRecords:!0,formCssClasses:r.formCssClasses,labelAlignment:r.labelAlignment,recordChange:function(t,i){var o;"nav"!==e&&(o=g.recordView("getRecord"))&&(e="rv",S(o),e=null)}}),"record"!==E&&(R=s("#"+i,x).find(".tb"),p.add([{name:"move-up",labelKey:"APEX.RV.MOVE_UP",hide:!0,action:function(){var e,t=null,i=h.grid("getSelection"),o=h.grid("getSelectedRecords");i[0].prev().length&&((e=i[0].prev().prev()).length&&(t=h.grid("getRecords",[e])[0]),u.moveRecords(o,null,t),h.grid("setSelectedRecords",o))}},{name:"move-down",labelKey:"APEX.RV.MOVE_DOWN",hide:!0,action:function(){var e,t=null,i=h.grid("getSelection"),o=h.grid("getSelectedRecords");(e=i[i.length-1].next()).length&&(t=h.grid("getRecords",[e])[0],u.moveRecords(o,null,t),h.grid("setSelectedRecords",o))}}]),t=[{type:"BUTTON",iconOnly:!0,icon:"icon-plus",action:f},{type:"BUTTON",iconOnly:!0,icon:"icon-copy",action:"duplicate-record"},{type:"BUTTON",iconOnly:!0,icon:"icon-minus",action:c},{type:"BUTTON",iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:"BUTTON",iconOnly:!0,icon:"icon-down-chevron",action:"move-down"}],p[y?n:a](c),p[y?n:a](f),p[y&&r.includeCopy?n:a]("duplicate-record"),p[_?n:a]("move-up"),p[_?n:a]("move-down"),R.toolbar({actionsContext:p,data:[{align:"start",controls:t}]})),"table"===E)if(r.useList){if(m=s("#"+i,x).find(".nav"),!(d=r.recordTemplate)){if(!r.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");d="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",r.iconClassColumn&&(d+="<span class='a-IconList-icon'><span class='&"+r.iconClassColumn+".'></span></span>"),r.enabledCheckbox&&(d+="<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>"),d+="<span class='a-IconList-label'>&"+r.labelColumn+".</span></li>"}m.tableModelView({modelName:r.modelName,columns:[C],hasSize:!0,footer:!1,pagination:{scroll:!0},useIconList:!0,recordTemplate:d,collectionClasses:r.collectionClasses||"a-RVDialog-list",selectionChange:function(){var t,i;"rv"!==e&&(i=m.tableModelView("getSelectedRecords")[0])&&(e="nav",t=u.indexOf(i),g.recordView("option","recordOffset",t),e=null)}}),I=m.data("apex-tableModelView")}else(h=s("#"+i,x).find(".nav")).grid({modelName:r.modelName,noDataMessage:r.noDataMessage,columns:[C],editable:!1,hasSize:!0,footer:!1,pagination:{scroll:!0},reorderColumns:!1,columnSort:!1,hideDeletedRows:!0,selectionChange:function(){var t,i;"rv"!==e&&(i=h.grid("getSelectedRecords")[0])&&(e="nav",t=u.indexOf(i),g.recordView("option","recordOffset",t),e=null)}}),I=h.data("apex-grid");else"tree"===E&&(s("#"+i,x).find(".nav").addClass("a-RVDialog-scroll").html("<div class='a-RVDialog-tree'></div>"),o={showRoot:!0,collapsibleRoot:!0,expandRoot:!0,getNodeAdapter:function(){return u},selectionChange:function(){var t,i,o;"rv"!==e&&(i=v.treeView("getSelectedNodes")[0])&&(o=u.parent(i),e="nav",o!==g.recordView("option","recordParent")&&g.recordView("option","recordParent",o),t=u.indexOf(i),g.recordView("option","recordOffset",t),e=null)}},(v=s("#"+i,x).find(".a-RVDialog-tree")).treeView(o),s.apex.treeView.treeModelListener(r.modelName,v),I=v.data("apex-treeView"));this.initDone=!1},open:function(){var e,t=null;R&&R.toolbar("refresh"),h&&h.grid("refreshColumns"),d.resize(),r.init&&!this.initDone&&r.init.call(this,u,h||m||v||null,g,R),this.initDone=!0,r.load&&(t=r.load.call(this,u)),"record"!==E&&(e=t?u.getRecord(t):g.recordView("getRecord"))&&setTimeout((function(){S(e)}),10),setTimeout((function(){g.recordView("focus")}),100)},close:function(){"table"===E?u.setData([],0):u.setData(null)},resize:function(){var t=F.width(),i=F.height();b?F.find("section").height(i).width(t).resize():(F.find("section,main,aside").height(i),t-=F.find("aside").outerWidth()||0,F.find("main").width(t),g.width(t),g.height(i).recordView("resize"),t=F.find("aside").width(),i-=F.find(".tb").outerHeight(),h?h.width(t).height(i).grid("resize"):v&&v.width(t).height(i),e.setOuterWidth(F.find(".tb"),t))}})).buttons=y?[{text:o.getMessage("APEX.DIALOG.CANCEL"),click:function(){g.recordView("setEditMode",!1),M(this).dialog("close")}},{text:A||o.getMessage("APEX.DIALOG.SAVE"),class:"ui-button--hot",click:function(){var e="",t=!0;g.recordView("setEditMode",!1),r.validate&&"string"==typeof(t=r.validate.call(this,u,(function(e,t){u.setValidity("valid",e,t)}),(function(e,t,i){u.setValidity("error",e,t,i)})))&&(e=t+"\n\n",t=!1),t&&!u.hasErrors()?(r.store&&r.store.call(this,u),M(this).dialog("close")):(g.recordView("refresh"),e+=apex.lang.getMessage("APEX.CORRECT_ERRORS"),apex.message.alert(e,(function(){var e,t=u.getErrors()[0];if(t){for(e in t.fields)if(t.fields[e].error)break;setTimeout((function(){g.recordView("gotoField",u.getRecordId(t.record),e)}),1)}})))}}]:[{text:A||o.getMessage("APEX.DIALOG.OK"),class:"ui-button--hot",click:function(){M(this).dialog("close")}}],d.dialogHelp&&d.buttons.unshift({text:o.getMessage("APEX.DIALOG.HELP"),class:"ui-button-help",click:function(){var e=d.dialogHelp;o.loadMessagesIfNeeded([e.titleKey,e.helpTextKey],(function(){var t={title:e.title,helpText:e.helpText};e.titleKey&&(t.title=o.getMessage(e.titleKey)),e.helpTextKey&&(t.helpText=o.getMessage(e.helpTextKey)),apex.theme.popupFieldHelp(t)}))}}),d.titleKey&&(d.title=o.getMessage(d.titleKey),delete d.titleKey),F.html(D.toString()).dialog(d).on("dialogopen",(function(){apex.navigation.beginFreezeScroll()})).on("dialogresize",(function(){M(this).closest(".ui-dialog").css("position","fixed")})).on("dialogclose",(function(){apex.navigation.endFreezeScroll()})),F.on("keydown",(function(e){var t;e.which===p.ENTER&&"INPUT"===e.target.nodeName&&(r.defaultButton&&(t=F.parent().find(".ui-button--hot").eq(0).focus(),setTimeout((function(){t.click()}),50)),e.preventDefault())})),r.useSplitter&&"record"!==E&&s.apex.splitter&&(w=r.splitterPosition||200,r.persistSplitter&&(V=apex.storage.getScopedSessionStorage({prefix:"ORA_WWV_apex.MED_"+r.persistSplitter,useAppId:!0}),w=parseInt(V.getItem("splitterPosition")||w,10)),b=F.find(".a-IGDialog-body").splitter({position:w,collapsed:!1,minSize:120,orientation:"horizontal",positionedFrom:"begin",noCollapse:!0,change:function(e,t){V&&V.setItem("splitterPosition",t.lastPosition-t.lastPosition%1+"")}}),F.on("resize",(function(t){var i,o,r,l,d=s(t.target);i=d.height(),o=d.width(),(r=d.children(".resize").filter(":visible")).length>0&&(d.children(":not(.resize)").filter(":visible").each((function(){"fixed"!==(l=s(this).css("position"))&&"absolute"!==l&&(i-=s(this).outerHeight(!0))})),i=Math.floor(i/r.length),r.each((function(){var t=s(this);e.setOuterHeight(t,i),e.setOuterWidth(t,o),t.filter(":visible").trigger("resize")}))),t.stopPropagation()})));var k=F.data("ui-dialog"),N=k._destroy;return k._destroy=function(){N.call(k),t.destroy(r.modelName)},F}}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.actions,apex.jQuery);
!function(e,t,i,n,o,a,l,r,s,d,c,u){"use strict";var h="a-IG",g="aria-hidden",p="text",m="select",f="colorpicker",_="row",C="column",I="delete",E="disabled",v="option",b="chart",w="primary",A="filter",T="highlight",R="flashback",S="aggregate",N="asc",L="last",y="none",O="N",k="_meta",V="label",M="class",D="action",x={type:"separator"},G="IN",H="BETWEEN",P="NUMBER",F="DATE",U="TIMESTAMP",B="bar",X="on",q="off",$="auto",K=[{value:"#FFFF99",label:"APEX.IG.COLOR_YELLOW"},{value:"#99FF99",label:"APEX.IG.COLOR_GREEN"},{value:"#99CCFF",label:"APEX.IG.COLOR_BLUE"},{value:"#FFDD44",label:"APEX.IG.COLOR_ORANGE"},{value:"#FF7755",label:"APEX.IG.COLOR_RED"}],W={EQ:"EQUALS",NEQ:"NOT_EQUALS",LT:"LESS_THAN",LTE:"LESS_THAN_OR_EQUALS",GT:"GREATER_THAN",GTE:"GREATER_THAN_OR_EQUALS",LIKE:"LIKE",NLIKE:"NOT_LIKE",N:"IS_NULL",NN:"IS_NOT_NULL",C:"CONTAINS",NC:"DOES_NOT_CONTAIN",IN:"IN",NIN:"NOT_IN",BETWEEN:"BETWEEN",NBETWEEN:"NOT_BETWEEN",LAST:"IN_THE_LAST",NLAST:"NOT_IN_THE_LAST",NEXT:"IN_THE_NEXT",NNEXT:"NOT_IN_THE_NEXT",REGEXP:"MATCHES_REGULAR_EXPRESSION",S:"STARTS_WITH",NS:"DOES_NOT_START_WITH",OTEXT:"ORACLE_TEXT"},Y={SUM:"SUM",AVG:"AVG",CNT:"COUNT",CNT_DIST:"COUNT_DISTINCT",APPR_CNT_DIST:"APPROX_COUNT_DISTINCT",MIN:"MIN",MAX:"MAX",MEDIAN:"MEDIAN",LISTAGG:"LISTAGG"};function z(e){return o.getMessage(e)}function j(e){return o.getMessage("APEX.IG."+e)}var Z={filter:j("FILTER"),chart:j("CHART"),groupby:j("GROUP_BY"),controlBreak:j("CONTROL_BREAK"),highlight:j("HIGHLIGHT"),aggregate:j("AGGREGATE"),flashback:j("FLASHBACK")},Q={MI:"MINUTE",H:"HOUR",D:"DAY",W:"WEEK",M:"MONTH",Y:"YEAR"},J="LABEL",ee="VALUE",te="X",ie="Y",ne="Z",oe="TARGET",ae="HIGH",le="LOW",re=(z("APEX.IG_FORMAT_SAMPLE_1"),z("APEX.IG_FORMAT_SAMPLE_2"),z("APEX.IG_FORMAT_SAMPLE_3"),z("APEX.IG_FORMAT_SAMPLE_4"),[{value:"$1,002.54",label:{style:"currency",currency:"USD",currencyDisplay:"symbol"}},{value:"1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"1,002.5400",label:{style:"decimal",maximumFractionDigits:4}},{value:"1,002",label:{style:"decimal",maximumFractionDigits:0}},{value:"1,002.54-",label:{style:"decimal",maximumFractionDigits:2}},{value:"-1,002.54",label:{style:"decimal",maximumFractionDigits:2}},{value:"<1,002.54>",label:{style:"decimal",maximumFractionDigits:2}}]),se=[{value:"DD-MON-RR",label:{pattern:"dd-MMM-yy"}},{value:"DD-MON-YYYY",label:{pattern:"dd-MMM-yyyy"}},{value:"DD-MON",label:{pattern:"dd-MMM"}},{value:"RR-MON-DD",label:{pattern:"yy-MMM-dd"}},{value:"YYYY-MM-DD",label:{pattern:"yyyy-MMM-dd"}},{value:"fmDay, fmDD fmMonth, YYYY",label:{formatType:"date",dateFormat:"full"}},{value:"DD-MON-YYYY HH24:MI",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24:MI:SS",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MIPM",label:{pattern:"dd-MMM-yyyy hh:mm a"}},{value:"Month",label:{month:"long"}},{value:"DD-MON-YYYY HH24.MI.SSXFF",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH:MI:SSXFF PM",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}},{value:"DD-MON-YYYY HH24:MI TZR",label:{pattern:"dd-MMM-yyyy HH:mm"}},{value:"DD-MON-YYYY HH24.MI.SSXFF TZR",label:{pattern:"dd-MMM-yyyy HH:mm:ss"}},{value:"DD-MON-YYYY HH.MI.SSXFF PM TZR",label:{pattern:"dd-MMM-yyyy hh:mm:ss a"}}],de=[{id:"search",groupTogether:!0,customCSS:"a-Toolbar-group--search",controls:[{type:"MENU",id:"column_filter_button",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",icon:"icon-search",iconOnly:!0,menu:{items:[{type:"toggle",action:"search-case-sensitive"},x,{type:"radioGroup",action:"filter-column"}]}},{type:"TEXT",id:"search_field",enterAction:"search"},{type:"BUTTON",action:"search"}]},{id:"reports",controls:[{type:"SELECT",action:"change-report"}]},{id:"views",controls:[{type:"RADIO_GROUP",labelKey:"APEX.IG.VIEW",action:"change-view"}]},{id:"actions1",controls:[{type:"MENU",id:"actions_button",labelKey:"APEX.IG.ACTIONS",menu:{items:[{type:D,action:"show-columns-dialog"},x,{type:D,action:"show-filter-dialog"},{type:"subMenu",id:"data_submenu",labelKey:"APEX.IG.DATA",icon:"icon-ig-data",menu:{items:[{type:D,action:"show-sort-dialog"},{type:D,action:"show-aggregate-dialog"},{type:D,action:"refresh"},{type:D,action:"show-flashback-dialog"}]}},{type:"subMenu",id:"format_submenu",labelKey:"APEX.IG.FORMAT",icon:"icon-ig-format",menu:{items:[{type:D,action:"show-control-break-dialog"},{type:D,action:"show-highlight-dialog"},{type:"toggle",action:"stretch-columns"},{type:"subMenu",labelKey:"APEX.IG.ROWS_PER_PAGE",hide:!0,id:"rows",icon:"icon-ig-rows",menu:{items:[{type:"radioGroup",action:"change-rows-per-page"}]}}]}},{type:"subMenu",id:"selection_submenu",labelKey:"APEX.IG.SELECTION",icon:"icon-ig-selection",menu:{items:[{type:"toggle",action:"selection-mode"},x,{type:D,action:"selection-copy",accelerator:"Ctrl+C"},x]}},x,{type:D,action:"chart-view"},x,{type:"subMenu",id:"save_report_submenu",labelKey:"APEX.IG.REPORT",icon:"icon-irr-saved-report",menu:{items:[{type:D,action:"save-report"},{type:D,action:"show-save-report-as-dialog"},{type:D,action:"show-edit-report-dialog"},x,{type:D,action:"delete-report"},x,{type:D,action:"reset-report"}]}},x,{type:D,action:"show-download-dialog"},x,{type:D,action:"show-help-dialog"}]}}]},{id:"actions2",controls:[{type:"TOGGLE",action:"edit"},{type:"BUTTON",hot:!0,action:"save"}]},{id:"actions3",controls:[{type:"BUTTON",action:"selection-add-row"}]},{id:"actions4",align:"end",controls:[{type:"BUTTON",action:"reset-report",labelKey:"APEX.IG.RESET",iconBeforeLabel:!0}]}];function ce(){var t,i=[];for(t=0;t<de.length;t++)i.push(e.extend(!0,{},de[t]));return i.toolbarFind=de.toolbarFind,i.toolbarRemove=de.toolbarRemove,i.toolbarInsertAfter=de.toolbarInsertAfter,i}function ue(e,t,i,n){var o,a,l,r,s,d,c=e;function u(e){var o,a;for(o=0;o<e.length;o++){if((a=e[o]).id===t||a.action===t)return i&&e.splice(o,1),n&&e.splice(o+1,0,n),a;if("subMenu"===a.type&&(a=u(a.menu.items)))return a}return null}for(o=0;o<c.length;o++){if((d=c[o]).id===t)return i&&c.splice(o,1),n&&c.splice(o+1,0,n),d;if(l=d.controls)for(a=0;a<l.length;a++){if((r=l[a]).id===t||r.action===t)return i&&l.splice(a,1),n&&l.splice(a+1,0,n),r;if(r.menu&&(s=u(r.menu.items)))return s}}return null}function he(e){return{label:e||"ENABLED",alignment:"center",defaultValue:!0,columnCssClasses:"js-colCheckbox",cellTemplate:"<span class='ro-checkbox &\"enabledClass\".'></span><span class='u-vh'>&\"enabledText\".</span>",width:80,noStretch:!0,seq:10}}function ge(e,t){e.recordView("fieldElement",t).hide()}function pe(e,t){e.recordView("fieldElement",t).show()}function me(e){return new Date(parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10)-1,parseInt(e.substr(6,2),10),parseInt(e.substr(8,2),10),parseInt(e.substr(10,2),10),parseInt(e.substr(12,2),10))}function fe(e){return("000"+e.getFullYear()).substr(-4)+("0"+(e.getMonth()+1)).substr(-2)+("0"+e.getDate()).substr(-2)+("0"+e.getHours()).substr(-2)+("0"+e.getMinutes()).substr(-2)+("0"+e.getSeconds()).substr(-2)}function _e(e){var t,i,n=[];for(t=0;t<e.length;t++)""!==(i=e[t].replace(/^\s+|\s+$/gm,""))&&-1===n.indexOf(i)&&n.push(i);return n}function Ce(e){var t=e;switch(e){case"groupby":t="group-by";break;case"savedReport":t="saved-report";break;case"inactiveSettings":t="inactive-settings";break;case"invalidSettings":t="invalid-settings";break;case"controlBreak":t="control-break";break;case"saveAsReport":case"editReport":t="save-report"}return t}function Ie(e,t,i,n,o,a){var l;for(a||t.push({value:o,label:a}),l=0;l<e.length;l++)t.push({value:e[l][i],label:e[l][n]})}function Ee(t,i){var n;if(!e.isEmptyObject(i))for(n in i)i.hasOwnProperty(n)&&t.attr("data-"+n,i[n])}function ve(t,i){var n,o=e.extend({id:"",type:p,value:"",maxChars:"",title:"",ariaDescribedBy:"",name:"",size:"",placeholder:"",readonly:!1,checked:!1,disabled:!1,required:!1,cssClasses:[],data:{},attributes:{}},i),a=o.cssClasses,l=o.attributes;if(t.markup("<input").attr("id",o.id).attr("type",o.type).attr("value",o.value).optionalAttr("maxlength",o.maxChars).optionalAttr("title",o.title).optionalAttr("aria-describedby",o.ariaDescribedBy).optionalAttr("name",o.name).optionalAttr("size",o.size).optionalAttr("placeholder",o.placeholder).optionalBoolAttr("readonly",o.readonly).optionalBoolAttr("checked",o.checked).optionalBoolAttr(E,o.disabled).optionalBoolAttr("required",o.required),a.length>0&&t.attr(M,e.isArray(a)?a.join(" "):a),Ee(t,o.data),!e.isEmptyObject(l))for(n in l)l.hasOwnProperty(n)&&t.attr(n,l[n]);t.markup(" />")}function be(t,i){ve(t,e.extend({cssClasses:"apex-item-text",maxChars:"4000"},i))}function we(i,n){var o=e("#"+i+"_list");function a(e){o.iconList("setSelection",o.find('li[data-value="'+t.escapeHTMLAttr(e)+'"]'),!1)}o.iconList({multiple:!1,selectionChange:function(){e("#"+i).val(e(this).iconList("getSelectionValues")).change()}}),a(n),e("#"+i).change((function(){a(e("#"+i).val())}))}function Ae(t,i){var n,o,a,l,r=e.extend({id:"",buttonClass:"",label:"",icon:"",iconOnly:!1,iconPosition:"right",tabindex:"",attributes:{},data:{}},i);if(n="a-Button"+(i.buttonClass?" "+i.buttonClass:""),o="a-Icon"+(i.icon?" "+i.icon:""),a=i.icon&&!i.iconOnly,t.markup("<button type='button'").optionalAttr("id",r.id).optionalAttr("tabindex",r.tabindex).attr(M,n),i.iconOnly&&r.label&&t.attr("title",r.label).attr("aria-label",r.label),!e.isEmptyObject(r.attributes))for(l in r.attributes)r.attributes.hasOwnProperty(l)&&t.attr(l,r.attributes[l]);Ee(t,r.data),t.markup(">"),a&&"left"===r.iconPosition&&t.markup("<span").attr(g,!0).attr(M,o+" a-Icon--left").markup("></span>"),i.iconOnly?t.markup("<span").attr(g,!0).attr(M,o).markup("></span>"):r.label&&t.markup("<span").attr(M,"a-Button-label").markup(">").content(r.label).markup("</span>"),a&&"right"===r.iconPosition&&t.markup("<span").attr(g,!0).attr(M,o+" a-Icon--right").markup("></span>"),t.markup("</button>")}function Te(t,i){ve(t,e.extend({type:"checkbox"},i))}function Re(t,i){var n=e.extend({cssClasses:"",text:"",data:{}},i);t.markup("<a href='#'").attr(M,n.cssClasses),Ee(t,n.data),t.markup(">").content(n.text).markup("</a>")}function Se(t,i){var n,o=e.extend({cssClasses:"u-Form-label",labelFor:"",label:"",labelHidden:!1,labelTextHidden:!1},i);n=o.cssClasses,o.labelHidden&&(n+=" u-VisuallyHidden"),t.markup("<label").attr(M,n).attr("for",o.labelFor).markup(">"),o.labelTextHidden?t.markup("<span").attr(M,"u-VisuallyHidden").markup(">").content(o.label).markup("</span>"):t.content(o.label),t.markup("</label>")}function Ne(t,i){ve(t,e.extend({type:"radio"},i))}function Le(t){var i;for(e.isArray(t)||(t=[t]),i=0;i<t.length;i++)d(t[i][0]).show()}function ye(t){var i;for(e.isArray(t)||(t=[t]),i=0;i<t.length;i++)d(t[i][0]).hide()}function Oe(e,t){e.closest(".u-Form-fieldContainer").find(".u-Form-label").text(z(t))}function ke(t,i){var n;for(e.isArray(t)||(t=[t]),n=0;n<t.length;n++)t[n].prop("required",i).closest(".u-Form-fieldContainer").toggleClass("is-required",i)}function Ve(e,i){var n,a,l,d="apexDialogPromptInputId",c=t.htmlBuilder(),u=t.getTopApex().jQuery;c.markup("<div class='u-Form u-Form--labelsAbove u-Form--stretchInputs'>").markup("<div class='u-Form-fieldContainer'><div class='u-Form-labelContainer  u-tS'><span class='u-Form-label'>"),Se(c,{labelFor:d,label:z(e.labelKey)}),c.markup("</span></div><div class='u-Form-inputContainer'>"),be(c,{id:d,value:e.value||"",required:!!e.required}),c.markup("</div></div></div>"),n=u(c.toString()),l={title:z(e.titleKey),dialogClass:"",confirm:!0,defaultButton:!0,beforeClose:function(){a=u("#"+d).val()},callback:function(e){var t=!1;e&&(t=a),i(t)},open:function(){u("#"+d).focus()}},e.okLabelKey&&(l.okLabelKey=e.okLabelKey),e.helpKey&&(l.extraButtons=[{text:z("APEX.DIALOG.HELP"),CLASS:"ui-button-help",click:function(){o.loadMessagesIfNeeded([e.helpKey,e.helpTitleKey],(function(){r.popupFieldHelp({title:z(e.helpTitleKey),helpText:z(e.helpKey)})}))}}]),s.showDialog(n,l)}de.toolbarInsertAfter=function(e,t){ue(this,e,!1,t)},de.toolbarRemove=function(e){return ue(this,e,!0)},de.toolbarFind=function(e){return ue(this,e,!1)};var Me={_allowInteraction:function(t){return e(t.target).closest(".a-IRR-sortWidget").length>0||this._super(t)}};e.ui.dialog&&(e.widget("ui.dialog",e.ui.dialog,Me),e.widget("apex.popup",e.apex.popup,Me)),e.widget("apex.interactiveGrid",{version:"19.1",widgetEventPrefix:"interactivegrid",options:{config:{toolbarData:null,modelInstanceId:null,initActions:null,columns:[],ajaxColumns:"",regionId:"",regionStaticId:"",columnGroups:[],ajaxIdentifier:"",itemsToSubmit:"",editable:!1,submitSelectedRows:!1,parentRegionStaticId:null,trackParentSelection:!0,lazyLoading:!1,filter:{row:!0,complex:!0,isRequired:!1,maxRowCount:null,oracleText:!1},appearance:{showNullValue:"",useFixedRowHeight:!0},pagination:{type:"scroll",showTotalRowCount:!1},text:{noDataFound:j("NO_DATA_FOUND"),moreDataFound:"",addRowButton:j("ADD_ROW"),help:""},toolbar:{reset:!0,save:!0,columnSelection:!0,searchField:!0,savedReports:!0,editing:!0,addRow:!0,actionMenu:!0},reportSettingsArea:{disabled:!1},features:{saveReport:{publicReportCs:"",isDeveloper:!1,authorizations:[]},download:!1,filter:!0,flashback:!0},initialSelection:!0,headingFixedTo:"page",maxHeight:null,views:{icon:!1,detail:!1,grid:{disabled:!1,features:{reorderColumns:!0,resizeColumns:!0,sort:!0,stretchColumns:null,highlight:!0,controlBreak:!0,aggregate:!0,changeRowsPerPage:!0,cellRangeActions:!0,singleRowView:!0,gridView:!0,rowSelector:{multiSelect:!0,selectAll:!0,hideControl:!1}}},chart:{disabled:!1,features:{}}},defaultModelOptions:{},defaultGridViewOptions:{},defaultIconViewOptions:{},defaultDetailViewOptions:{},defaultSingleRowOptions:{}},savedReports:[],data:null,selectionChange:null,viewChange:null,reportChange:null,reportSettingsChange:null,viewModelCreate:null,save:null,modeChange:null},_create:function(){var n,o=this,r=this.element,s=this.options,c=e(".a-IG").length;if(!s.config)throw new Error("Missing required config option.");if(!s.savedReports)throw new Error("Missing required saved reports configuration.");if(this.idPrefix=r[0].id||"ig"+(c+1),this.viewsImpl={},this.columnMap={},this.baseModelColumns={},this.primaryKeyColumns=[],this.parentColumnNames=[],this.parentItemValues=[],this.parentModel="",this.parentRecordId=null,this.editMode=!1,this.currentSavedReportIdx="",this.toolbar$=null,this.currentFilterColumnId=null,this.searchCaseSensitive=!1,this.ignoreResizeHandler=!1,this.actions=a.createContext("InteractiveGrid",r[0]),this.reportSettingsSeq=1,this.modelReportSettingsSeq={},this.isRTL="rtl"===r.css("direction"),r.addClass(h),this._defaultIGConfig(),(n=s.config).maxHeight&&r.height(n.maxHeight).css("overflow","hidden"),n.toolbar&&!n.toolbarData&&(n.toolbarData=ce()),this._defaultColumns(),this._createBaseColumnMap(),this._defaultSavedReports(),this._registerIGViews(),this._renderIG(),this._addActions(this.actions),n.initActions&&n.initActions(this.actions),n.toolbar&&(this._initToolbar(),this._updateToolbarElements()),this._forEachView((function(e,t){t.init(o)})),this._updateActions(),this.editableView=null,n.editable&&(this._forEachView((function(e,t){t.supports.edit&&(null===o.editableView?o.editableView=e:i.warn("Extra editable view ignored: "+e))})),null===this.editableView))throw new Error("No editable view for editable Interactive Grid");this.resize(),l.create(n.regionStaticId,{type:"InteractiveGrid",parentRegionId:n.parentRegionStaticId,widgetName:"interactiveGrid",refresh:function(){o.refresh()},focus:function(){o.focus()},widget:function(){return o.element},gotoError:function(e){o.gotoCell(null,e.record,e.column)},getSessionState:function(e){var t,i,n,a={beforeAsync:function(){var e=o._currentViewImpl();e.supports.edit&&e.lockActive&&e.lockActive()},afterAsync:function(){var e=o._currentViewImpl();e.supports.edit&&e.unlockActive&&e.unlockActive()}},l=[],r=[],s=o._currentViewImpl().getActiveRecordId();if(e)for(t=0;t<e.length;t++)(i=o._getColumnByStaticId(e[t]))?s&&r.push({n:i.name,v:d(e[t]).getValue()}):l.push(e[t]);return a.pageItems=l,r.length>0&&(n=o._currentViewImpl().model.getRecordMetadata(s),a.region=o._defaultAjaxRegionData({setSessionState:{values:r,protected:n.protected,salt:n.salt}})),a},alternateLoadingIndicator:function(e){var i,n=o._currentViewImpl();return"grid"===n.internalIdentifier&&!n.singleRowMode&&(i=n.view$.grid("getActiveCellFromColumnItem",e))?t.showSpinner(i,{spinnerClass:"u-Processing--cellRefresh"}):null}}),this._view(this._view(),{initialData:s.data,fetchData:n.lazyLoading}),"page"===n.headingFixedTo&&n.toolbar&&e.apex.stickyWidget&&e(".a-IG-header",r).stickyWidget({stickToEnd:!0,bottom:function(){return r.offset().top+e(".a-IG-body",r).outerHeight()-o._currentViewImpl().footerHeight()},toggleWidth:!0}),e("#"+n.regionStaticId).hasClass("resize")?r.addClass("resize").on("resize",(function(){o.resize()})):u.onElementResize(r[0],(function(){o.ignoreResizeHandler||o.resize()})),u.onVisibilityChange(r[0],(function(e){e&&(u.updateResizeSensors(r[0]),o.actions.update("search"),o.resize())})),n.parentRegionStaticId&&n.trackParentSelection&&(this._forEachView((function(e,t){t.view$&&t.setNoDataMessage(j("SELECT_1_ROW_IN_MASTER"))})),e("#"+n.parentRegionStaticId+"_ig").on("interactivegridselectionchange.ig",t.debounce((function(e,t){var i=null;1===t.selectedRecords.length?(o.actions.enable("selection-add-row"),i=t.selectedRecords[0]):o.actions.disable("selection-add-row"),o.setMasterRecord(t.model,i)}),300)))},_setOption:function(t,i){var n=!1,o=this.options;"config"===t&&(i.modelInstanceId!==o.config.modelInstanceId&&(n=!0),i=e.extend(!0,o.config,i)),this._super(t,i),n&&this._setModelInstance(o.config.modelInstanceId)},_destroy:function(){var e=this,t=this.options.config;u.offElementResize(this.element[0]),this.element.removeClass(h).empty(),a.removeContext("InteractiveGrid",this.element[0]),this._destroyAllModels(),this._forEachView((function(t,i){i.destroy(e)})),l.destroy(t.regionStaticId)},_isCurrentlyEditable:function(){var e=this.options.config,t=this._currentReportSettings().flashback,i=t&&t.isEnabled;return e.editable&&!i},_setModelInstance:function(e,t,i){var n,o=this,a=!0,l=this.options.config,r=l.text.noDataFound;if(this.parentRecordId=null,l.modelInstanceId=e,null===e&&(r=j("SELECT_1_ROW_IN_MASTER"),a=!1),l.parentRegionStaticId&&(this.parentRecordId=l.modelInstanceId,this.parentItemValues=[],t&&i))for(n=0;n<this.parentColumnNames.length;n++)this.parentItemValues.push({n:this.parentColumnNames[n],v:t.getValue(i,this.parentColumnNames[n])});this._forEachView((function(e,t){t.view$&&(t.setNoDataMessage(r),o._setModel({viewImpl:t,updateComponent:!0,fetchData:a}))}))},_setInitialSelection:function(e){var t,i,n,o=this.options.config;t=this._currentViewImpl(),o.initialSelection&&t.supports.selection&&((n=t.getSelectedRecords())&&0!==n.length||(i=t.model.recordAt(e))&&t.setSelectedRecords([i]))},_selectionChange:function(e){var t=this._currentViewImpl(),i=t.getSelectedRecords()||[];this._updateSelectionActions(),this._trigger("selectionChange",e,{selectedRecords:i,model:t.model})},_pageChange:function(e){var t=this;setTimeout((function(){t._setInitialSelection(e.offset)}),1)},_registerIGViews:function(){var e,t,n,o=this.options.config,a=0;for(e=0;e<De.length;e++)t=De[e],(n=o.views[t.internalIdentifier])&&!n.disabled&&(this._registerView(t),a+=1);0===a&&i.error("No views registered.")},_isViewRegistered:function(e){return!!this.viewsImpl[e]},_registerView:function(t){var i=this,n=e.extend(!0,{supports:{edit:!1,selection:!0,cellSelection:!1,highlight:!1,controlBreak:!1,aggregation:!1,singleRowView:!1,configurableColumns:!1,filter:!0,sort:!0,changeRowsPerPage:!0,download:!1,totalRows:!0},isConfigured:function(){return!!i._currentReportSettings().views[this.internalIdentifier]},initDialog:null,openDialog:function(){!this.dialog$&&this.initDialog&&this.initDialog(i),this.dialog$.dialog("open")},clearModelData:function(){this.model.getOption("parentModel")&&!this.model.getOption("parentRecordId")||(i.modelReportSettingsSeq[this.model.modelId()]=i.reportSettingsSeq,this.model.clearData())},setColumnConfig:function(){},init:function(){},updateActions:function(){},initView:function(){},viewChanged:function(){},setReportOptions:function(){},destroyView:function(){},destroy:function(){},getSelectedRecords:function(){return[]},setSelectedRecords:function(){},getActiveRecordId:function(){return null},getContextRecord:function(){return[]},gotoCell:null,selectCells:null,getColumns:null,canCopy2Clipboard:function(){return!1},setModelName:function(){},setEditMode:function(e){},finishEditing:null,setNoDataMessage:function(e){},focus:function(){},refreshColumns:function(){},footerHeight:function(){return 0},refresh:function(){},resize:function(){},show:function(){this.view$.show()},hide:function(){this.view$.hide()}},t);n.model=null,n.modelName=null,n.modelColumns=null,n.view$=null,n.elementId=n.internalIdentifier+"_vc",this.viewsImpl[n.internalIdentifier]=n},_forEachView:function(e){var t;for(t in this.viewsImpl)this.viewsImpl.hasOwnProperty(t)&&e(t,this.viewsImpl[t])},_getPaginationConfig:function(t,i){var n={},o=t.pagination;return i&&t[i].pagination&&(n=e.extend({},t[i].pagination)),n.scroll=o.type===y||"scroll"===o.type,n.hasOwnProperty("showPageLinks")||(n.showPageLinks="set"===o.type&&o.showTotalRowCount),n.hasOwnProperty("firstAndLastButtons")||(n.firstAndLastButtons="set"===o.type&&o.showTotalRowCount),n.hasOwnProperty("showRange")||(n.showRange=!0),n},_renderDialogContent:function(e){var i,n=this,o=t.htmlBuilder();i=function(e,t){n._renderColumnItem(o,e,t)},o.markup("<div").attr(M,"a-GV-columnItemContainer u-vh").attr(g,!0).markup(">"),e(i,o),o.markup("</div>"),this.element.append(o.toString())},_createDialog:function(t,i,n){var o,a,l,r,s,d,c,u,h=e.extend(!0,{width:600,height:380,labelAlignment:"start",formCssClasses:"u-Form--labelsAbove u-Form--stretchInputs",useSplitter:!0,splitterPosition:280,persistSplitter:t,noDataMessage:j("NO_DATA_FOUND"),modelOptions:{shape:"record",editable:!0,onlyMarkForDelete:!1,identityField:"id"}},n);for(o in s=(t+="Dialog")+"$",d=this._getId(t.replace(/[A-Z]/g,(function(e){return"_"+e.toLowerCase()}))),(r=h.dialogHelp)||(h.dialogHelp=r={}),r.helpTextKey="APEX.IG.HELP."+(r.helpTextKey||h.titleKey),r.titleKey=r.titleKey?"APEX.IG.HELP."+r.titleKey:r.helpTextKey+"_TITLE",h.titleKey="APEX.IG."+h.titleKey,h.modelName=h.modelName?this._getId(h.modelName):d,a=h.modelOptions.fields)a.hasOwnProperty(o)&&((l=a[o]).label&&(l.label=j(l.label),l.heading||"table"!==h.modelOptions.shape||(l.heading=l.label)),l.elementId&&(l.elementId=this._getId(l.elementId)));return n.checkboxColumn&&(u=h.init,h.init=function(t,i,n){i.on("click",".js-colCheckbox",(function(){var n=e(this),o=i.grid("getRecords",[n.parent()])[0],a=!t.getValue(o,"isEnabled");t.setValue(o,"enabledClass",a?"is-checked":""),t.setValue(o,"enabledText",j(a?"ENABLED":"DISABLED")),t.setValue(o,"isEnabled",a)})).on("keydown",".js-colCheckbox",(function(t){t.which===e.ui.keyCode.SPACE&&e(this).trigger("click")})),ge(n,"isEnabled"),u.call(this,t,i,n)},a.enabledClass={volatile:!0,canHide:!1,hidden:!0,seq:0,defaultValue:"is-checked"},a.enabledText={volatile:!0,canHide:!1,hidden:!0,seq:0,defaultValue:j("ENABLED")}),this._renderDialogContent(i),c=e.apex.recordView.createModelEditDialog(d,h),n.viewDialog||(this[s]=c),c},_renderColumnItem:function(t,i,n){switch(t.markup("<div").attr(M,"a-GV-columnItem").markup(">"),n.id&&(n.id=this._getId(n.id)),i){case"checkbox":Te(t,n);break;case m:!function(t,i){var n,o,a=e.extend({id:"",cssClasses:"apex-item-select",size:"1",title:"",required:!1,options:[]},i);for(t.markup("<select").optionalAttr("id",a.id).attr(M,a.cssClasses).attr("size",a.size).optionalAttr("title",a.title).optionalBoolAttr("required",a.required).markup(">"),n=0;n<a.options.length;n++)o=a.options[n],t.markup("<option").attr("value",o.value).optionalBoolAttr("selected",o.isSelected).markup(">").content(o.label||o.value).markup("</option>");t.markup("</select>")}(t,n);break;case p:be(t,n);break;case"textarea":!function(t,i){var n=e.extend({id:"",cssClasses:"apex-item-textarea",cols:"30",rows:"4",name:"",placeholder:"",disabled:!1,readonly:!1,required:!1,toolbar:!1,style:"resize: both;",wrap:"virtual"},i);n.toolbar&&(t.markup("<fieldset ").attr("id",i.id+"_fieldset").markup(">"),t.markup("<div").attr("id",n.id+"_toolbar").markup("></div>")),t.markup("<textarea").attr("id",n.id).attr(M,n.cssClasses).attr("cols",n.cols).attr("rows",n.rows).optionalAttr("name",n.name).optionalAttr("placeholder",n.placeholder).optionalAttr("style",n.style).optionalAttr("wrap",n.wrap).optionalBoolAttr(E,n.disabled).optionalBoolAttr("readonly",n.readonly).optionalBoolAttr("required",n.required).markup(">").markup("</textarea>"),n.toolbar&&t.markup("</fieldset>")}(t,n);break;case"radios":!function(t,i){var n,o,a,l=e.extend({id:"",label:"",name:"",radios:[]},i);for(t.markup("<div role='group'").attr("id",l.id).attr("aria-labelledby","id1").markup(">"),n=0;n<l.radios.length;n++)o=l.radios[n],a=l.id+"_"+n,Ne(t,{name:l.name,id:a,value:o.value,checked:o.checked,cssClasses:"a-IGDialog-input-checkbox"}),Se(t,{labelFor:a,cssClasses:"a-IGDialog-label-checkbox",label:o.label});t.markup("</div>")}(t,n);break;case f:n.colorMenu&&(n.colorMenuId=this._getId("color_menu")),function(t,i){t.markup("<fieldset ").attr(M,"color_picker").attr("id",i.id+"_fieldset").markup(">"),t.markup("<span ").attr(M,"a-Combobox-wrapper").attr("style","height: 24px").markup(">"),be(t,e.extend({cssClasses:"color_picker "},i)),Ae(t,{id:i.id+"_PICKER",buttonClass:"a-Button--noLabel a-Button--withIcon js-menuButton",label:o.formatMessage("APEX.IG.OPEN_COLORPICKER",i.itemLabel),icon:"icon-color-picker",iconOnly:!0,attributes:{"aria-haspopup":!0,"aria-expanded":!1}}),i.colorMenuId&&Ae(t,{id:i.id+"_COLORS",buttonClass:"a-Button--noLabel a-Button--withIcon js-menuButton",label:j("COLORS"),attributes:{"data-menu":i.colorMenuId,"aria-haspopup":!0,"aria-expanded":!1}}),t.markup("</span>"),t.markup("</fieldset>")}(t,n);break;case"iconList":!function(t,i){var n,o,a=e.extend({id:"",iconOnly:!1,cssClasses:"",options:[]},i);for(t.markup("<fieldset ").attr(M,"a-IGDialog-iconList").attr("id",a.id+"_fieldset").markup(">"),t.markup("<ul ").attr(M,"a-IGDialog-iconList "+a.cssClasses).attr("id",a.id+"_list").markup(">"),n=0;n<a.options.length;n++)o=a.options[n],t.markup("<li").attr("data-value",o.value).attr(M,"a-IGDialog-iconList-item"+(o.isSelected?" is-selected":"")).markup(">").markup("<span ").attr(M,"a-IGDialog-iconList-link").attr("aria-label",o.label||o.value).attr("title",o.label||o.value).markup(">").markup("<span ").attr(M,"a-IGDialog-iconList-icon a-Icon "+o.iconCssClasses).attr(g,!0).markup("></span>"),!1===a.iconOnly&&t.markup("<span ").attr(M,"a-IGDialog-iconList-label").markup(">").content(o.label||o.value).markup("</span>"),t.markup("</span>").markup("</li>");t.markup("</ul>"),t.markup("<input ").attr("type","hidden").attr(g,!0).attr("id",a.id).markup(">"),t.markup("</fieldset>")}(t,n)}t.markup("</div>")},_renderReportSettingsDialog:function(){var t,i=[],n=[],o=this.options.config,a=o.features.saveReport.isDeveloper,l=this;a&&(i.push({value:w,label:j("PRIMARY")}),i.push({value:"alternative",label:j("ALTERNATIVE")})),i.push({value:"private",label:j("SAVED_REPORT_PRIVATE")}),o.features.saveReport.publicReportCs&&i.push({value:"public",label:j("SAVED_REPORT_PUBLIC")}),Ie(o.features.saveReport.authorizations,n,"r","d","",j("SELECT")),this._createDialog("reportSettings",(function(e){e(m,{id:"SRD_TYPE",options:i}),e(p,{id:"SRD_NAME"}),e(m,{id:"SRD_AUTHORIZATION",options:n})}),{height:350,titleKey:"REPORT",defaultButton:!0,modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"SRD_TYPE",seq:10,defaultValue:"named"},name:{label:"NAME",elementId:"SRD_NAME",seq:20},authorizationId:{label:"AUTHORIZATION",elementId:"SRD_AUTHORIZATION",seq:30}}},load:function(i){var n,o=e(this),r=o.dialog(v,"saveAs"),s=e.extend({id:"",type:"",name:"",authorizationId:""},l._currentReportSettings());return n=r?"REPORT_SAVE_AS":"REPORT_EDIT",o.dialog(v,"title",j(n)),t=s.type,r&&(s.name="",(a||e.inArray(s.type,[w,"alternative"])>-1)&&(s.type="private")),i.setData(s),l._report()},init:function(i,n,o){var a=l._getElement("SRD_TYPE"),r=l._getElement("SRD_NAME"),s=l._getElement("SRD_AUTHORIZATION"),d=e(this);function c(){var e,i;switch(i=d.dialog(v,"saveAs")&&t===w,a.find("option[value="+w+"]").prop(E,i),e=a.val(),a.prop(E,!1),ke(r,!0),ye(s),e){case w:t===w&&a.prop(E,!0),ke(r,!1);break;case"alternative":Le(s)}}a.change(c),o.on("apexbeginrecordedit",c)},store:function(t){var i=e(this).dialog(v,"saveAs"),n=t.getRecord();i?(n.baseReportId=n.id,l.addReport(n)):l.updateReport(n.id,n),l._updateReportSettingsActions()}})},_renderDownloadDialog:function(){var t=this,i=j("MAILADDRESSES_COMMASEP"),n=this.options.config.features.download,o=[],a=[],l=[];n&&-1!==n.formats.indexOf("CSV")&&o.push({value:"CSV",label:j("FORMAT_CSV"),iconCssClasses:"icon-ig-dl-xls"}),n&&-1!==n.formats.indexOf("HTML")&&o.push({value:"HTML",label:j("FORMAT_HTML"),iconCssClasses:"icon-ig-dl-html"}),n&&-1!==n.formats.indexOf("PDF")&&(o.push({value:"PDF",label:j("FORMAT_PDF"),iconCssClasses:"icon-ig-dl-pdf"}),a=[{value:"LETTER",label:j("PRINT_PAGE_SIZE.LOV.LETTER.D")},{value:"LEGAL",label:j("PRINT_PAGE_SIZE.LOV.LEGAL.D")},{value:"TABLOID",label:j("PRINT_PAGE_SIZE.LOV.TABLOID.D")},{value:"A4",label:j("PRINT_PAGE_SIZE.LOV.A4.D")},{value:"A3",label:j("PRINT_PAGE_SIZE.LOV.A3.D")}],n&&n.print&&"CUSTOM"===n.print.paperSize&&a.unshift({value:"CUSTOM",label:j("PRINT_PAGE_SIZE.LOV.CUSTOM.D")}),l=[{value:"VERTICAL",label:j("PRINT_ORIENTATION.LOV.VERTICAL.D")},{value:"HORIZONTAL",label:j("PRINT_ORIENTATION.LOV.HORIZONTAL.D")}]),n&&-1!==n.formats.indexOf("XLSX")&&o.push({value:"XLSX",label:j("FORMAT_XLSX"),iconCssClasses:"icon-ig-dl-xls"}),this._createDialog("download",(function(e){e("iconList",{id:"DL_DOWNLOAD_FORMAT",options:o}),e(m,{id:"DL_PRINT_PAGE_SIZE",options:a}),e(m,{id:"DL_PRINT_ORIENTATION",options:l}),e("checkbox",{id:"DL_PRINT_ACCESSIBLE",value:"Y"}),e("checkbox",{id:"DL_PLAIN",value:"Y"}),e("checkbox",{id:"DL_SEND_AS_EMAIL",value:O}),e(p,{id:"DL_EMAIL_TO",placeholder:i}),e(p,{id:"DL_EMAIL_CC",placeholder:i}),e(p,{id:"DL_EMAIL_BCC",placeholder:i}),e(p,{id:"DL_EMAIL_SUBJECT"}),e("textarea",{id:"DL_EMAIL_BODY"})}),{height:500,titleKey:"DOWNLOAD",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},format:{label:"DOWNLOAD_FORMAT",elementId:"DL_DOWNLOAD_FORMAT",seq:10},plain:{label:"DOWNLOAD_PLAIN",elementId:"DL_PLAIN",seq:200},sendOrDownload:{label:"SEND_AS_EMAIL",elementId:"DL_SEND_AS_EMAIL",seq:200},emailTo:{label:"EMAIL_TO",elementId:"DL_EMAIL_TO",seq:210},emailCc:{label:"EMAIL_CC",elementId:"DL_EMAIL_CC",seq:220},emailBcc:{label:"EMAIL_BCC",elementId:"DL_EMAIL_BCC",seq:230},emailSubject:{label:"EMAIL_SUBJECT",elementId:"DL_EMAIL_SUBJECT",seq:240},emailBody:{label:"EMAIL_BODY",elementId:"DL_EMAIL_BODY",seq:250},sendEmail:{canHide:!1,hidden:!0,seq:0},printPageSize:{label:"PRINT_PAGE_SIZE.PROMPT",elementId:"DL_PRINT_PAGE_SIZE",seq:100,fieldColSpan:6},printOrientation:{label:"PRINT_ORIENTATION.PROMPT",elementId:"DL_PRINT_ORIENTATION",seq:110,fieldColSpan:6},printAccessible:{label:"PRINT_ACCESSIBLE.PROMPT",elementId:"DL_PRINT_ACCESSIBLE",seq:120}}},load:function(e){var t,i,o;n&&n.formats.length>0&&(t=n.formats[0]),o=n&&n.print&&n.print.paperSize||"LETTER",i=n&&n.print&&n.print.orientation||"VERTICAL",e.setData({id:0,format:t,plain:O,sendEmail:O,printOrientation:i,printPageSize:o,printAccessible:O})},init:function(i,n,o){var a,l,r=t._getElement("DL_DOWNLOAD_FORMAT"),s=t._getElement("DL_SEND_AS_EMAIL"),d=t._getElement("DL_EMAIL_TO"),c=t._getElement("DL_EMAIL_CC"),u=t._getElement("DL_EMAIL_BCC"),h=t._getElement("DL_EMAIL_SUBJECT"),g=t._getElement("DL_EMAIL_BODY"),p=t._getElement("DL_PRINT_PAGE_SIZE"),m=t._getElement("DL_PRINT_ORIENTATION"),f=t._getElement("DL_PRINT_ACCESSIBLE"),_=e(this),C=_.dialog(v,"buttons");function I(){!0===s.prop("checked")?(Le([d,c,u,h,g]),ke([d,h],!0),C[a].text=j("SEND_AS_EMAIL"),_.dialog(v,"buttons",C),null!==o.recordView("getRecord")&&i.setValue(o.recordView("getRecord"),"sendEmail","Y")):(ye([d,c,u,h,g]),ke([d,h],!1),C[a].text=j("DOWNLOAD"),_.dialog(v,"buttons",C),null!==o.recordView("getRecord")&&i.setValue(o.recordView("getRecord"),"sendEmail",O))}for(l=0;l<C.length;l++)if(C[l].text===z("APEX.DIALOG.SAVE")){a=l;break}o.on("apexbeginrecordedit",(function(){var n=r.val();we(t._getId("DL_DOWNLOAD_FORMAT"),n),I(),!0===t.options.config.features.download.email?s.change(I):ye(s),r.change((function(t,n){i.setValue(o.recordView("getRecord"),"format",e(this).val()),"PDF"===e(this).val()?Le([p,m,f]):ye([p,m,f])}))}))},store:function(e){var i,n=e.getRecord();i={format:n.format,plain:"Y"===n.plain},"Y"===n.sendEmail&&(i.email={to:n.emailTo,subject:n.emailSubject},n.emailCc&&""!==n.emailCc&&(i.email.cc=n.emailCc),n.emailBcc&&""!==n.emailBcc&&(i.email.bcc=n.emailBcc),n.emailBody&&""!==n.emailBody&&(i.email.body=n.emailBody)),"PDF"===n.format&&(i.print={pageSize:n.printPageSize,orientation:n.printOrientation,accessible:"Y"===n.printAccessible}),t._downloadReport(i)}})},_columnFilterModelFields:function(e){var t=e+"_";return{type:{label:t+"TYPE",elementId:t+"TYPE",seq:100,canHide:!0,hidden:!0,defaultValue:C},columnId:{label:"COLUMN",elementId:t+"COLUMN",seq:120,fieldColSpan:6,canHide:!0,hidden:!0},operator:{label:"OPERATOR",elementId:t+"OPERATOR",seq:130,fieldColSpan:6,canHide:!0,hidden:!0,defaultValue:"EQ"},value:{label:"VALUE",elementId:t+"VALUE",seq:140,canHide:!0,hidden:!0},dateRangeValue:{label:"VALUE",elementId:t+"DATE_RANGE_VALUE",seq:141,fieldColSpan:6,canHide:!0,hidden:!0},dateRangeUnit:{label:"UNIT",elementId:t+"DATE_RANGE_UNIT",seq:142,fieldColSpan:6,canHide:!0,hidden:!0},isCaseSensitive:{label:"CASE_SENSITIVE",elementId:t+"CASE_SENSITIVE",seq:150,canHide:!0,hidden:!0,defaultValue:"N"},between:{label:"VALUE",elementId:t+"BETWEEN",seq:160,fieldColSpan:6,canHide:!0,hidden:!0},and:{label:"AND",elementId:t+"AND",seq:170,fieldColSpan:6,canHide:!0,hidden:!0},expression:{label:"EXPRESSION",elementId:t+"EXPRESSION",seq:180,canHide:!0,hidden:!0},hiddenValue:{seq:999,canHide:!0,hidden:!0},hiddenBetween:{seq:999,canHide:!0,hidden:!0},hiddenAnd:{seq:999,canHide:!0,hidden:!0}}},_renderSortControls:function(e,t){e(m,{id:t+"DIRECTION",required:!0,options:[{value:N,label:j("ASCENDING")},{value:"desc",label:j("DESCENDING")}]}),e(m,{id:t+"NULLS",required:!0,options:[{value:"first",label:j("FIRST")},{value:L,label:j("LAST")}]})},_columnFilterDialogControls:function(e,t){var i,n,o=[],a=this.options.config.columns,l=t+"_";for(i=0;i<a.length;i++)n=a[i],("FD"===t&&this._isColumnFilterable(n.id)||"HD"===t&&!this._getColumn(n.id).specialType&&!this._getColumn(n.id).isHidden)&&o.push({value:n.id,label:this._getColumnLabel(n.id)});e(m,{id:l+"TYPE",options:[{value:_,label:j("ROW")},{value:C,label:j("COLUMN")}]}),e(m,{id:l+"COLUMN",options:o}),e(m,{id:l+"OPERATOR",options:[]}),e(p,{maxChars:4e3,id:l+"VALUE"}),e(p,{maxChars:20,id:l+"DATE_RANGE_VALUE"}),e(m,{id:l+"DATE_RANGE_UNIT",options:[{value:"MI",label:j("MINUTES")},{value:"H",label:j("HOURS")},{value:"D",label:j("DAYS")},{value:"W",label:j("WEEKS")},{value:"M",label:j("MONTHS")},{value:"Y",label:j("YEARS")}]}),e("checkbox",{id:l+"CASE_SENSITIVE",value:"Y"}),e(p,{maxChars:100,id:l+"BETWEEN"}),e(p,{maxChars:100,id:l+"AND"}),e(p,{maxChars:40,id:l+"NAME"}),e("textarea",{id:l+"EXPRESSION",toolbar:!0})},_columnFilterInitActions:function(t,i,n,a,l){var r,s,d=this,c=a+"_",u="FD"===a,h=[],g=d._getElement(c+"TYPE"),p=d._getElement(c+"COLUMN"),m=d._getElement(c+"OPERATOR"),f=d._getElement(c+"VALUE"),I=d._getElement(c+"BETWEEN"),b=d._getElement(c+"AND"),w=d._getElement(c+"NAME"),T=d._getElement(c+"EXPRESSION"),R=d._getElement(c+"CASE_SENSITIVE"),S=d._getElement(c+"DATE_RANGE_VALUE"),N=d._getElement(c+"DATE_RANGE_UNIT");function L(){var e;u&&null!==n.recordView("getRecord")&&(e=d._shortenString(d._getSettingLabel(A,n.recordView("getRecord")),37),w.val(e).change())}function y(e){e.hasClass("a-Combobox")&&e.combobox("destroy"),e.hasClass("hasDatepicker")&&(e.parent().hasClass("a-Combobox-wrapper")&&e.unwrap(),e.datepicker("destroy")),e.attr("placeholder","")}function O(e,i){null!==n.recordView("getRecord")&&t.setValue(n.recordView("getRecord"),e,i)}function k(t){var i=g.val(),n=m.val();switch(ye([p,m,f,I,b,T,R,S,N]),u&&ye(w),O("type",i),i){case _:Le(f),d.options.config.filter.oracleText?(R.prop(E,!0),ye(R)):(R.prop(E,!1),Le(R)),Oe(f,"APEX.IG.SEARCH"),y(f),L();break;case C:Le([p,m]),Oe(f,"APEX.IG.VALUE"),e.inArray(n,[H,"NBETWEEN"])>-1?Le([I,b]):e.inArray(n,["LAST","NEXT","NLAST","NNEXT"])>-1?Le([S,N]):Le(f),V(t)}}function V(i){var l,s,u,_,w={},A=p.val();if(g.val()===C&&A){if((r=d._getColumn(A)).filter.textCase)switch(r.filter.textCase.toLowerCase()){case"upper":f.css({"text-transform":"uppercase"}),I.css({"text-transform":"uppercase"}),b.css({"text-transform":"uppercase"});break;case"lower":f.css({"text-transform":"lowercase"}),I.css({"text-transform":"lowercase"}),b.css({"text-transform":"lowercase"});break;default:f.css({"text-transform":"none"}),I.css({"text-transform":"none"}),b.css({"text-transform":"none"})}if("HD"===a)switch(r.dataType){case"VARCHAR2":w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.N=j(W.N),w.NN=j(W.NN),w.IN=j(W.IN),w.NIN=j(W.NIN),w.C=j(W.C),w.NC=j(W.NC),w.S=j(W.S),w.NS=j(W.NS),w.REGEXP=j(W.REGEXP);break;case P:w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.GT=j(W.GT),w.GTE=j(W.GTE),w.LT=j(W.LT),w.LTE=j(W.LTE),w.N=j(W.N),w.NN=j(W.NN),w.IN=j(W.IN),w.NIN=j(W.NIN),w[H]=j(W[H]),w.NBETWEEN=j(W.NBETWEEN);break;case F:case U:case"TIMESTAMP_TZ":case"TIMESTAMP_LTZ":w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.GT=j(W.GT),w.GTE=j(W.GTE),w.LT=j(W.LT),w.LTE=j(W.LTE),w.N=j(W.N),w.NN=j(W.NN),e.inArray(r.filter.dateRanges,["all","past"])>-1&&(w.LAST=j(W.LAST),w.NLAST=j(W.NLAST)),e.inArray(r.filter.dateRanges,["all","future"])>-1&&(w.NEXT=j(W.NEXT),w.NNEXT=j(W.NNEXT)),w[H]=j(W[H]),w.NBETWEEN=j(W.NBETWEEN);break;case"CLOB":w.N=j(W.N),w.NN=j(W.NN)}else for(R.prop(E,!0),s=0;s<r.filter.operators.length;s++)if("$std$"===(u=r.filter.operators[s]).name)switch(r.filter.dataType){case"VARCHAR2":w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.N=j(W.N),w.NN=j(W.NN),w.IN=j(W.IN),w.NIN=j(W.NIN);break;case P:w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.GT=j(W.GT),w.GTE=j(W.GTE),w.LT=j(W.LT),w.LTE=j(W.LTE),w.N=j(W.N),w.NN=j(W.NN),w.IN=j(W.IN),w.NIN=j(W.NIN),w[H]=j(W[H]),w.NBETWEEN=j(W.NBETWEEN);break;case F:case U:case"TIMESTAMP_TZ":case"TIMESTAMP_LTZ":w.EQ=j(W.EQ),w.NEQ=j(W.NEQ),w.GT=j(W.GT),w.GTE=j(W.GTE),w.LT=j(W.LT),w.LTE=j(W.LTE),w.N=j(W.N),w.NN=j(W.NN),e.inArray(r.filter.dateRanges,["all","past"])>-1&&(w.LAST=j(W.LAST),w.NLAST=j(W.NLAST)),e.inArray(r.filter.dateRanges,["all","future"])>-1&&(w.NEXT=j(W.NEXT),w.NNEXT=j(W.NNEXT)),w[H]=j(W[H]),w.NBETWEEN=j(W.NBETWEEN);break;case"CLOB":w.N=j(W.N),w.NN=j(W.NN)}else"$perform$"===u.name?e.inArray(r.filter.dataType,["VARCHAR2","CLOB"])>-1&&(w.C=j(W.C),w.NC=j(W.NC),w.S=j(W.S),w.NS=j(W.NS),w.REGEXP=j(W.REGEXP),r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&R.prop(E,!1)):"CASE_INSENSITIVE"===u.name?r.filter.textCase&&"MIXED"===r.filter.textCase.toUpperCase()&&R.prop(E,!1):w[u.name]=j(W[u.name]);_=t.getValue(n.recordView("getRecord"),"operator"),m.empty(),e.each(w,(function(t,i){m.append(e("<option></option>").attr("value",t).text(i))})),_&&null!==_&&e.inArray(_,w)&&m.val(_),null===m.val()&&m.val("EQ"),O("operator",m.val()),function(){var i,a,l,s;function u(t,i,n){var a,l,s,c,u,h=d._getColumnFormatMask(r.id);(a=-1!==h.toLowerCase().indexOf("hh"))&&(s=(new Date).getHours(),c="",(l=-1!==h.indexOf("HH"))||(c=s>11?"PM":"AM",0===s&&(s=12),s>12&&(s-=12))),e(t).hasClass("a-Combobox-wrapper")||e(t).wrap(e("<span class='a-Combobox-wrapper'></span>")),a?(apex.widget.datepicker(t,{buttonText:"<span class='a-Icon icon-calendar'></span><span class='u-VisuallyHidden'>"+o.formatMessage("APEX.DATEPICKER.ICON_TEXT","")+"</span>",showTime:!0,showOn:"button",defaultDate:me(n),time24h:l,defHour:("00"+s).substr(-2),defMinute:"00",defAmpm:c},h,apex.locale.getLanguage()),u=!1,n&&null!==n.match(/^\d{14}/)&&(u=me(n))&&!isNaN(u.getTime())&&apex.jQuery.timepicker.setCanonicalDate(e(t).get(0),u)):(apex.widget.datepicker(t,{buttonText:"<span class='a-Icon icon-calendar'></span><span class='u-VisuallyHidden'>"+o.formatMessage("APEX.DATEPICKER.ICON_TEXT","")+"</span>",defaultDate:me(n),showTime:!1,showOn:"button"},h,apex.locale.getLanguage()),n&&null!==n.match(/^\d{14}/)&&e(t).datepicker("setDate",me(n))),e(t).next("button").addClass("a-Button a-Button--withIcon a-Button--noLabel js-menuButton a-Button--calendar"),e(t).attr("placeholder",j("EXAMPLE")+": "+r.appearance.formatExample)}s=n.recordView("getRecord"),i=t.getValue(s,"hiddenValue"),a=t.getValue(s,"hiddenBetween"),l=t.getValue(s,"hiddenAnd"),y(f),y(I),y(b),e("#"+d._getId(c+"VALUE")+"_LABEL ").text(j("VALUE")),r.filter.dataType===F||r.filter.dataType===U||"TIMESTAMP_TZ"===r.filter.dataType||"TIMESTAMP_LTZ"===r.filter.dataType?("TIMESTAMP_TZ"===r.filter.dataType&&e("#"+d._getId(c+"VALUE")+"_LABEL ").text(j("VALUE_TIMESTAMP_TZ")),u("#"+d._getId(c+"VALUE"),0,i),u("#"+d._getId(c+"BETWEEN"),0,a),u("#"+d._getId(c+"AND"),0,l)):(f.combobox({label:j("VALUE")}),I.combobox({label:j("VALUE")}),b.combobox({label:j("AND")}),f.val(i),I.val(a),b.val(l))}(),d._hasColumnFilterLov(A)?d._getFilterValues(A,!1,(function(e){if(h=[],e.regions[0].filterValues)for(l=e.regions[0].filterValues,s=0;s<l.length;s++)h.push({label:l[s],value:l[s]});I.hasClass("a-Combobox")&&I.combobox(v,"source",h),b.hasClass("a-Combobox")&&b.combobox(v,"source",h),f.hasClass("a-Combobox")&&f.combobox(v,"source",h)})):(y(f),y(I),y(b)),O("columnId",A),i&&(f.val("").change(),I.val("").change(),b.val("").change()),M()}}function M(){var t=m.val(),i=g.val();O("operator",t),i===C&&(ye([f,I,b,S,N,R]),null!==t&&(-1===e.inArray(r.filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])&&f.hasClass("a-Combobox")&&(e.inArray(t,[G,"NIN"])>-1?(f.combobox(v,"multipleValues",!0),f.combobox(v,"multipleValueDelimiter","; "),f.prop("placeholder",o.formatMessage("APEX.IG.PLACEHOLDER_INVALUES",";"))):(f.combobox(v,"multipleValues",!1),f.prop("placeholder",""))),e.inArray(t,["C","NC","REGEXP","S","NS"])>-1&&!1===R.prop(E)&&Le(R),e.inArray(s,[H,"NBETWEEN"])>-1&&-1===e.inArray(t,[H,"NBETWEEN"])&&f.val("").change(),-1===e.inArray(s,[H,"NBETWEEN"])&&e.inArray(t,[H,"NBETWEEN"])>-1&&(I.val("").change(),b.val("").change()),e.inArray(s,["LAST","NEXT","NLAST","NNEXT"])>-1&&-1===e.inArray(t,["LAST","NEXT","NLAST","NNEXT"])&&f.val("").change(),e.inArray(t,[H,"NBETWEEN"])>-1?Le([I,b]):e.inArray(t,["LAST","NEXT","NLAST","NNEXT"])>-1?(Le([S,N]),x()):-1===e.inArray(t,["N","NN"])&&Le(f))),s=t,L()}function D(e){var i,o,a,l,r=d._getElement(c+e);if("VALUE"===e&&(i="hiddenValue"),"BETWEEN"===e&&(i="hiddenBetween"),"AND"===e&&(i="hiddenAnd"),t.setValidity("valid",n.recordView("getRecord").id,e.toLowerCase()),r.hasClass("hasDatepicker"))if(""===r.val())l="",a="";else{o=!1;try{o=r.datepicker(v,"showTime")?apex.jQuery.timepicker.getCanonicalDate(r.get(0)):r.datepicker("getDate")}catch(e){}o&&!isNaN(o.getTime())?(l=r.val(),a=fe(o)):(""!==r.val()&&t.setValidity("error",n.recordView("getRecord").id,e.toLowerCase(),j("DATE_INVALID_VALUE")),l=r.val(),a=r.val())}else"uppercase"===r.css("text-transform")?(a=r.val().toUpperCase(),l=r.val().toUpperCase()):"lowercase"===r.css("text-transform")?(a=r.val().toLowerCase(),l=r.val().toLowerCase()):(a=r.val(),l=r.val());O(i,a),O(e.toLowerCase(),l),L()}function x(){f.val(S.val()+"~"+N.val()),O("value",f.val()),O("dateRangeValue",S.val()),O("dateRangeUnit",N.val()),L()}S.change(x),N.change(x),R.change((function(){var e=R.prop("checked");O("isCaseSensitive",e),R.prop("checked",e)})),g.change((function(){k(!0)})),p.change((function(){V(!0)})),m.change(M),f.change((function(){D("VALUE")})),I.change((function(){D("BETWEEN")})),b.change((function(){D("AND")})),n.on("apexbeginrecordedit",(function(){k(),e.isFunction(l)&&l()}))},_renderFilterDialog:function(){var t=this;this._createDialog(A,(function(e){t._columnFilterDialogControls(e,"FD")}),{titleKey:"FILTERS",dialogHelp:{helpTextKey:"FILTER"},checkboxColumn:!0,modelOptions:{shape:"table",fields:e.extend({id:{canHide:!1,hidden:!0,seq:0},isEnabled:he(),name:{headingAlignment:"start",label:"NAME",elementId:"FD_NAME",width:100,seq:105}},this._columnFilterModelFields("FD"))},load:function(i){var n,o,a,l,r,s=[],d=t.getFilters(),c=e(this).dialog(v,"id");if(d.length>0){for(n=0;n<d.length;n++){switch(o=(a=e.extend({id:"",type:"",columnId:"",operator:"",value:"",hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",isCaseSensitive:!1,between:"",and:"",hiddenBetween:"",hiddenAnd:"",isEnabled:"",enabledClass:"",enabledText:"",name:"",expression:""},d[n])).isEnabled,a.enabledClass=o?"is-checked":"",a.enabledText=j(o?"ENABLED":"DISABLED"),a.name=t._getSettingLabel(A,a),a.type){case _:a.hiddenValue=a.value;break;case C:a.hiddenValue=a.value,e.inArray(a.operator,[H,"NBETWEEN"])>-1?(l=a.value.split("~"),a.hiddenBetween=l[0],a.hiddenAnd=l[1],a.hiddenValue="",a.value=""):e.inArray(a.operator,["LAST","NEXT","NLAST","NNEXT"])>-1&&(r=a.value.split("~"),a.dateRangeValue=r[0],a.dateRangeUnit=r[1],a.hiddenValue="",a.value=""),e.inArray(a.operator,[G,"NIN"])>-1&&(a.value=a.value.split("").join("; "),a.hiddenValue=a.value)}a.isCaseSensitive=a.isCaseSensitive?"Y":O,s.push(a)}i.setData(s)}else c=i.insertNewRecord();return c},init:function(e,i,n){ge(n,"hiddenValue"),ge(n,"hiddenBetween"),ge(n,"hiddenAnd"),t._columnFilterInitActions(e,i,n,"FD")},validate:function(i,n,o){var a=!0;return i.forEach((function(i,l,r){switch(n(r,"between"),n(r,"and"),n(r,"value"),n(r,"expression"),i.type){case C:switch(i.operator){case H:case"NBETWEEN":i.hiddenBetween&&""!==i.hiddenBetween||(a=!1,o(r,"between",j("VALUE_REQUIRED"))),i.hiddenAnd&&""!==i.hiddenAnd||(a=!1,o(r,"and",j("VALUE_REQUIRED"))),a&&e.inArray(t._getColumn(i.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1&&(i.hiddenBetween!==fe(me(i.hiddenBetween))&&(a=!1,o(r,"between",j("INVALID_VALUE"))),i.hiddenAnd!==fe(me(i.hiddenAnd))&&(a=!1,o(r,"and",j("INVALID_VALUE"))));break;case"LAST":case"NEXT":case"NLAST":case"NNEXT":i.dateRangeValue&&""!==i.dateRangeValue||(a=!1,o(r,"dateRangeValue",j("VALUE_REQUIRED"))),i.dateRangeUnit&&""!==i.dateRangeUnit||(a=!1,o(r,"dateRangeUnit",j("VALUE_REQUIRED")));break;case"EQ":case"NEQ":case"GT":case"GTE":case"LT":case"LTE":case G:case"NIN":i.hiddenValue&&""!==i.hiddenValue?e.inArray(t._getColumn(i.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1&&i.hiddenValue!==fe(me(i.hiddenValue))&&(a=!1,o(r,"value",j("DATE_INVALID_VALUE"))):(a=!1,o(r,"value",j("VALUE_REQUIRED")))}break;case _:i.hiddenValue&&""!==i.hiddenValue||(a=!1,o(r,"value",j("VALUE_REQUIRED")))}})),a},store:function(i){t._ifNoChangesDo((function(){var n,o,a,l={save:!1,skipNoChangesCheck:!0},r=i.getChanges();for(n=0;n<r.length;n++){switch(delete(a=(o=r[n]).record).enabledClass,delete a.enabledText,a.type){case _:delete a.expression,delete a.columnId,delete a.and,delete a.between,delete a.hiddenAnd,delete a.hiddenBetween,delete a.dateRangeValue,delete a.dateRangeUnit,delete a.operator,a.isCaseSensitive="Y"===a.isCaseSensitive;break;case C:a.value=a.hiddenValue,e.inArray(a.operator,[H,"NBETWEEN"])>-1?a.value=a.hiddenBetween+"~"+a.hiddenAnd:e.inArray(a.operator,["LAST","NEXT","NLAST","NNEXT"])>-1&&(a.value=a.dateRangeValue+"~"+a.dateRangeUnit),e.inArray(a.operator,[G,"NIN"])>-1&&(a.value=_e(a.value.split(";")).join("")),delete a.dateRangeValue,delete a.dateRangeUnit,delete a.between,delete a.and,delete a.hiddenValue,delete a.hiddenBetween,delete a.hiddenAnd,delete a.expression,a.isCaseSensitive="Y"===a.isCaseSensitive}o.inserted?(delete a.id,a.columnType=C,t.addFilter(a,l)):o.updated?(a.columnType=C,t.updateFilter(a.id,a,l)):o.deleted&&t.deleteFilter(a.id,l)}t._setReportSettings({refreshModel:!0})}))}})},_renderColumnsDialog:function(){var t=this,i=[],n=this.options.config.views[this._view()].features;function o(i){var n,o,a,l,r=[],s=t._getCurrentView().columns;function d(e){return!(e.id!==a.columnId||e.specialType&&"actions"!==e.specialType||e.isHidden)}for(n=0;n<s.length;n++)a=s[n],(o=(o=e.grep(t.options.config.columns,d)).length>0&&o[0])&&(l={id:a.columnId,columnId:a.columnId,columnWidth:a.width,seq:n+1,heading:"actions"===o.specialType?j("ROW_ACTIONS"):o.heading.label,groupId:o.layout.groupId,canHide:o.features.canHide,isVisible:a.isVisible,enabledClass:a.isVisible?"is-checked":""},"ALL"===i||"VISIBLE"===i&&a.isVisible?r.push(l):"INVISIBLE"!==i||l.isVisible||r.push(l));return r}Ie(this.options.config.columnGroups,i,"id","label","",""),this._createDialog("columns",(function(e){e(p,{id:"CD_COLUMN_WIDTH"}),e(m,{id:"CD_COLUMN_GROUP",options:i})}),{titleKey:"COLUMNS",modelOptions:{shape:"table",canDelete:!1,canAdd:!1,sequenceField:n.reorderColumns?"seq":null,fields:{id:{canHide:!1,hidden:!0,seq:0},isVisible:he("VISIBLE"),heading:{label:"COLUMN",headingAlignment:"start",elementId:"CD_COLUMN_HEADING",canHide:!0,hidden:!1,width:100,seq:20},groupId:{label:"GROUP",elementId:"CD_COLUMN_GROUP",canHide:!0,escape:!1,volatile:!0,hidden:!0,seq:30},columnWidth:{label:"WIDTH",elementId:"CD_COLUMN_WIDTH",canHide:!0,hidden:!0,seq:40},columnId:{label:"COLUMN",elementId:"CD_COLUMN",seq:0,canHide:!0,hidden:!0},seq:{canHide:!1,hidden:!0,seq:0},canHide:{canHide:!1,hidden:!0,seq:0},enabledClass:{volatile:!0,canHide:!1,hidden:!0,defaultValue:"is-checked",seq:0}}},load:function(e){e.setData(o(this.showColumns))},init:function(t,i,n,l){var r,s=this;this.showColumns||(this.showColumns="ALL"),r=[{type:"BUTTON",iconOnly:!0,icon:"icon-up-chevron",action:"move-up"},{type:"BUTTON",iconOnly:!0,icon:"icon-down-chevron",action:"move-down"},{type:"MENU",labelKey:"APEX.IG.SHOW",icon:"icon-ig-select-cols",iconOnly:!0,menu:{items:[{type:"radioGroup",action:"show-columns"}]}}],a.findContext("ModelEditDialog",this).add([{name:"show-columns",choices:[{label:j("ALL"),value:"ALL"},{label:j("VISIBLE"),value:"VISIBLE"},{label:j("INVISIBLE"),value:"INVISIBLE"}],get:function(){return s.showColumns},set:function(e){s.showColumns=e;var i=o(e);t.setData(i)}}]),l.toolbar({data:[{align:"start",controls:r}]}),i.on("click",".js-colCheckbox",(function(){var n,o,a=e(this);o=i.grid("getRecords",[a.parent()])[0],t.getValue(o,"canHide")&&(n=!t.getValue(o,"isVisible"),t.setValue(o,"enabledClass",n?"is-checked":""),t.setValue(o,"isVisible",n))})).on("keydown",".js-colCheckbox",(function(t){t.which===e.ui.keyCode.SPACE&&e(this).trigger("click")})),n.on("apexbeginrecordedit",(function(){""===t.getValue(n.recordView("getRecord"),"groupId")?ge(n,"groupId"):pe(n,"groupId")})),ge(n,"columnId"),ge(n,"isVisible")},validate:function(e,t,i){var n,o=!0;return e.forEach((function(e,a,l){null!==(n=e.columnWidth)&&""!==n&&isNaN(parseInt(n,10))?(i(l,"columnWidth",j("INVALID_VALUE")),o=!1):t(l,"columnWidth")})),o},store:function(e){var i,n,o,a=!1,l=t._getCurrentView().columns,r=t._currentViewImpl().getColumns();for(l.sort((function(e,t){return e.seq-t.seq})),i=0;i<l.length;i++)!0===l[i].isFrozen&&(a=i+1);for(e.forEach((function(e){(o=e.columnWidth)&&null!==o||(o=""),o=o.toString(),t._currentViewColumn(e.columnId,{isVisible:e.isVisible,width:parseInt(o,10),seq:parseFloat(e.seq)})})),l.sort((function(e,t){return e.seq-t.seq})),i=0;i<l.length;i++)for(n=0;n<r.length;n++)if(l[i].columnId===r[n].id){r[n].seq=l[i].seq,r[n].canHide&&(r[n].hidden=!l[i].isVisible),r[n].width=l[i].width,l[i].seq=i,!1!==a&&i>=a&&(l[i].isFrozen=!1,r[n].frozen=!1),!1!==a&&i<a&&(l[i].isFrozen=!0,r[n].frozen=!0);break}t._setReportSettings({refreshView:!0,refreshColumns:!0})}})},_renderHighlightDialog:function(){var t,i,n=this,o=this.options.config.columns,a=[];for(i=0;i<o.length;i++)t=o[i],this._getColumn(t.id).specialType||this._getColumn(t.id).isHidden||a.push({value:t.id,label:this._getColumnLabel(t.id)});this._createDialog(T,(function(e){n._columnFilterDialogControls(e,"HD"),e(f,{id:"HD_BACKGROUND_COLOR",colorMenu:!0,itemLabel:j("BACKGROUND_COLOR")}),e(f,{id:"HD_TEXT_COLOR",colorMenu:!0,itemLabel:j("TEXT_COLOR")}),e(m,{id:"HD_HIGHLIGHT_TYPE",options:[{value:_,label:j("ROW")},{value:C,label:j("COLUMN")}]}),e(m,{id:"HD_HIGHLIGHT_COLUMN",options:a})}),{width:800,height:580,titleKey:"HIGHLIGHT",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"seq",fields:e.extend({id:{canHide:!1,hidden:!0,seq:0},seq:{canHide:!1,hidden:!0,seq:0},isEnabled:he(),name:{label:"NAME",headingAlignment:"start",elementId:"HD_NAME",isRequired:!0,width:100,seq:15},highlightType:{label:"HIGHLIGHT",elementId:"HD_HIGHLIGHT_TYPE",seq:20,canHide:!0,hidden:!0},highlightColumnId:{label:"COLUMN",elementId:"HD_HIGHLIGHT_COLUMN",seq:30,canHide:!0,hidden:!0},backgroundColor:{label:"BACKGROUND_COLOR",elementId:"HD_BACKGROUND_COLOR",seq:40,fieldColSpan:6,canHide:!0,hidden:!0},textColor:{label:"TEXT_COLOR",elementId:"HD_TEXT_COLOR",seq:50,fieldColSpan:6,canHide:!0,hidden:!0}},this._columnFilterModelFields("HD"))},load:function(t){var i,o,a,l,r,s=[],d=n.getHighlights(),c=e(this).dialog(v,"id");if(d.length>0){for(i=0;i<d.length;i++){switch((l={id:(r=d[i]).id,seq:r.seq,name:r.name,highlightType:r.type,highlightColumnType:r.columnType,highlightColumnId:r.columnId,backgroundColor:r.backgroundColor,textColor:r.textColor,type:r.condition.type,columnType:r.condition.columnType,columnId:r.condition.columnId,operator:r.condition.operator,isCaseSensitive:r.condition.isCaseSensitive?"Y":O,value:r.condition.value,expression:r.condition.expression,isEnabled:r.isEnabled,hiddenValue:"",dateRangeValue:"",dateRangeUnit:"",between:"",and:"",hiddenBetween:"",hiddenAnd:"",enabledClass:"",enabledText:""}).enabledClass=l.isEnabled?"is-checked":"",l.enabledText=l.isEnabled?j("ENABLED"):j("DISABLED"),l.hiddenValue=l.value,l.type){case C:e.inArray(l.operator,[H,"NBETWEEN"])>-1?(o=l.value.split("~"),l.hiddenBetween=o[0],l.hiddenAnd=o[1],l.hiddenValue="",l.value=""):e.inArray(l.operator,["LAST","NEXT","NLAST","NNEXT"])>-1&&(a=l.value.split("~"),l.dateRangeValue=a[0],l.dateRangeUnit=a[1],l.hiddenValue="",l.value=""),e.inArray(l.operator,[G,"NIN"])>-1&&(l.value=l.value.split("").join("; "),l.hiddenValue=l.value)}s.push(l)}t.setData(s)}else c=t.insertNewRecord();return c},init:function(t,i,o){var a,l=n._getElement("HD_HIGHLIGHT_TYPE"),r=n._getElement("HD_HIGHLIGHT_COLUMN"),s=n._getElement("HD_TEXT_COLOR"),c=n._getElement("HD_BACKGROUND_COLOR"),u=n._getElement("HD_NAME"),h=[];function g(t,i){e(i).prevAll("input").first().val(this.value).change()}for(apex.widget.colorpicker(s,{preview:{type:"modern"}}),apex.widget.colorpicker(c,{preview:{type:"modern"}}),a=0;a<K.length;a++)h.push({type:D,action:g,label:z(K[a].label),icon:"a-Icon icon-circle",iconStyle:"color: "+K[a].value+";",value:K[a].value});function p(){var e=l.val(),t=d(r.attr("id"));e===_?ye(r):(Le(r),t.setValue(t.getValue()))}e("<div/>",{id:n._getId("color_menu")}).appendTo(this).menu({actionsContext:n.actions,items:h}),ke(u,!0),ge(o,"hiddenValue"),ge(o,"hiddenBetween"),ge(o,"hiddenAnd"),n._columnFilterInitActions(t,i,o,"HD",(function(){p(),s.change(),c.change()})),l.change(p)},validate:function(t,i,o){var a=!0;return t.forEach((function(t,l,r){switch(i(r,"between"),i(r,"and"),i(r,"value"),i(r,"expression"),i(r,"name"),i(r,"textColor"),i(r,"backgroundColor"),""===t.textColor&&""===t.backgroundColor&&(o(r,"textColor",j("VALUE_REQUIRED")),o(r,"backgroundColor",j("VALUE_REQUIRED"))),""===t.name&&o(r,"name",j("VALUE_REQUIRED")),t.type){case C:switch(t.operator){case H:case"NBETWEEN":t.hiddenBetween&&""!==t.hiddenBetween||(a=!1,o(r,"between",j("VALUE_REQUIRED"))),t.hiddenAnd&&""!==t.hiddenAnd||(a=!1,o(r,"and",j("VALUE_REQUIRED"))),a&&e.inArray(n._getColumn(t.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1&&(t.hiddenBetween!==fe(me(t.hiddenBetween))&&(a=!1,o(r,"between",j("INVALID_VALUE"))),t.hiddenAnd!==fe(me(t.hiddenAnd))&&(a=!1,o(r,"and",j("INVALID_VALUE"))));break;case"LAST":case"NEXT":case"NLAST":case"NNEXT":t.dateRangeValue&&""!==t.dateRangeValue||(a=!1,o(r,"dateRangeValue",j("VALUE_REQUIRED"))),t.dateRangeUnit&&""!==t.dateRangeUnit||(a=!1,o(r,"dateRangeUnit",j("VALUE_REQUIRED")));break;case"EQ":case"NEQ":case"GT":case"GTE":case"LT":case"LTE":case G:case"NIN":t.hiddenValue&&""!==t.hiddenValue?e.inArray(n._getColumn(t.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1&&t.hiddenValue!==fe(me(t.hiddenValue))&&(a=!1,o(r,"value",j("DATE_INVALID_VALUE"))):(a=!1,o(r,"value",j("VALUE_REQUIRED")))}break;case _:t.hiddenValue&&""!==t.hiddenValue||(a=!1,o(r,"value",j("VALUE_REQUIRED")))}})),a},store:function(t){n._ifNoChangesDo((function(){var i,o,a,l,r,s={save:!1,skipNoChangesCheck:!0},d=t.getChanges();for(i=0;i<d.length;i++){switch((l=(o=d[i]).record).type){case _:r={type:_,value:l.value,isCaseSensitive:"Y"===l.isCaseSensitive};break;case C:r={type:C,value:l.hiddenValue,columnId:l.columnId,operator:l.operator,columnType:C,isCaseSensitive:"Y"===l.isCaseSensitive},e.inArray(l.operator,[G,"NIN"])>-1&&(r.value=_e(l.hiddenValue.split(";")).join("")),e.inArray(l.operator,[H,"NBETWEEN"])>-1?r.value=l.hiddenBetween+"~"+l.hiddenAnd:e.inArray(l.operator,["LAST","NEXT","NLAST","NNEXT"])>-1&&(r.value=l.dateRangeValue+"~"+l.dateRangeUnit)}a={id:l.id,seq:parseFloat(l.seq),name:l.name,type:l.highlightType,textColor:l.textColor,backgroundColor:l.backgroundColor,condition:r,isEnabled:l.isEnabled},l.highlightType===C?(a.type=C,a.columnType=C,a.columnId=l.highlightColumnId):l.highlightType===_&&(a.type=_,delete a.columnType,delete a.columnId),o.inserted?(delete a.id,n.addHighlight(a,s)):o.updated?n.updateHighlight(a.id,a,s):o.deleted&&n.deleteHighlight(a.id,s)}n._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.highlights"})}))}})},_loadColumnOptions:function(e,t){var i,n,o,a=this.options.config.columns;for(e.push({value:"",label:j("SELECT")}),i=0;i<a.length;i++)(o=a[i]).specialType||!o.features[t]||o.isHidden||(n||(n=o),e.push({value:o.id,label:this._getColumnLabel(o.id)}));return n},_renderSortDialog:function(){var e=[],t=this;this._loadColumnOptions(e,"sort"),this._createDialog("sort",(function(i){i(m,{id:"SD_COLUMN",required:!0,options:e}),t._renderSortControls(i,"SD_")}),{titleKey:"SORT",modelOptions:{shape:"table",identityField:"order",sequenceField:"seq",fields:{order:{canHide:!1,hidden:!0,seq:10},seq:{seq:20,canHide:!1,hidden:!0},columnId:{label:"COLUMN",headingAlignment:"start",elementId:"SD_COLUMN",isRequired:!0,width:100,seq:30,canHide:!0,hidden:!1},direction:{label:"DIRECTION",headingAlignment:"start",elementId:"SD_DIRECTION",width:60,seq:40,defaultValue:N,canHide:!0,hidden:!1},nulls:{label:"NULLS",elementId:"SD_NULLS",seq:50,defaultValue:L,canHide:!0,hidden:!0}}},load:function(e){var i,n,o=t.getSorts();for(i=0;i<o.length;i++)o[i].seq=i+1,o[i].order=i+1;return o.length>0?e.setData(o):n=e.insertNewRecord(),n},init:function(e,i,n){var o=t._getElement("SD_COLUMN"),a=t._getElement("SD_DIRECTION");t._getElement("SD_NULLS");o.change((function(){e.setValue(n.recordView("getRecord"),"columnId",o.val())})),a.change((function(){e.setValue(n.recordView("getRecord"),"direction",a.val())}))},validate:function(e){var t={},i=!0;return e.forEach((function(e,n,o){t[e.columnId]?i=!1:t[e.columnId]=!0})),!1!==i||j("SORT_ONLY_ONE_PER_COLUMN")},store:function(e){var i,n,o,a,l,r=e.getChanges(),s=t.getSorts();for(i=0;i<s.length;i++)s[i].seq=i+1;for(i=0;i<r.length;i++)if(a=(o=r[i]).record,l=o.original,a.seq=parseFloat(a.seq),o.inserted)s.push(a);else if(o.updated)if(l.columnId===a.columnId){for(n=0;n<s.length;n++)if(a.columnId===s[n].columnId){s[n]=a;break}}else{for(n=0;n<s.length;n++)if(l.columnId===s[n].columnId){s.splice(n,1);break}s.push(a)}else if(o.deleted)for(n=0;n<s.length;n++)if(a.columnId===s[n].columnId){s.splice(n,1);break}s.length>0&&(s=s.sort((function(e,t){return e.seq-t.seq}))),r.length>0&&t.setSorts(s)}})},_renderAggregateDialog:function(){var t,i,n=[],o=this;t=this._loadColumnOptions(n,"aggregate"),i=[{value:Y.CNT,label:j(Y.CNT)},{value:Y.CNT_DIST,label:j(Y.CNT_DIST)},{value:Y.MIN,label:j(Y.MIN)},{value:Y.MAX,label:j(Y.MAX)},{value:Y.MEDIAN,label:j(Y.MEDIAN)},{value:Y.SUM,label:j(Y.SUM)},{value:Y.AVG,label:j(Y.AVG)}],this._createDialog(S,(function(e){e(m,{id:"AD_COLUMN",required:!0,options:n}),e(m,{id:"AD_AGGREGATION",required:!0,options:i}),e(p,{maxlength:"30",id:"AD_TOOLTIP"}),e("checkbox",{id:"AD_SHOW_GRAND_TOTAL",value:"Y"})}),{titleKey:"AGGREGATION",dialogHelp:{helpTextKey:"AGGREGATE"},checkboxColumn:!0,modelOptions:{shape:"table",fields:{id:{canHide:!1,hidden:!0,seq:0},isEnabled:he(),columnId:{label:"COLUMN",headingAlignment:"start",elementId:"AD_COLUMN",isRequired:!0,defaultValue:"",seq:30,width:80,canHide:!0,hidden:!1},function:{label:"AGGREGATION",headingAlignment:"start",elementId:"AD_AGGREGATION",isRequired:!0,seq:40,width:80,defaultValue:"",canHide:!0,hidden:!1},tooltip:{label:"TOOLTIP",elementId:"AD_TOOLTIP",seq:50,defaultValue:"",canHide:!0,hidden:!0},showGrandTotal:{label:"SHOW_OVERALL_VALUE",elementId:"AD_SHOW_GRAND_TOTAL",seq:60,defaultValue:"Y",canHide:!0,hidden:!0}}},load:function(i){var n,a,l,r=[],s=e(this),d=s.dialog(v,"id"),c=s.dialog(v,"columnId"),u=o.getAggregates();function h(e){var t=o._getColumn(e);return l=t.filter.dataType===P?Y.SUM:Y.CNT,i.insertNewRecord(null,null,{columnId:e,isEnabled:!0,enabledClass:"is-checked",function:l})}if(u.length>0){for(n=0;n<u.length;n++)(a=e.extend({id:"",columnId:"",function:"",tooltip:"",showGrandTotal:"",isEnabled:"",enabledClass:"",enabledText:""},u[n])).enabledClass=a.isEnabled?"is-checked":"",a.enabledText=a.isEnabled?j("ENABLED"):j("DISABLED"),a.showGrandTotal=a.showGrandTotal?"Y":O,r.push(a);i.setData(r),c&&(d=h(c))}else d=h(c||t.id);return d},init:function(t,i,n){var a=o._getElement("AD_COLUMN"),l=o._getElement("AD_AGGREGATION"),r=o._getElement("AD_SHOW_GRAND_TOTAL");function s(){var i,r,s={},c=a.val();i=o._getColumn(c),c&&""!==c?(pe(n,"function"),pe(n,"tooltip"),pe(n,"showGrandTotal"),s[Y.CNT]=j(Y.CNT),"VARCHAR2"!==i.filter.dataType&&i.filter.dataType!==P&&i.filter.dataType!==F||(s[Y.CNT_DIST]=j(Y.CNT_DIST),s[Y.MIN]=j(Y.MIN),s[Y.MAX]=j(Y.MAX)),i.filter.dataType!==P&&i.filter.dataType!==F||(s[Y.MEDIAN]=j(Y.MEDIAN)),i.filter.dataType===P&&(s[Y.SUM]=j(Y.SUM),s[Y.AVG]=j(Y.AVG)),r=l.val(),l.empty(),l.append(e("<option></option>").attr("value","").text(j("SELECT"))),e.each(s,(function(t,i){l.append(e("<option></option>").attr("value",t).text(i))})),""!==r&&l.val(r),""!==l.val()&&null!==l.val()||(i.filter.dataType===P?l.val(Y.SUM):l.val(Y.CNT)),t.setValue(n.recordView("getRecord"),"columnId",c),d()):(ge(n,"function"),ge(n,"tooltip"),ge(n,"showGrandTotal"),t.setValue(n.recordView("getRecord"),"columnId",""),l.val("").change())}function d(){t.setValue(n.recordView("getRecord"),"function",l.val())}Le(a),a.change(s),l.change(d),r.change((function(){t.setValue(n.recordView("getRecord"),"showGrandTotal",r.prop("checked")?"Y":"N")})),n.on("apexbeginrecordedit",(function(){s()}))},validate:function(e,t,i){var n,o={},a=!0;return e.forEach((function(e,l,r){n=e.columnId.toString()+e.function,o[n]?(a=!1,i(r,"columnId",j("DUPLICATE_AGGREGATION")),i(r,"function",j("DUPLICATE_AGGREGATION"))):(o[n]=!0,t(r,"columnId"),t(r,"function")),""===e.columnId&&(i(r,"columnId",j("DUPLICATE_AGGREGATION")),a=!1)})),a},store:function(e){o._ifNoChangesDo((function(){var t,i,n,a={save:!1,skipNoChangesCheck:!0},l=e.getChanges();for(t=0;t<l.length;t++)(i=l[t]).record.columnId&&""!==i.record.columnId&&(delete(n=i.record).enabledClass,delete n.enabledText,n.showGrandTotal="Y"===n.showGrandTotal,i.inserted?(delete n.id,n.columnType=C,o.addAggregate(n,a)):i.updated?o.updateAggregate(n.id,n,a):i.deleted&&o.deleteAggregate(n.id,a));o._setReportSettings({refreshModel:!0,changeIdentifier:"views.grid.aggregations"})}))}})},_renderControlBreakDialog:function(){var t,i=[],n=this;t=this._loadColumnOptions(i,"sort"),this._createDialog("controlBreak",(function(e){e(m,{id:"CBD_COLUMN",required:!0,options:i}),n._renderSortControls(e,"CBD_")}),{titleKey:"CONTROL_BREAK",checkboxColumn:!0,modelOptions:{shape:"table",sequenceField:"sequenceField",fields:{id:{canHide:!1,hidden:!0,seq:0},sequenceField:{canHide:!1,hidden:!0,seq:0},oldColumnId:{canHide:!1,hidden:!0,seq:0},isEnabled:he(),columnId:{label:"COLUMN",headingAlignment:"start",elementId:"CBD_COLUMN",isRequired:!0,seq:20,width:100,canHide:!0,hidden:!1},direction:{label:"DIRECTION",elementId:"CBD_DIRECTION",defaultValue:N,seq:30,canHide:!0,hidden:!0},nulls:{label:"NULLS",elementId:"CBD_NULLS",defaultValue:L,seq:40,canHide:!0,hidden:!0}}},load:function(i){var o,a,l,r,s=[],d=e(this).dialog(v,"id"),c=n._getCurrentView().columns;for(o=0;o<c.length;o++)(r=(a=c[o]).break)&&(l=e.extend({},{id:a.columnId,columnId:a.columnId,oldColumnId:a.columnId,direction:a.direction,nulls:a.nulls,sequenceField:parseFloat(r.order),isEnabled:r.isEnabled,enabledClass:r.isEnabled?"is-checked":""}),s.push(l));return s.length>0?(s.sort((function(e,t){return e.sequenceField<t.sequenceField?-1:e.sequenceField>t.sequenceField?1:0})),i.setData(s)):d=i.insertNewRecord({isEnabled:!0,id:t.columnId,columnId:t.columnId,oldColumnId:t.columnId,direction:t.sort?t.sort.direction:N,nulls:t.sort?t.sort.nulls:L}),d},init:function(e,t,i){var o=n._getElement("CBD_COLUMN"),a=n._getElement("CBD_DIRECTION"),l=n._getElement("CBD_NULLS");function r(){e.setValue(i.recordView("getRecord"),"columnId",o.val()),""===o.val()?ye([a,l]):Le([a,l])}o.change(r),a.change((function(){e.setValue(i.recordView("getRecord"),"direction",a.val())})),l.change((function(){e.setValue(i.recordView("getRecord"),"nulls",l.val())})),i.on("apexbeginrecordedit",r)},validate:function(e,t,i){var n={},o=!0;return e.forEach((function(e,t,a){n[e.columnId]?(o=!1,i(a,"columnId",j("DUPLICATE_CONTROLBREAK"))):n[e.columnId]=!0,""===e.columnId&&(o=!1)})),o},store:function(e){n._ifNoChangesDo((function(){var t,i,o,a={save:!1,skipNoChangesCheck:!0},l=e.getChanges();function r(){n.addControlBreak(n._currentViewImpl().modelColumns[n._getColumn(o.columnId).name],{isEnabled:o.isEnabled,order:parseFloat(o.sequenceField),direction:o.direction,nulls:o.nulls},a)}for(t=0;t<l.length;t++)i=l[t],o=i.record,i.inserted?r():i.updated?o.columnId!==o.oldColumnId?(n.deleteControlBreak(o.oldColumnId,a),r()):n.updateControlBreak(o.columnId,{isEnabled:o.isEnabled,order:parseFloat(o.sequenceField),direction:o.direction,nulls:o.nulls},a):i.deleted&&n.deleteControlBreak(o.columnId,a);n._setReportSettings({refreshModel:!0,refreshColumns:!0})}))}})},_addActions:function(n){var a=this,l=this.options.config;n.add([{name:"search-case-sensitive",labelKey:"APEX.IG.CASE_SENSITIVE",value:!1,get:function(){return a.searchCaseSensitive},set:function(e){a.searchCaseSensitive=e}},{name:"filter-column",labelKey:"APEX.IG.SELECT_COLUMNS_TO_SEARCH",get:function(){return a.currentFilterColumnId},set:function(e){a._setFilterColumn(e)}},{name:"search",labelKey:"APEX.IG.GO",getSearchValue:function(e){var t="";l.toolbar&&l.toolbar.searchField&&(t=a._tbFindElement("search_field").val()),e(t)},action:function(){this.getSearchValue((function(e){var t;e?(t=a.currentFilterColumnId?{type:C,columnType:C,columnId:a.currentFilterColumnId,operator:"C",value:e,isCaseSensitive:a.searchCaseSensitive}:{type:_,value:e,isCaseSensitive:a.searchCaseSensitive},a.addFilter(t)):a.refresh()}))}},{name:"change-report",labelKey:"APEX.IG.SAVED_REPORTS",hide:!0,choices:[],get:function(){return a._report()},set:function(e){a._ifNoChangesDo((function(t){t&&a.clearChanges(),a._report(e)}))}},{name:"change-view",labelKey:"APEX.IG.CHANGE_VIEW",choices:[],get:function(){return a._view()},set:function(e){a._view(e,{fetchData:!0})}},{name:"show-columns-dialog",labelKey:"APEX.IG.COLUMNS",icon:"icon-ig-select-cols",action:function(){return a._openDialog("columns"),!0}},{name:"show-filter-dialog",labelKey:"APEX.IG.FILTER",icon:"icon-ig-filter",hide:!0,action:function(){return a._openDialog(A),!0}},{name:"chart-view",labelKey:"APEX.IG.CHART",icon:"icon-ig-chart",hide:!a._isViewRegistered(b),action:function(){a._isViewRegistered(b)?(a.viewsImpl[b].isConfigured()&&a._view(b,{fetchData:!0}),a.viewsImpl[b].openDialog()):i.error("Chart view is not defined.")}},{name:"show-sort-dialog",labelKey:"APEX.IG.SORT",icon:"icon-ig-sort",action:function(){return a._openDialog("sort"),!0}},{name:"show-aggregate-dialog",labelKey:"APEX.IG.AGGREGATE",icon:"icon-ig-aggregate",action:function(){return a._openDialog(S),!0}},{name:"show-flashback-dialog",labelKey:"APEX.IG.FLASHBACK",icon:"icon-ig-flashback",hide:!0,action:function(){return a._openDialog(R),!0}},{name:"show-highlight-dialog",labelKey:"APEX.IG.HIGHLIGHT",icon:"icon-ig-highlight",hide:!0,action:function(){return a._openDialog(T),!0}},{name:"show-control-break-dialog",labelKey:"APEX.IG.CONTROL_BREAK",icon:"icon-ig-control-break",action:function(){return a._openDialog("controlBreak"),!0}},{name:"stretch-columns",labelKey:"APEX.IG.STRETCH_COLUMNS",hide:!0,get:function(){var e=a._view(),t=a._currentReportSettings().views[e];return t&&t.stretchColumns},set:function(e){var t=a._currentReportSettings(),i=a._view(),n=t.views[i];n&&(n.stretchColumns=e),a._setOperationUpdate(t),a._setReportSettings({changeIdentifier:"views.grid.columns"})}},{name:"change-rows-per-page",labelKey:"APEX.IG.ROWS_PER_PAGE",choices:[{labelKey:"APEX.IG.AUTO",value:"null"},{label:"5",value:5},{label:"10",value:10},{label:"15",value:15},{label:"20",value:20},{label:"25",value:25},{label:"50",value:50},{label:"100",value:100},{label:"1000",value:1e3}],get:function(){var e=a._currentReportSettings().rowsPerPage;return null===e?"null":e},set:function(e){var t=a._currentReportSettings();e="null"===e?null:parseInt(e,10),t.rowsPerPage=e,a._setOperationUpdate(t),a._setReportSettings({changeIdentifier:"rowsPerPage",refreshView:!0})}},{name:"save-report",labelKey:"APEX.IG.SAVE",icon:"icon-ig-save",action:function(){var e=a._currentReportSettings();a.updateReport(e.id,e)}},{name:"show-save-report-as-dialog",labelKey:"APEX.IG.SAVE_AS",icon:"icon-ig-save-as",action:function(){return a._openDialog("saveAsReport"),!0}},{name:"show-edit-report-dialog",labelKey:"APEX.IG.EDIT",icon:"icon-ig-edit",action:function(){return a._openDialog("editReport"),!0}},{name:"delete-report",labelKey:"APEX.IG.DELETE",icon:"icon-ig-delete",action:function(){s.confirm(j("DELETE_REPORT_CONFIRM"),(function(e){e&&a.deleteReport(a._report())}))}},{name:"show-download-dialog",labelKey:"APEX.IG.DOWNLOAD",icon:"icon-ig-download",hide:!0,action:function(){return a._openDialog("download"),!0}},{name:"show-help-dialog",labelKey:"APEX.IG.HELP",icon:"icon-ig-help",action:function(){var i=a.options.config;o.loadMessagesIfNeeded(["APEX.IG.HELP.ACTIONS.INTRO_HEADING","APEX.IG.HELP.ACTIONS.INTRO","APEX.IG.HELP.ACTIONS.REPORTING_HEADING","APEX.IG.HELP.ACTIONS.REPORTING","APEX.IG.HELP.ACTIONS.EDITING_HEADING","APEX.IG.HELP.ACTIONS.EDITING"],(function(){var n=t.htmlBuilder();function o(t,i){var n=e.extend({headingKey:"",helpText:"",helpTextKey:""},i);n.headingKey&&t.markup("<h2>").content(z(n.headingKey)).markup("</h2>"),n.helpText&&t.markup("<div").attr(M,"apex-help-custom").markup(">").markup(n.helpText).markup("</div>"),n.helpTextKey&&t.markup("<p>").markup(z(n.helpTextKey)).markup("</p>")}i.text.help&&o(n,{helpText:i.text.help}),o(n,{headingKey:"APEX.IG.HELP.ACTIONS.INTRO_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.INTRO"}),o(n,{headingKey:"APEX.IG.HELP.ACTIONS.REPORTING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.REPORTING"}),i.editable&&o(n,{headingKey:"APEX.IG.HELP.ACTIONS.EDITING_HEADING",helpTextKey:"APEX.IG.HELP.ACTIONS.EDITING"}),r.popupFieldHelp({title:j("HELP.ACTIONS_TITLE"),helpText:n.toString()})}))}},{name:"selection-mode",onLabelKey:"APEX.IG.SEL_MODE_CELL",offLabelKey:"APEX.IG.SEL_MODE_ROW",shortcut:"F8",hide:!0,get:function(){var e=a._currentViewImpl();return!e.view$||!e.supports.cellSelection||!e.selectCells()},set:function(e){var t=a._currentViewImpl();t.view$&&t.supports.cellSelection&&t.selectCells(!e)}},{name:"selection-duplicate",type:D,labelKey:"APEX.IG.DUPLICATE_ROWS",icon:"icon-ig-duplicate",hide:!0,action:function(){var e,t=a._currentViewImpl();if(t.supports.edit&&(e=t.getSelectedRecords()).length>0)return t.model.copyRecords(e,null,e[e.length-1]),!0}},{name:"selection-delete",labelKey:"APEX.IG.DELETE_ROWS",icon:"icon-ig-delete",hide:!0,action:function(){var e,t,i=a._currentViewImpl();if(i.supports.edit){for(t=i.getSelectedRecords(),e=0;e<t.length;e++)i.model.allowDelete(t[e])||(t.splice(e,1),e-=1);t.length>0&&i.model.deleteRecords(t)}}},{name:"selection-refresh",labelKey:"APEX.IG.REFRESH_ROWS",icon:"icon-ig-refresh",action:function(){var e,t=a._currentViewImpl();t.supports.edit&&(e=t.getSelectedRecords()).length>0&&t.model.fetchRecords(e)}},{name:"selection-revert",labelKey:"APEX.IG.REVERT_CHANGES",icon:"icon-ig-revert",hide:!0,action:function(){var e,t,i=a._currentViewImpl();if(i.supports.edit){for(t=i.getSelectedRecords(),e=0;e<t.length;e++)i.model.canRevertRecord(t[e])||(t.splice(e,1),e-=1);t.length>0&&(i.model.revertRecords(t),a._updateSelectionActions())}}},{name:"selection-copy",labelKey:"APEX.IG.COPY_CB",icon:"icon-ig-copy",action:function(){var e=a._currentViewImpl();e.canCopy2Clipboard()&&(e.focus(),apex.clipboard.copy())}},{name:"refresh",labelKey:"APEX.IG.REFRESH",icon:"icon-ig-refresh",action:function(){a.refresh()}},{name:"reset-report",labelKey:"APEX.IG.RESET",disabled:!0,icon:"icon-ig-reset",action:function(){a._resetReportSettings()}},{name:"edit",labelKey:"APEX.IG.EDIT",hide:!0,get:function(){return a.editMode},set:function(e){a._setEditMode(e)}},{name:"save",labelKey:"APEX.IG.SAVE",hide:!0,shortcut:"Ctrl+Alt+S",action:function(){var e,t=a.options.config,i=a.editableViewImpl.model.name;c.anyErrors(!1,i,!0)?s.alert(z("APEX.CORRECT_ERRORS"),(function(){})):a.editableViewImpl.finishEditing().done((function(){var n=null;void 0===t.saveLoadingIndicatorPosition&&void 0===t.saveLoadingIndicator||(n={loadingIndicatorPosition:t.saveLoadingIndicatorPosition||null,loadingIndicator:t.saveLoadingIndicator||null}),(e=c.save(null,n,i,!0))&&(e.done((function(e){var t,i,n="",o="";if(e.errors)s.clearErrors(),s.showErrors(e.errors),n="error";else if(e.regions){for(t=0;t<e.regions.length;t++)(i=e.regions[t]).fetchedData&&i.fetchedData.successMessage&&(o&&(o+="<br>"),o+=i.fetchedData.successMessage);o||(o=j("CHANGES_SAVED")),s.showPageSuccess(o),n="success"}a._selectionChange(null),a._trigger("save",null,{status:n})})).fail((function(e,t,i){a._trigger("save",null,{status:"fail"})})).always((function(){a.actions.enable("save")})),a.actions.disable("save"))}))}},{name:"selection-add-row",label:l.text.addRowButton,hide:!0,action:function(){var e=a._currentViewImpl(),t=e.getSelectedRecords();if(!e.supports.singleRowView||!e.singleRowMode)return e.focus(),e.model.insertNewRecord(null,t[t.length-1]),!0;a.getActions().invoke("insert-record")}},{name:"single-row-view",label:j("SINGLE_ROW_VIEW"),icon:"icon-ig-single-row-view",hide:!0,action:function(e,t){var i,n=null,o=a.editMode,l=a._currentViewImpl();if(l.supports.singleRowView&&l.singleRowView$&&l.singleRowView$.length&&!l.singleRowMode)return t&&(n=l.getContextRecord(t)[0]),n||(n=l.getSelectedRecords()[0]),o&&l.view$.grid("setEditMode",!1),l.singleRowMode=!0,l.view$.hide(),l.curInst=l.singleRowView$.recordView("instance"),a._updateSummary(),(i=a._tbFind("selection_submenu"))&&(i.disabled=!0),l.singleRowView$.show().recordView("resize"),n&&l.setSelectedRecords([n]),o?l.singleRowView$.recordView("setEditMode",!0):l.singleRowView$.recordView("focus"),!0}},{name:"row-add-row",label:j("ADD_ROW"),icon:"icon-ig-add-row",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);return i.focus(),i.model.insertNewRecord(null,n[0]),!0}},{name:"row-duplicate",label:j("DUPLICATE_ROW"),icon:"icon-ig-duplicate",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);return i.model.copyRecords(n,null,n[0]),!0}},{name:"row-delete",label:j("DELETE_ROW"),icon:"icon-ig-delete",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.model.deleteRecords(n)}},{name:"row-refresh",label:j("REFRESH_ROW"),icon:"icon-ig-refresh",action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.model.fetchRecords(n)}},{name:"row-revert",label:j("REVERT_CHANGES"),icon:"icon-ig-revert",hide:!0,action:function(e,t){var i=a._currentViewImpl(),n=i.getContextRecord(t);i.focus(),i.model.revertRecords(n)}}])},_initToolbar:function(){var e,t=this.options.config.toolbarData,i=this;delete t.toolbarFind,delete t.toolbarRemove,delete t.toolbarInsertAfter,this.toolbar$=this._getElement("toolbar").toolbar({actionsContext:this.actions,data:t}),e=this._tbFindElement("actions_button_menu"),this._tbFindElement("column_filter_button").hide(),this._tbFindElement("search_field").hide(),this._tbFindElement("actions_button").hide(),this._currentReportSettings().defaultFilterColumn?this._setFilterColumn(this._currentReportSettings().defaultFilterColumn.columnId):this._setFilterColumn(null),e.on("menubeforeopen",(function(){var t;(t=e.menu("find","rows"))&&(t.hide="set"!==i.options.config.pagination.type)}))},_getId:function(e){return e?this.idPrefix+"_"+e:""},_getIdSelector:function(e){return"#"+this._getId(e)},_getElement:function(t){return e(this._getIdSelector(t))},_setEditMode:function(e){var t,i,n={},o=this._currentViewImpl(),a=!1,l=this,r=this.options.config.columns;function s(){o.setEditMode(l.editMode),e&&setTimeout((function(){o.focus()}),100)}if(this.editMode=e,e){for(t=0;t<r.length;t++)r[t].validation&&r[t].validation.isRequired&&(n[r[t].id]=r[t]);if(Object.keys(n).length>0){for(i=this._getCurrentView().columns,t=0;t<i.length;t++)n[i[t].columnId]&&!i[t].isVisible&&(i[t].isVisible=!0,this._setOperationUpdate(i[t]),a=!0);a&&this._setReportSettings({changeIdentifier:"views.grid.columns"},s)}}a||s()},_configureView:function(e){this.viewsImpl[e].isConfigured()&&this._view(e,{fetchData:!0}),this.viewsImpl[e].openDialog()},_getColumn:function(e){return this.columnMap[e]},_getColumnByName:function(e){var t,n=this.options.config.columns;for(t=0;t<n.length;t++)if(n[t].name===e)return n[t];i.warn("No column exists with name: ",e)},_getColumnByStaticId:function(e){var t,n=this.options.config.columns;for(t=0;t<n.length;t++)if(n[t].staticId===e)return n[t];i.warn("No column exists with static ID: ",e)},_getTextTransformClass:function(e){var t,i=e.filter.textCase;return i&&(t={lower:"u-textLower",upper:"u-textUpper"}[i.toLowerCase()]),t},_convertNamesToLabels:function(e){var t,i=this.options.config.columns,n={};for(t=0;t<i.length;t++)n[i[t].name]=i[t].heading.label;return e&&""!==e?e.replace(/(")(.*?)(")/g,(function(e,t,i){return'"'+n[i]+'"'})):e},_convertLabelsToNames:function(e){var t,i=this.options.config.columns,n={};for(t=0;t<i.length;t++)n[i[t].heading.label]=i[t].name;return e&&""!==e?e.replace(/(")(.*?)(")/g,(function(e,t,i){return'"'+n[i]+'"'})):e},_getColumnFormatMask:function(e){var t,n,o=this._getColumn(e).appearance.dateFormatMask;if(o&&""!==o){t=apex.jQuery.datepicker.parseDate("yymmdd","20160302");try{n=apex.jQuery.datepicker.parseDate(o,apex.jQuery.datepicker.formatDate(o,t)),apex.jQuery.datepicker.formatDate("yymmdd",t)!==apex.jQuery.datepicker.formatDate("yymmdd",n)&&(i.warn("Date format mask is unusable for a date picker - using default: ",o),o="yy-mm-dd")}catch(e){i.warn("Date format mask is unusable for a date picker - using default: ",o),o="yy-mm-dd"}}else i.warn("No date format mask exists for column - using default: ",e),o="yy-mm-dd";return o},_getColumnLabel:function(e){var t,n=this._getColumn(e);return n.isHidden?i.info("_getColumnLabel called on hidden column, check calling logic",e):t=n.heading.label,t},_isColumnFilterable:function(e){var t=this._getColumn(e);return!t.specialType&&t.filter&&!t.isHidden},_hasColumnFilterLov:function(e){var t=this._getColumn(e);return t.filter&&t.filter.hasLov},_getColumnType:function(e){this._getColumn(e);return C},_getCurrentView:function(){var e=this._view(),t=this.options,i=t.config.views,n=i[e].useModelFrom;return n&&i[n].shareModel&&(e=n),t.savedReports[this.currentSavedReportIdx].views[e]},_currentViewImpl:function(){return this.viewsImpl[this._view()]},_view:function(t,i){var n,o,a,l,r,s,d,c,u=this,h=this.options.config,g=this.actions,p=!1,m=!1,f=this._currentReportSettings(),_=!1,C=[],I=e.extend({initialData:null,fetchData:!1},i);if(!t)return f.currentView;if(r=this._currentViewImpl(),this.viewsImpl[t].isConfigured()){for(a in f.currentView=t,l=this._currentViewImpl(),s=h.views[t].features,d=l.supports,r&&r.view$&&r.hide(),l.view$?(l.show(),this._updateModelRegionData(l),l.pendingRefresh&&(l.pendingRefresh=!1,l.refresh()),this._setReportSettings({changeIdentifier:"view.change"})):(this._getElement(l.elementId).show(),l.view$=this._getElement(l.elementId),l.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:h,ig:this,currentReportSettings:f}),I.viewImpl=l,this._setModel(I),I.viewImpl.supports.edit&&(this.editableViewImpl=I.viewImpl),l.initView({ig$:this.element,ig:this,igConfig:h,currentReportSettings:f}),this._setInitialSelection(0),_=!0),o=this._refreshReportSettings(),this._updateSummary(),C.push({labelKey:"APEX.IG.ALL_TEXT_COLUMNS",value:null}),l.modelColumns)if(l.modelColumns.hasOwnProperty(a)&&l.modelColumns[a].id&&this._isColumnFilterable(l.modelColumns[a].id)&&(p=!0,-1!==e.inArray(this._getColumn(l.modelColumns[a].id).filter.dataType,["VARCHAR2","CLOB"])))for(n=0;n<this._getColumn(l.modelColumns[a].id).filter.operators.length;n++)-1!==e.inArray(this._getColumn(l.modelColumns[a].id).filter.operators[n].name,["$perform$","C"])&&(m=!0,C.push({label:l.modelColumns[a].label,value:l.modelColumns[a].id}));h.filter.oracleText&&(m=!0),g.lookup("filter-column").choices=C,g.updateChoices("filter-column"),this._updateChangeViewActions(),this._toggleEnableAction(m,"search"),h.toolbar&&h.toolbar.searchField&&h.toolbar.columnSelection&&this._tbFindElement("column_filter_button").prop(E,!m),_||o||l.resize(),this._toggleEnableAction(h.editable&&d.edit,["edit","save","selection-add-row","selection-add-row","row-add-row","selection-duplicate","row-duplicate","selection-delete","row-delete","selection-revert","row-revert"]),this._toggleEnableAction(h.editable&&d.edit&&d.singleRowView,["insert-record","delete-record","revert-record","duplicate-record"]),this._toggleEnableAction(d.controlBreak&&s.controlBreak,"show-control-break-dialog"),this._toggleEnableAction(d.aggregation&&s.aggregate,"show-aggregate-dialog"),this._toggleEnableAction(d.highlight&&s.highlight,"show-highlight-dialog"),this._toggleEnableAction(d.changeRowsPerPage&&s.changeRowsPerPage,"change-rows-per-page"),this._toggleEnableAction(d.singleRowView&&s.singleRowView,["single-row-view","refresh-record"]),this._toggleShowAction(l.canCopy2Clipboard(),"selection-copy"),this._toggleShowAction(d.cellSelection,"selection-mode"),(c=this._tbFind("selection_submenu"))&&(c.disabled=!d.selection),this._toggleEnableAction(d.configurableColumns,["show-columns-dialog","stretch-columns"]),this._toggleEnableAction(d.filter&&h.features.filter,"show-filter-dialog"),p||this._toggleEnableAction(!1,"show-filter-dialog"),this._toggleEnableAction(d.sort,"show-sort-dialog"),this._toggleEnableAction(d.download&&h.features.download,"show-download-dialog"),this._trigger("viewChange",null,{view:t,created:_}),this._selectionChange(null),this._forEachView((function(e,i){i.viewChanged(e===t,u,h)}))}else this.viewsImpl[t].openDialog()},_destroyAllModels:function(){var e=this;this._forEachView((function(t,i){e._setModel({viewImpl:i,remove:!0}),i.view$&&(i.hide(),i.destroyView(e),i.view$=null)}))},_report:function(e){var t,i,n=this.options;if(!e)return this._currentReportSettings().id;for(this._destroyAllModels(),s.hidePageSuccess(),t=0;t<n.savedReports.length;t++)if(n.savedReports[t].id===e){this.currentSavedReportIdx=t;break}i=this._currentViewImpl(),this._forEachView((function(e,t){t.view$&&t.hide()})),i.view$||(i.view$=this._getElement(i.elementId)),this._updateSummary(),i.view$.show(),i.setColumnConfig({baseModelColumns:this.baseModelColumns,igConfig:n.config,currentReportSettings:this._currentReportSettings(),ig:this}),this.reportSettingsSeq+=1,this._setModel({viewImpl:i}),i.initView({ig$:this.element,ig:this,igConfig:n.config,currentReportSettings:this._currentReportSettings()}),this._updateActions(),this.editMode=!1,this.actions.update("edit"),this._updateChangeViewActions(),this._clearToolbarSearch(),this._trigger("viewChange",null,{view:i.internalIdentifier,created:!0}),this._refreshReportSettings(),this._updateModelRegionData(i),this.refresh(),this._trigger("reportChange",null,{report:this._report()})},_currentReportSettings:function(){return this.options.savedReports[this.currentSavedReportIdx]},_updateModelRegionData:function(e){var t=e.internalIdentifier,i=this.options.config.views,n=i[t].useModelFrom,o=e.model.getOption("regionData");o.reportId=this._report(),n&&i[n].shareModel&&(t=n),o.view=t},_updateSummary:function(){var e=this.getCurrentView(),t=e.title,i=this._currentReportSettings(),n=i.name;n||i.type!==w||(n=j("PRIMARY_REPORT")),e.supports.singleRowView&&e.singleRowMode&&(t+=" ("+z("SINGLE_ROW_VIEW")+")"),this._getElement("summary").text(o.formatMessage("APEX.IG.SUMMARY",n,t))},_shortenString:function(e,t){var i=t||20;return e.length>i?e.substr(0,i)+"...":e},_adjustControlBreakSort:function(){var t,i,n=[],o=this._getCurrentView().columns;for(t=0;t<o.length;t++)!o[t].sort||null===o[t].sort.order||o[t].break&&o[t].break.isEnabled||n.push({columnId:o[t].columnId,order:o[t].sort.order});for(n.sort((function(e,t){return e.order-t.order})),t=0;t<n.length;t++)for(i=0;i<o.length;i++)n[t].columnId===o[i].columnId&&e.extend(this._currentViewImpl().modelColumns[this._getColumn(o[i].columnId).name],{sortIndex:t+1})},_getSettingLabel:function(t,i){var n,a,l="APEX.IG.",r=["EQ","NEQ","GT","GTE","LT","LTE","LIKE","NLIKE","C","NC","REGEXP","S","NS","OTEXT"],s=["N","NN"],d=[H,"NBETWEEN"],c=["LAST","NLAST","NEXT","NNEXT"];function u(e,t){return e&&null!==e.match(/^\d{14}/)?apex.jQuery.timepicker.formatCanonicalDate(me(e),t):""}switch(t){case A:switch(i.type){case C:l+="X.",e.inArray(i.operator,r)>-1&&(l+=W[i.operator]+".Y",n=e.inArray(this._getColumn(i.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1?o.formatMessage(l,this._getColumnLabel(i.columnId),u(i.hiddenValue?i.hiddenValue:i.value,this._getColumnFormatMask(i.columnId))):o.formatMessage(l,this._getColumnLabel(i.columnId),i.value)),e.inArray(i.operator,[G,"NIN"])>-1&&(l+=W[i.operator]+".Y",n=o.formatMessage(l,this._getColumnLabel(i.columnId),i.value.split("").join("; "))),e.inArray(i.operator,s)>-1&&(l+=W[i.operator],n=o.formatMessage(l,this._getColumnLabel(i.columnId))),e.inArray(i.operator,d)>-1&&(l+=W[i.operator]+".Y.AND.Z",a=i.hiddenBetween||i.hiddenAnd?[i.hiddenBetween,i.hiddenAnd]:i.value.split("~"),n=e.inArray(this._getColumn(i.columnId).filter.dataType,[F,U,"TIMESTAMP_TZ","TIMESTAMP_LTZ"])>-1?o.formatMessage(l,this._getColumnLabel(i.columnId),u(a[0],this._getColumnFormatMask(i.columnId)),u(a[1],this._getColumnFormatMask(i.columnId))):o.formatMessage(l,this._getColumnLabel(i.columnId),a[0],a[1])),e.inArray(i.operator,c)>-1&&(2!==(a=i.value.split("~")).length&&(a=["","MI"]),"1"===a[0]?(l+=W[i.operator]+"_"+Q[a[1]],n=o.formatMessage(l,this._getColumnLabel(i.columnId))):(l+=W[i.operator]+".Y."+Q[a[1]]+"S",n=o.formatMessage(l,this._getColumnLabel(i.columnId),a[0])));break;case"complex":n=i.name;break;case _:l+="SEARCH_FOR.X",n=o.formatMessage(l,i.value)}break;case"controlBreak":n=this._getColumnLabel(i.columnId);break;case S:n=j(i.function)+" ("+this._getColumnLabel(i.columnId)+")";break;case T:n=this._shortenString(i.name?i.name:this._getColumnLabel(i.condition.columnId));break;case R:1===i.minsAgo?n=z(l+="REPORT_DATA_AS_OF_ONE_MINUTE_AGO"):(l+="REPORT_DATA_AS_OF.X.MINUTES_AGO",n=o.formatMessage(l,i.minsAgo))}return n},_getSettingSummaryLabel:function(e,t){var i,n="APEX.IG.";switch(e){case A:switch(t.type){case C:i=this._getColumnLabel(t.columnId);break;case"complex":i=this._shortenString(t.name);break;case _:i="'"+this._shortenString(t.value,18)+"'"}break;case"controlBreak":i=this._getColumnLabel(t.columnId);break;case T:i=this._shortenString(t.name?t.name:this._getColumnLabel(t.condition.columnId));break;case R:1===t.minsAgo?i=z(n+="ONE_MINUTE_AGO"):(n+="X.MINUTES_AGO",i=o.formatMessage(n,t.minsAgo));break;case S:i=this._shortenString(this._getColumnLabel(t.columnId))}return i},_getTotalReportSettings:function(){var e,t=0,i=this._getCurrentView(),n=this._currentReportSettings();switch(n.filters&&(t+=n.filters.length),n.flashback&&(t+=1),this._view()){case"grid":for(e=0;e<i.columns.length;e++)i.columns[e].break&&(t+=1);i.highlights&&(t+=i.highlights.length),i.aggregations&&(t+=i.aggregations.length);break;case b:i&&(t+=1)}return t},_renderReportSettings:function(t){var i,n=[],a=this,l=this._getCurrentView(),r=this._currentReportSettings(),s=this._getTotalReportSettings()>0;t.markup("<div").attr(M,"a-MediaBlock a-IG-controlsContainer").attr("id",this._getId("report_settings")),s||t.attr("style","display:none;"),t.markup(">"),t.markup("<div").attr(M,"a-MediaBlock-graphic").markup(">"),t.markup("<h3").attr(M,"u-VisuallyHidden").markup(">").content(j("REPORT_SETTINGS")).markup("</h3>"),Ae(t,{buttonClass:"a-Button a-IG-button a-IG-button--controls"}),t.markup("</div>"),function(t){function s(t,i){var n={},l=e.extend({type:"",id:"",active:!1,label:"",excludeToggle:!1,isInvalid:!1,linkStyle:""},i),r="a-IG-controls-item a-IG-controls-item--"+l.type;n.setting=l.type,n["setting-id"]=l.id,l.isInvalid&&(r+=" is-error"),t.markup("<li").attr(M,r).attr("role","group").attr("aria-labelledby","control_text"+l.id).markup(">"),t.markup("<span").attr(M,"a-IG-controls-cell").markup(">"),l.excludeToggle||(Te(t,{id:a._getId("control_"+l.id),cssClasses:"a-IG-controlsCheckbox",checked:l.active,data:n,disabled:l.isInvalid}),Se(t,{labelFor:a._getId("control_"+l.id),cssClasses:"a-IG-controlsCheckboxLabel",label:j("TOGGLE"),labelTextHidden:!0})),t.markup("</span>"),t.markup("<span").attr(M,"a-IG-controls-cell").markup(">").markup("<span").attr(M,"a-Icon a-IG-controlsIcon icon-ig-"+Ce(l.type)).markup(">").markup("</span>").markup("</span>"),t.markup("<span").attr(M,"a-IG-controls-cell a-IG-controls-cell--label").markup(">"),l.isInvalid?t.markup("<span").attr("id","control_text"+l.id).attr(M,"a-IG-controlsLabel").markup(">").markup(l.label).markup("</span>"):(t.markup("<a href='#'").attr(M,"a-IG-controlsLabel").attr("data-setting",l.type).attr("data-setting-id",l.id).optionalAttr("style",l.linkStyle).markup(">"),t.markup("<span").attr(M,"u-VisuallyHidden").markup(">").content(j("EDIT")).markup("</span>"),t.markup("<span").attr("id","control_text"+l.id).markup(">").markup(l.label).markup("</span>"),t.markup("</a>")),t.markup("</span>"),t.markup("<span").attr(M,"a-IG-controls-cell a-IG-controls-cell--remove").markup(">"),Ae(t,{buttonClass:"a-Button a-Button--noUI a-IG-button a-IG-button--remove",iconOnly:!0,icon:"icon-remove",label:o.formatMessage("APEX.IG.REMOVE_CONTROL",Z[l.type]),data:n}),t.markup("</span>"),t.markup("</li>")}if(t.markup("<div").attr(M,"a-MediaBlock-content").markup(">"),t.markup("<ul").attr(M,"a-IG-controls").markup(">"),r.views.chart&&a._view()===b&&s(t,{type:b,excludeToggle:!0,label:j("EDIT_CHART")}),r.filters)for(i=0;i<r.filters.length;i++)"d"!==r.filters[i].operation&&s(t,{type:A,id:r.filters[i].id,active:r.filters[i].isEnabled,label:a._getSettingLabel(A,r.filters[i]),isInvalid:r.filters[i].isInvalid});if(a._currentViewImpl().supports.controlBreak&&l){for(i=0;i<l.columns.length;i++)l.columns[i].break&&"d"!==l.columns[i].break.operation&&n.push(l.columns[i]);if(n.length>0)for(n.sort((function(e,t){var i=e.break.order,n=t.break.order;return i<n?-1:i>n?1:0})),i=0;i<n.length;i++)s(t,{type:"controlBreak",id:n[i].columnId,active:n[i].break.isEnabled,label:a._getSettingLabel("controlBreak",n[i])})}if(a._currentViewImpl().supports.highlight&&l.highlights)for(i=0;i<l.highlights.length;i++)"d"!==l.highlights[i].operation&&s(t,{type:T,id:l.highlights[i].id,active:l.highlights[i].isEnabled,label:a._getSettingLabel(T,l.highlights[i]),isInvalid:l.highlights[i].isInvalid,linkStyle:"background:"+l.highlights[i].backgroundColor+";color:"+l.highlights[i].textColor});if(a._currentViewImpl().supports.aggregation&&l.aggregations)for(i=0;i<l.aggregations.length;i++)"d"!==l.aggregations[i].operation&&s(t,{type:S,id:l.aggregations[i].id,active:l.aggregations[i].isEnabled,label:a._getSettingLabel(S,l.aggregations[i])});r.flashback&&"d"!==r.flashback.operation&&s(t,{type:R,active:r.flashback.isEnabled,label:a._getSettingLabel(R,r.flashback)}),t.markup("</ul></div>")}(t),function(t){var i=0,o=0;function d(e,t,n){var l,r,s,d="",u=[],h=!0;for(l=0;l<n.length;l++)"d"!==n[l].operation&&("controlBreak"===t?r=n[l].break.isEnabled:(r=n[l].isEnabled,s=n[l].isInvalid),s?o++:r?(u.push(l),h||(d+=", "),d+=a._getSettingSummaryLabel(t,n[l]),h=!1):i++);u.length>0&&c(e,{type:t,id:n[u[0]],count:u.length,label:d})}function c(t,i){var n=e.extend({type:"",id:"",count:0,label:""},i);t.markup("<li").attr(M,"a-IG-reportSummary-item a-IG-reportSummary-item--"+n.type).markup(">"),t.markup("<a href='#'").attr(M,"a-IG-reportSummary-label").attr("data-setting",n.type).optionalAttr("data-setting-id",n.id).markup(">"),t.markup("<span").attr(M,"a-IG-reportSummary-icon").markup(">"),t.markup("<span").attr(M,"a-Icon icon-ig-"+Ce(n.type)).markup("></span>"),(n.count>1||"inactiveSettings"===n.type||"invalidSettings"===n.type)&&t.markup("<span").attr(M,"a-IG-reportSummary-count").markup(">").content(n.count).markup("</span>"),t.markup("</span>"),t.markup("<span").attr(M,"a-IG-reportSummary-value").markup(">").content(n.label).markup("</span>"),t.markup("</a>")}t.markup("<div").attr(M,"a-IG-reportSummaryContainer"),"expanded"===r.reportSettingsArea&&t.attr("style","display:none;"),t.attr("id",a._getId("report_settings_summary")),s||t.attr("style","display:none;"),t.markup(">"),t.markup("<ul").attr(M,"a-IG-reportSummary").markup(">"),r.views.chart&&a._view()===b&&c(t,{type:b,label:j("EDIT_CHART")}),r.filters&&d(t,A,r.filters),n.length>0&&d(t,"controlBreak",n),l.highlights&&d(t,T,l.highlights),l.aggregations&&d(t,S,l.aggregations),r.flashback&&(r.flashback.isEnabled?c(t,{type:R,label:a._getSettingSummaryLabel(R,r.flashback)}):i++),i>0&&c(t,{type:"inactiveSettings",count:i,label:j(1===i?"INACTIVE_SETTING":"INACTIVE_SETTINGS")}),o>0&&c(t,{type:"invalidSettings",count:o,label:j(1===i?"INVALID_SETTING":"INVALID_SETTINGS")}),t.markup("</ul></div>")}(t),t.markup("</div>")},_initReportSettings:function(){var t=this,i=this.options.config.maxHeight,n=this._getElement("report_settings"),o=t._currentReportSettings();function a(e,i,a){if(o.reportSettingsArea===e){var l=n.data("apex-collapsible").controllingElement$.is(":focus");o.reportSettingsArea=i,t._setOperationUpdate(o),t._setReportSettings({},(function(){l&&t._getElement("report_settings").data("apex-collapsible").controllingElement$.focus()})),t._getElement("report_settings_summary")[a](),t.resize()}}this._getTotalReportSettings()>0&&(this._on(n,{"click a.a-IG-controlsLabel":function(t){var i=e(t.currentTarget);this._openDialog(i.data("setting"),{id:i.data("setting-id")+""}),t.preventDefault()},"click a.a-IG-reportSummary-label":function(t){var i=e(t.currentTarget),o=i.data("setting");"inactiveSettings"===o||"invalidSettings"===o?n.collapsible("expand"):this._openDialog(o,{id:i.data("setting-id")+""}),t.preventDefault()},"click input.a-IG-controlsCheckbox":function(t){var i=e(t.target),n=i.prop("checked"),o=i.data("setting"),a=i.data("setting-id")+"";switch(o){case A:this.updateFilter(a,{isEnabled:n});break;case S:this.updateAggregate(a,{isEnabled:n});break;case T:this.updateHighlight(a,{isEnabled:n});break;case"controlBreak":this.updateControlBreak(a,{isEnabled:n});break;case R:this.updateFlashback({isEnabled:n})}},"click button.a-IG-button--remove":function(t){var i=e(t.currentTarget),n=i.data("setting"),o=i.data("setting-id")+"";switch(t.preventDefault(),n){case A:this.deleteFilter(o);break;case S:this.deleteAggregate(o);break;case T:this.deleteHighlight(o);break;case"controlBreak":this.deleteControlBreak(o);break;case R:this.deleteFlashback();break;case b:this.deleteChart()}}}),n.collapsible({content:"div.a-MediaBlock-content",collapsed:"collapsed"===o.reportSettingsArea,collapse:function(){a("expanded","collapsed","show")},expand:function(){a("collapsed","expanded","hide")}}),i&&n.find(".a-Collapsible-content").css({"max-height":(i-(e(".a-IG-header",this.element).outerHeight()||0))/3+"px",overflow:"auto"}))},_isSettingsCheckboxFocused:function(t,i){var n;return!(!document.activeElement||"checkbox"!==document.activeElement.type)&&((n=e(document.activeElement).data()).setting===i&&""+n.settingId===t)},_focusOnSettingsCheckbox:function(e,t,i){var n;e&&(n=".a-IG-controlsCheckbox[data-setting="+i+"]",t&&(n+="[data-setting-id="+t+"]"),this._getElement("report_settings").find(n).focus())},_currentViewColumn:function(t,i){var n,o,a=this._getCurrentView().columns;for(n=0;n<a.length;n++)if(a[n].columnId===t){o=a[n];break}return e.isPlainObject(i)&&(o=e.extend(!0,o,i),this._setOperationUpdate(o)),o},_refreshReportSettings:function(){var e,i=this._getElement("report_settings"),n=t.htmlBuilder();return!(!i[0]||(e=i[0].clientHeight,this._renderReportSettings(n),i.replaceWith(n.toString()),this._initReportSettings(),e===this._getElement("report_settings")[0].clientHeight))&&(this.resize(),!0)},_defaultAjaxRegionData:function(t){var i=this.options.config,n=e.extend(!0,{id:i.regionId,ajaxIdentifier:i.ajaxIdentifier,ajaxColumns:i.ajaxColumns,reportId:this._report(),view:this._view()},t);return this._isCurrentlyEditable()&&(n.allowedOperations=i.editable.allowedOperations.protected),n},_call:function(e,t){var i=this.options.config,o={regions:[this._defaultAjaxRegionData(e)]};return i.parentRegionStaticId&&this.parentItemValues.length>0&&(o.regions[0].parentItems={values:this.parentItemValues}),i.loadingIndicator&&(t.loadingIndicator=i.loadingIndicator),(i.callServer||n.plugin)(o,t)},_setReportSettings:function(t,i){function n(e){var t;for(t=0;t<e.length;t++)e[t].operation||(e.splice(t,1),t-=1)}var o,a,l={},r=this.options.config,d=this,c=e.extend({refreshView:!1,refreshModel:!1,affectsOtherViewsModels:!1,refreshColumns:!1,changeIdentifier:""},t);return(o=e.extend(!0,{},this._currentReportSettings())).filters&&o.filters.length>0&&n(o.filters),r.views.grid&&n(o.views.grid.columns),r.views.icon&&n(o.views.icon.columns),r.views.detail&&n(o.views.detail.columns),r.features.saveReport&&r.features.saveReport.publicReportCs&&(l.publicReportCs=r.features.saveReport.publicReportCs),a={success:function(e){var t,n=d._defaultSavedReport(e.regions[0].setReportSettings[0]);s.hidePageSuccess(),d._view()!==n.currentView&&d._view(n.currentView,{fetchData:!0}),d.options.savedReports[d.currentSavedReportIdx]=n,d._updateChangeReportAction(),d._updateChangeViewActions(),d._updateReportSettingsActions(),d._refreshReportSettings(),t=d._currentViewImpl(),d._updateModelRegionData(t),n=d._currentReportSettings(),d._forEachView((function(e,t){t.setReportOptions(d,e===n.currentView,n,c.changeIdentifier),t.supports.highlight&&"views.grid.highlights"!==c.changeIdentifier&&t.setReportOptions(d,e===n.currentView,n,"views.grid.highlights")})),c.refreshColumns&&t.refreshColumns(),c.refreshView?t.refresh():c.refreshModel&&(d.reportSettingsSeq+=1,c.affectsOtherViewsModels?d._forEachView((function(e,t){t.model&&t.clearModelData()})):t.clearModelData()),i&&i(),d._trigger("reportSettingsChange",null,{report:n.id})}},"view.change"===c.changeIdentifier&&(a.queue={name:"set.report.settings.replace",action:"replace"}),e.extend(l,{setReportSettings:[o]}),this._call(l,a)},_downloadReport:function(t){var o,a,r=this.options.config,d=this;o={pageItems:r.itemsToSubmit,regions:[{id:r.regionId,ajaxIdentifier:r.ajaxIdentifier,ajaxColumns:r.ajaxColumns,reportId:this._report(),view:this._view(),download:e.extend({downloadCs:r.features.download.downloadCs},t)}],salt:$v("pSalt")},(a=l(r.regionStaticId).getParentItems())&&(o.regions[0].parentItems=a),t.email?n.plugin(o,{dataType:p,loadingIndicator:d.element,loadingIndicatorPosition:"centered",success:function(e){s.showPageSuccess(j("EMAIL_SENT"))}}):n.plugin(o,{loadingIndicator:d.element,loadingIndicatorPosition:"centered",success:function(e){var t;s.showPageSuccess(j("FILE_PREPARED")),t=n.ajaxUrl({regions:[{id:r.regionId,reportId:d._report(),ajaxIdentifier:r.ajaxIdentifier,downloadFileId:e.regions[0].download.id}],salt:$v("pSalt")}),i.info("Calling URL to get file:",t),i.info("URL length:",t.length),window.open(t)}})},_saveReport:function(e,t){var n,o={},a=this,l=this.options.config;if(l.features.saveReport)return o.saveReport=e,l.features.saveReport.publicReportCs&&(o.publicReportCs=l.features.saveReport.publicReportCs),this._call(o,{success:function(e){switch(a.options.savedReports=a._defaultSavedReports({reports:e.regions[0].savedReports}),a._updateChangeReportAction(),a._updateReportSettingsActions(),a._refreshReportSettings(),a._updateModelRegionData(a._currentViewImpl()),t){case"i":case"u":switch(a._currentReportSettings().type){case w:n=j("REPORT.SAVED.DEFAULT");break;case"alternative":n=j("REPORT.SAVED.ALTERNATIVE");break;case"private":n=j("REPORT.SAVED.PRIVATE");break;case"public":n=j("REPORT.SAVED.PUBLIC")}break;case"d":n=j("REPORT.DELETED")}s.showPageSuccess(n),"d"===t&&a.refresh()}});i.warn("Unable to save report settings because the configuration disallows it.")},_getFilterValues:function(t,i,n){var o=this;return this._call({getFilterValues:{columnId:t,columnType:C,respectFilters:i}},{success:function(t){e.isFunction(n)&&n.call(o,t)}})},_updateChangeReportAction:function(){var e,t,i,n,o=[],a=this.options.config,l=this.options.savedReports,r=this.actions;if(l.length>1){for(e=0;e<l.length;e++){switch(n=(t=l[e]).name,t.type){case w:i="APEX.IG.SAVED_REPORT_DEFAULT",t.name||(n=j("PRIMARY_REPORT"));break;case"alternative":i="APEX.IG.SAVED_REPORT_DEFAULT";break;case"private":i="APEX.IG.SAVED_REPORT_PRIVATE";break;case"public":i="APEX.IG.SAVED_REPORT_PUBLIC"}o.push({group:z(i),label:n,value:t.id})}this.actions.lookup("change-report").hide=!(!a.toolbar||a.toolbar&&a.toolbar.savedReports)}else this.actions.lookup("change-report").hide=!0;this.actions.update("change-report"),r.lookup("change-report").choices=o,r.updateChoices("change-report")},_updateAction:function(e,t){this.actions.lookup(t)&&this.actions[e](t)},_toggleEnableAction:function(e,t){this._toggleAction("enable",e,t)},_toggleShowAction:function(e,t){this._toggleAction("show",e,t)},_toggleAction:function(t,i,n){var o,a=this;switch(t){case"show":o=i?"show":"hide";break;case"enable":o=i?"enable":"disable"}e.isArray(n)?e.each(n,(function(){a._updateAction(o,this)})):this._updateAction(o,n)},_updateToolbarElements:function(){var e=this.options.config.toolbar;e&&(e.searchField&&(e.columnSelection&&this._tbFindElement("column_filter_button").show(),this._tbFindElement("search_field").show()),e.actionMenu&&this._tbFindElement("actions_button").show())},_updateActions:function(){var e=this,t=this.options.config,i=t.features,n=!1,o=!1,a=!1,l=this._isCurrentlyEditable(),r=t.editable.allowedOperations,s=l&&r.create,d=l&&r[I],c=l&&(r.update||r[I]),u=t.toolbar,h=l&&(r.update||r.create)&&(!u||u&&u.editing),g=l&&(r.create||r.update||r[I])&&(!u||u&&u.save),p=!u||u&&u.searchField,m=!u||u&&u.reset,f="set"===t.pagination.type;i.saveReport&&this._updateChangeReportAction(),this._toggleShowAction(i.filter,"show-filter-dialog"),this._toggleShowAction(i.download,"show-download-dialog"),this._toggleShowAction(i.flashback,"show-flashback-dialog"),this._updateReportSettingsActions(),this._toggleShowAction(s,["selection-add-row","row-add-row","selection-duplicate","row-duplicate"]),this._toggleShowAction(d,["selection-delete","row-delete"]),this._toggleShowAction(c,["selection-revert","row-revert"]),this._toggleShowAction(h,"edit"),this._toggleShowAction(g,"save"),this._toggleShowAction(p,"search"),this._toggleShowAction(m,"reset-report"),this._forEachView((function(i,r){var c=t.views[i].features;r.supports.singleRowView&&c.singleRowView&&(n=!0),r.supports.highlight&&c.highlight&&(o=!0),r.supports.configurableColumns&&null===c.stretchColumns&&!1!==c.gridView&&(a=!0),r.updateActions({ig:e,editable:l,canDelete:d,canCreate:s,canEdit:h})})),this._toggleShowAction(n,["single-row-view","refresh-record"]),this._toggleShowAction(s&&n,["insert-record","duplicate-record"]),this._toggleShowAction(d&&n,["delete-record"]),this._toggleShowAction(c&&n,["revert-record"]),this._toggleShowAction(o,"show-highlight-dialog"),this._toggleShowAction(f,"change-rows-per-page"),this._toggleShowAction(a,"stretch-columns")},_updateReportSettingsActions:function(){var e=this._currentReportSettings(),t=this.options.config.features.saveReport,i=!e.isReadOnly;this._toggleEnableAction(t&&i&&e.baseReportId,"save-report"),this._toggleEnableAction(t,"show-save-report-as-dialog"),this._toggleEnableAction(t&&i,"show-edit-report-dialog"),this._toggleEnableAction(t&&i&&e.type!==w,"delete-report"),this._toggleEnableAction(e.baseReportId,"reset-report")},_updateChangeViewActions:function(){var e=[],t=this.actions;this._forEachView((function(t,i){i.isConfigured()&&e.push({label:i.title,value:t,icon:i.icon})})),this._toggleShowAction(e.length>1,"change-view"),t.lookup("change-view").choices=e,t.updateChoices("change-view")},_updateSelectionActions:function(){var e,t,i,n,o=this.options.config,a=this._currentViewImpl(),l=o.editable&&a.supports.edit;a.singleRowMode||(a.selectCells&&a.selectCells()?(n=a.view$.grid("getSelectedRange").recordIds.length,this._toggleEnableAction(!1,["selection-refresh"]),this._toggleEnableAction(0!==n,["selection-copy"]),l&&(this._toggleEnableAction(this._isCurrentlyEditable()&&0!==n,["selection-fill","selection-clear","selection-revert"]),this._toggleEnableAction(!1,["selection-duplicate","selection-delete","selection-revert","row-delete"]),this._toggleEnableAction(n>=2,["selection-copy-down"]))):(n=(e=a.getSelectedRecords())?e.length:0,this._toggleEnableAction(0!==n,["selection-refresh","selection-copy"]),l&&(this._toggleEnableAction(this._isCurrentlyEditable()&&0!==n,["selection-duplicate","selection-delete","selection-revert","selection-fill","selection-clear"]),o.editable.allowedOperations[I]&&(t=e.some((function(e){return a.model.allowDelete(e)})),this._toggleEnableAction(t,["row-delete","selection-delete","selection-fill","selection-clear"])),i=e.some((function(e){return a.model.canRevertRecord(e)})),this._toggleEnableAction(i,["row-revert","selection-revert"]),this._toggleEnableAction(n>=2,["selection-copy-down"]))))},_setFilterColumn:function(e){var t;this.currentFilterColumnId=e,t=e?o.formatMessage("APEX.IG.SEARCH.COLUMN",this._getColumn(e).heading.label):this.options.config.filter.oracleText?j("SEARCH.ORACLE_TEXT"):j("SEARCH.ALL_COLUMNS"),this._tbFindElement("search_field").attr({placeholder:t,title:t})},_defaultIGConfig:function(){var t,i,n=this.options.config;if(n.filter.maxRowCount&&(n.text.moreDataFound=o.formatMessage("APEX.IG.MORE_DATA_FOUND",n.filter.maxRowCount)),n.columnGroups.length>0)for(t=0;t<n.columnGroups.length;t++)(i=n.columnGroups[t]).label||(i.label=i.heading);n.editable&&(n.editable=e.extend(!0,{allowedOperations:{create:!0,update:!0,delete:!0,protected:""},autoAddRow:!0},n.editable),n.editable.allowedOperations.create||(n.editable.autoAddRow=!1)),n.features.download&&(n.features.download=e.extend({formats:[],email:!0},n.features.download)),n.views.icon&&(n.views.icon=e.extend(!0,{disabled:!1,labelColumn:"",features:{sort:!0,highlight:!0,rowSelector:{multiSelect:!0,selectAll:!1,hideControl:!1}}},n.views.icon)),n.views.detail&&(n.views.detail=e.extend(!0,{disabled:!1,beforeRows:"",row:"",afterRows:"",features:{sort:!0,controlBreak:!0}},n.views.detail))},_defaultColumns:function(){var t,i,n=this.options.config.columns;for(t=0;t<n.length;t++)(i=e.extend(!0,{id:"",name:"",staticId:"",dataType:"VARCHAR2",specialType:"",isHidden:!1,isReadOnly:!0,heading:{heading:"",label:"",alignment:"center"},layout:{columnAlignment:"start",groupId:"",useGroupFor:"both"},appearance:{columnCssClasses:"",formatExample:""},validation:{isRequired:!1,restrictedCharacters:""},link:{text:"",attributes:""},filter:{operators:[{name:"$std$"},{name:"$perform$"}],dateRanges:"all",isRequired:!1,hasLov:!0,dataType:"VARCHAR2"},accessibility:{usedAsRowHeader:!1},features:{canHide:!0,highlight:!0,compute:!0,sort:!0,controlBreak:!0,aggregate:!0,groupBy:!0},isPrimaryKey:!1,parentColumnName:"",default:{value:"",duplicate:!0},escape:!0,helpid:""},n[t])).heading.label||(i.heading.label=i.heading.heading),"VARCHAR2"!==i.filter.dataType||i.filter.textCase||(i.filter.textCase="MIXED"),n[t]=i},_createBaseColumnMap:function(){var e,t,i,n=this.options.config.columns,o=0;for(e=0;e<n.length;e++)t=n[e],i=this.baseModelColumns[t.id]={index:e-o,hidden:t.isHidden,readonly:t.isReadOnly,escape:t.escape,id:t.id,dataType:t.dataType},t.isHidden?i.canHide=!1:(i.heading=t.heading.heading,i.headingAlignment=t.heading.alignment,i.label=t.heading.label,i.alignment=t.layout.columnAlignment,t.appearance.formatMask&&(i.formatMask=t.appearance.formatMask)),t.parentColumnName&&(i.parentField=t.parentColumnName,this.parentColumnNames.push(t.parentColumnName)),this.columnMap[t.id]=t,t.isPrimaryKey&&this.primaryKeyColumns.push(t.name),"actions"===t.specialType&&(o+=1);this.baseModelColumns[k]={index:e-o,seq:e,hidden:!0,canHide:!1}},_defaultSavedReport:function(t){var n,o,a,l,r,s,d,c=this,u=this.options.config,h=u.views;function g(t,i){var n,o,a,l={};if(i){for(n=0;n<t.length;n++)l[t[n].columnId]=1;for(n=0;n<u.columns.length;n++)l[(o=u.columns[n]).id]||t.push({columnId:o.id,operation:"i",isVisible:!1})}for(n=0;n<t.length;n++)(a=e.extend({seq:null,columnType:C,columnId:"",isVisible:!0,isFrozen:!1,width:null,priority:null,break:!1,sort:!1},t[n])).seq=n+1,a.break&&(a.break=e.extend({order:null,isEnabled:!0,direction:N,nulls:L},a.break)),a.sort&&(a.sort=e.extend({order:null,direction:N,nulls:L},a.sort)),c._getColumn(a.columnId)?t[n]=a:(t.splice(n,1),n-=1)}if(!h[(o=e.extend(!0,{id:"",baseReportId:"",name:"",isCurrent:!1,type:w,isReadOnly:!0,authorizationId:"",rowsPerPage:null,showRowNumbers:!1,reportSettingsArea:"collapsed",defaultFilterColumn:!1,flashback:!1,versionNumber:"",filters:[],currentView:"grid",views:{grid:!1,chart:!1,icon:!1,detail:!1}},t)).currentView]||h[o.currentView].disabled){for(n in o.currentView=null,h)if(h.hasOwnProperty(n)&&h[n]&&!h[n].disabled){o.currentView=n;break}this.options.data=null,u.lazyLoading=!0,i.warn("Current view not available. Using view %s. Forcing lazy load.",o.currentView)}for(o.flashback&&(o.flashback=e.extend({minsAgo:null,isEnabled:!0},o.flashback)),n=0;n<o.filters.length;n++)(a=e.extend(!0,{id:"",type:_,isCaseSensitive:!1,value:"",isEnabled:!0},o.filters[n])).columnId&&!a.columnType&&(a.columnType=C),a.type!==C||this._getColumn(a.columnId)?o.filters[n]=a:(o.filters.splice(n,1),n-=1);if(o.views.grid||h.grid){for(o.views.grid=e.extend(!0,{editMode:!1,singleRowView:{excludeNullValues:!1,onlyDisplayColumns:!0},columns:[],aggregations:[],highlights:[],initialBreakState:"collapsed",stretchColumns:!0},o.views.grid),g(o.views.grid.columns,!0),n=0;n<o.views.grid.aggregations.length;n++)(l=e.extend({id:"",function:"",columnType:C,columnId:"",tooltip:"",showGrandTotal:!0,isEnabled:!0},o.views.grid.aggregations[n])).label||(l.label=l.function),this._getColumn(l.columnId)?o.views.grid.aggregations[n]=l:(o.views.grid.aggregations.splice(n,1),n-=1);for(n=0;n<o.views.grid.highlights.length;n++)(r=e.extend(!0,{id:"",name:"",type:_,columnType:C,columnId:"",backgroundColor:"",textColor:"",condition:{type:C,columnType:C,columnId:"",operator:"",isCaseSensitive:!1,value:"",expression:""},isEnabled:!0},o.views.grid.highlights[n])).type===C&&!this._getColumn(r.columnId)||r.condition.type===C&&!this._getColumn(r.condition.columnId)?(o.views.grid.highlights.splice(n,1),n-=1):o.views.grid.highlights[n]=r}if((o.views.icon||h.icon)&&(o.views.icon=e.extend(!0,{columns:[],initialBreakState:"collapsed"},o.views.icon),g(o.views.icon.columns)),(o.views.detail||h.detail)&&(o.views.detail=e.extend(!0,{columns:[],initialBreakState:"collapsed"},o.views.detail),g(o.views.detail.columns)),o.views.chart)for(s in o.views.chart=e.extend(!0,{type:B,orientation:"vertical",stack:q},o.views.chart),o.views.chart.axis&&(o.views.chart.axis=e.extend({label:"",value:"",valueDecimalPlaces:""},o.views.chart.axis)),o.views.chart.chartColumns)o.views.chart.chartColumns.hasOwnProperty(s)&&(d=o.views.chart.chartColumns[s],(d=e.extend({columnType:C},d)).sort&&(d.sort=e.extend({order:null,direction:N,nulls:L},d.sort)),o.views.chart.chartColumns[s]=d);return o},_defaultSavedReports:function(t){var i,n=!1,o=e.extend({reports:this.options.savedReports},t);for(i=0;i<o.reports.length;i++)o.reports[i]=this._defaultSavedReport(o.reports[i]),o.reports[i].isCurrent&&(n=!0,this.currentSavedReportIdx=i);return n||(this.currentSavedReportIdx=0),o.reports},_renderColumnHeaderMenu:function(t,i,n,o){function a(t,i){var n=e.extend(!0,{buttonClass:"a-IRR-button a-IRR-sortWidget-button",label:"",iconOnly:!0,icon:"",isToggle:!1,toggleState:null,attributes:{},data:{}},i);t.markup("<li").attr(M,"a-IRR-sortWidget-actions-item").markup(">"),n.isToggle&&(n.attributes["aria-pressed"]=n.toggleState,n.toggleState&&(n.buttonClass+=" is-active"),delete n.isToggle,delete n.toggleState),Ae(t,n),t.markup("</li>")}var l,r,s,d=!1,c=this._getId("column_header_search"),u=this._getColumn(o),h=this._currentReportSettings().views.grid.columns,g=0;for(t.markup("<ul").attr(M,"a-IRR-sortWidget-actions").markup(">"),u.features.controlBreak&&a(t,{label:j("CONTROL_BREAK"),icon:"icon-ig-control-break",data:{option:"break"}}),u.features.aggregate&&a(t,{label:j("AGGREGATE"),icon:"icon-ig-aggregate",data:{option:"aggregate"}}),l=0;l<h.length;l++)if(h[l].columnId===o){d=h[l].isFrozen;break}for(l=0;l<h.length;l++)h[l].isVisible&&!this._getColumn(h[l].columnId).isHidden&&h[l].seq>g&&(g=h[l].seq),h[l].columnId===o&&(s=h[l].seq);s<g&&a(t,{label:j(d?"UNFREEZE":"FREEZE"),icon:"icon-ig-frozen-column",isToggle:!0,toggleState:d,data:{option:"freeze"}}),u.features.canHide&&a(t,{label:j("HIDE"),icon:"icon-ig-remove-col",data:{option:"hide"}}),u.helpid&&a(t,{label:j("HELP"),icon:"icon-ig-help",data:{option:"help"}}),t.markup("</ul>"),i&&(t.markup("<div").attr(M,"a-IRR-sortWidget-search").markup(">"),Se(t,{labelFor:c,cssClasses:"a-IRR-sortWidget-searchLabel",label:j("SEARCH"),labelTextHidden:!0}),u.filter.textCase&&(r=this._getTextTransformClass(u)),ve(t,{id:c,cssClasses:"a-IRR-sortWidget-searchField"+(r?" "+r:""),placeholder:j("FILTER_WITH_DOTS")}),n&&(t.markup("<div").attr(M,"a-IRR-sortWidget-rows").attr("id",this._getId("column_header_menu_rows")).markup(">"),t.markup("</div>")),t.markup("</div>"))},_setOperationUpdate:function(e){e.operation&&"i"===e.operation||(e.operation="u")},_renderIG:function(){var e=this,i=this.element,n=t.htmlBuilder(),o=this.options.config,a=this._getId("summary");o.toolbar&&n.markup("<div").attr(M,"a-IG-header").markup("><div").attr("id",this._getId("toolbar")).markup(">").markup("</div></div>"),n.markup("<div").attr(M,"a-IG-body").markup(">"),o.reportSettingsArea&&this._renderReportSettings(n),n.markup("<div class='u-vh'").attr("id",a).markup("></div><div").attr(M,"a-IG-contentContainer").attr("id",this._getId("content_container")).markup(">"),this._forEachView((function(t,i){n.markup("<div").attr("id",e._getId(i.elementId)).attr(M,i.cssClass).attr("aria-labelledby",a).markup(" style='display:none'></div>")})),n.markup("</div></div>"),i.append(n.toString()),o.reportSettingsArea&&this._initReportSettings()},_resetReportSettings:function(){var e=this;this._ifNoChangesDo((function(t){if(e._currentReportSettings().baseReportId)return e._call({resetReportSettings:[e._report()]},{success:function(i){var n=e._defaultSavedReport(i.regions[0].resetReportSettings[0]);e.options.savedReports[e.currentSavedReportIdx]=n,t&&e.clearChanges(),e._report(n.id),e._updateChangeReportAction()}})}))},_openDialog:function(e,t){var i,n=this;function o(e){var t=e+"Dialog$",i="_render"+e.substr(0,1).toUpperCase()+e.substr(1)+"Dialog";return n[t]||n[i](),n[t]}function a(e,t){var i=o(e);t&&i.dialog(v,"id",t),i.dialog("open")}switch(t=t||{},e){case"columns":case A:case"sort":case T:case"controlBreak":a(e,t.id);break;case S:o(e).dialog(v,{id:t.id,columnId:t.columnId}).dialog("open");break;case R:Ve({labelKey:"APEX.IG.MINUTES_AGO",titleKey:"APEX.IG.FLASHBACK",okLabelKey:"APEX.DIALOG.SAVE",helpKey:"APEX.IG.HELP.FLASHBACK",helpTitleKey:"APEX.IG.HELP.FLASHBACK_TITLE",value:i=(i=n._currentReportSettings().flashback)?i.minsAgo:5},(function(e){!1!==e&&n.updateFlashback({isEnabled:!0,minsAgo:parseInt(e,10)})}));break;case b:this.viewsImpl[b].openDialog();break;case"editReport":o("reportSettings").dialog(v,"saveAs",!1).dialog("open");break;case"saveAsReport":o("reportSettings").dialog(v,"saveAs",!0).dialog("open");break;case"download":a(e)}},_setModel:function(t){var i,n,o,a,l,r,s,d,u,h,g,p=!1,m=!1,f=!1,_=this.options.config,C=_.pagination.showTotalRowCount,E=t.viewImpl,v=E.internalIdentifier,b=_.views[v];E.model&&(c.release(E.modelName),E.modelName=null,E.model=null),t.remove||(b.useModelFrom&&_.views[b.useModelFrom].shareModel?d=(h=(u=this.getViews(b.useModelFrom)).internalIdentifier)+"_shared":(u=E,h=v,d=b.shareModel?h+"_shared":h),(g=this._isCurrentlyEditable()&&u.supports.edit)&&(p=_.editable.allowedOperations.create,m=_.editable.allowedOperations.update,f=_.editable.allowedOperations[I]),_.parentRegionStaticId&&null===_.modelInstanceId&&(g=!1),s=_.modelInstanceId?[_.regionStaticId+"_"+d,_.modelInstanceId]:_.regionStaticId+"_"+d,E.modelName=s,E.model=c.get(s),E.model||(u.supports.totalRows||(C=!1),(i=e.extend({},_.defaultModelOptions,{recordIsArray:!0,hasTotalRecords:C,regionId:_.regionId,regionStaticId:_.regionStaticId,ajaxIdentifier:_.ajaxIdentifier,pageItemsToSubmit:_.itemsToSubmit,parentRecordId:this.parentRecordId,fields:E.modelColumns,editable:g,saveSelection:g&&_.submitSelectedRows,paginationType:"progressive",regionData:{reportId:this._report(),view:h,ajaxColumns:_.ajaxColumns}})).types||(i.types={default:{operations:{canAdd:p,canEdit:m,canDelete:f}}}),e.each(["identityField","metaField","typeField","sequenceField"],(function(e,t){E.specialColumns[t]&&(i[t]=E.specialColumns[t])})),_.parentRegionStaticId&&(this.parentModel?i.parentModel=this.parentModel:(n=e("#"+_.parentRegionStaticId+"_ig"),i.parentModel=_.parentRegionStaticId+"_"+n.interactiveGrid("getCurrentViewId"))),g&&(i.regionData.allowedOperations=_.editable.allowedOperations.protected),t.initialData?(o=t.initialData.values,a=C?t.initialData.totalRows:null,l=t.initialData.moreData,r=t.initialData.dataOverflow,E.model=c.create(s,i,o,a,l,r)):t.fetchData?E.model=c.create(s,i):E.model=c.create(s,i,[],0),this.modelReportSettingsSeq[s]=this.reportSettingsSeq),this._trigger("viewModelCreate",null,{viewId:v,model:E.model}),t.updateComponent&&(this.reportSettingsSeq>this.modelReportSettingsSeq[s]&&(this._updateModelRegionData(E),E.clearModelData()),E.setModelName(E.modelName,E.modelColumns)))},_anyChanges:function(){var e=this.editableViewImpl;return!!(e&&this._isCurrentlyEditable()&&e.model&&c.anyChanges(!1,e.model.name,!0))},_ifNoChangesDo:function(e,t){var i=this,n=this._anyChanges();t||(t=e,e=!1),n?e||setTimeout((function(){s.confirm(j("UNSAVED_CHANGES_CONTINUE_CONFIRM"),(function(e){e?(i._setEditMode(!1),t(n)):i._refreshReportSettings()}))}),1):t(n)},_clearToolbarSearch:function(){var e=this.options.config;e.toolbar&&e.toolbar.searchField&&e.toolbarData&&this._tbFindElement("search_field").val("")},_tbFind:function(e){var t=null,i=this.getToolbar();return i&&(t=i.toolbar("find",e)),t},_tbFindElement:function(t){var i=this.getToolbar();return i?i.toolbar("findElement",t):e()},resize:function(){var t,i,n,o,a=this.options.config,l=0,r=0,s=this.element,d=s.width(),c=this._currentViewImpl(),u=e(".a-IG-contentContainer",s).children().addBack();this.ignoreResizeHandler=!0,u.width(d),a.maxHeight&&(t=s.height(),n=e(".a-IG-header",s),o=e(".a-IG-controlsContainer",s),n.filter(":visible").length>0&&(l=n.outerHeight()),o.filter(":visible").length>0&&(r=o.outerHeight()),i=t-(l+r),u.height(i)),e.apex.stickyWidget&&s.find(".a-IG-header.js-stickyWidget-toggle").stickyWidget("refresh"),c&&c.view$&&c.resize(),this.ignoreResizeHandler=!1},refresh:function(){var e=this;this._ifNoChangesDo((function(){e._forEachView((function(e,t){t.model&&t.clearModelData()}))}))},clearChanges:function(){var e;this.editableViewImpl&&(e=this.editableViewImpl.model)&&e.isChanged()&&e.clearChanges()},setMasterRecord:function(e,t){this.options.config.parentRegionStaticId?(this.parentModel=e.modelId(),t?this._setModelInstance(e.getRecordId(t),e,t):this._setModelInstance(null)):i.warn("No master region defined.")},gotoCell:function(e,t,i){var n;this._view()!==this.editableView&&this._view(this.editableView),n=this._currentViewImpl(),e&&this._setModelInstance(e),n.gotoCell&&n.gotoCell(t,i)},getActions:function(){return this.actions},getToolbar:function(){return this.toolbar$},getSelectedRecords:function(){var e=this._currentViewImpl();return e.supports.selection?e.getSelectedRecords():null},setSelectedRecords:function(e,t,i){var n,o,a,l,r=this._currentViewImpl();if(r.supports.selection){if(e.length&&"string"==typeof e[0])for(l=r.model,o=e,e=[],n=0;n<o.length;n++)(a=l.getRecord(o[n]))&&e.push(a);r.setSelectedRecords(e,t,i)}},getReports:function(e){var t,n=this.options.savedReports;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No report exists with ID: ",e)},addReport:function(t,n){var o=e.extend(t,{operation:"i",isEnabled:!0}),a=e.extend({save:!0},n);this.options.config.features.saveReport?(this.getReports().push(o),a.save&&this._saveReport(o,"i")):i.warn("Unable to add report settings because the configuration disallows it.")},updateReport:function(t,n,o){var a,l,r=this.getReports(),s=e.extend({save:!0},o);if(this.options.config.features.saveReport){for(a=0;a<r.length;a++)if((l=r[a]).id===t){this._setOperationUpdate(n),l=e.extend(!0,l,n);break}s.save&&this._saveReport(l,"u")}else i.warn("Unable to update report settings because the configuration disallows it.")},deleteReport:function(t,n){var o={},a=e.extend({save:!0},n);this.options.config.features.saveReport?(o.id=t,o.operation="d",a.save&&this._saveReport(o,"d")):i.warn("Unable to delete report settings because the configuration disallows it.")},getFilters:function(e){var t,n=this._currentReportSettings().filters;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No filter exists with ID: ",e)},addFilter:function(t,i){var n=this,o=e.extend(t,{operation:"i",isEnabled:!0}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){o.columnName&&(o.columnId=n._getColumnByName(o.columnName).id,delete o.columnName),n.getFilters().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateFilter:function(t,i,n){var o=this,a=this.getFilters(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,A);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i);break}l.save&&o._setReportSettings({refreshModel:l.refreshData,affectsOtherViewsModels:!0},(function(){o._focusOnSettingsCheckbox(r,t,A)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteFilter:function(t,i){var n=this,o=this.getFilters(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:"d"});break}a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getHighlights:function(e){var t,n=this._getCurrentView().highlights;if(!e)return n;for(t=0;t<n.length;t++)if(n[t].id===e)return n[t];i.warn("No highlight exists with ID: ",e)},addHighlight:function(t,i){var n=this,o=e.extend(t,{operation:"i",isEnabled:!0}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){o.columnName&&(o.columnId=n._getColumnByName(o.columnName).id,delete o.columnName),n.getHighlights().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateHighlight:function(t,i,n){var o=this,a=this.getHighlights(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,T);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i),i.type===_&&(delete a[n].columnId,delete a[n].columnType);break}l.save&&o._setReportSettings({refreshModel:l.refreshData,affectsOtherViewsModels:!0},(function(){o._focusOnSettingsCheckbox(r,t,T)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteHighlight:function(t,i){var n=this,o=this.getHighlights(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:"d"});break}a.save&&n._setReportSettings({refreshModel:a.refreshData,affectsOtherViewsModels:!0})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getAggregates:function(){var e=[];return this._currentViewImpl().supports.aggregation&&(e=this._getCurrentView().aggregations),e},addAggregate:function(t,i){var n=this,o=e.extend(t,{operation:"i"}),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){n.getAggregates().push(o),a.save&&n._setReportSettings({refreshModel:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateAggregate:function(t,i,n){var o=this,a=this.getAggregates(),l=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n);function r(){var n,r=o._isSettingsCheckboxFocused(t,S);for(n=0;n<a.length;n++)if(a[n].id===t){o._setOperationUpdate(i),a[n]=e.extend(!0,a[n],i);break}l.save&&o._setReportSettings({refreshModel:l.refreshData},(function(){o._focusOnSettingsCheckbox(r,t,S)}))}l.skipNoChangesCheck?r():this._ifNoChangesDo(r)},deleteAggregate:function(t,i){var n=this,o=this.getAggregates(),a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function l(){var i;for(i=0;i<o.length;i++)if(o[i].id===t){o[i]=e.extend(!0,o[i],{operation:"d"});break}a.save&&n._setReportSettings({refreshModel:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},getFlashback:function(){return this._currentReportSettings().flashback},addFlashback:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function a(){n._currentReportSettings().flashback=e.extend(t,{isEnabled:!0}),n._setOperationUpdate(n._currentReportSettings()),o.save&&n._setReportSettings({refreshModel:o.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},updateFlashback:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i);function a(){var i=n._isSettingsCheckboxFocused("",R);n._setOperationUpdate(n._currentReportSettings()),n._currentReportSettings().flashback=e.extend(n._currentReportSettings().flashback,t),o.save&&n._setReportSettings({refreshModel:o.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"},(function(){n._focusOnSettingsCheckbox(i,"",R)}))}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},deleteFlashback:function(t){var i=this,n=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},t);function o(){i._setOperationUpdate(i._currentReportSettings()),i._currentReportSettings().flashback=!1,n.save&&i._setReportSettings({refreshModel:n.refreshData,affectsOtherViewsModels:!0,changeIdentifier:"editable"})}n.skipNoChangesCheck?o():this._ifNoChangesDo(o)},addControlBreak:function(t,i,n){var o=this,a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n||{});function l(){var n,l,r=0,s=o._getCurrentView().columns;for(n=0;n<s.length;n++)if(s[n].columnId===t.id){l=s[n];break}if(!i.order){for(n=0;n<s.length;n++)s[n].break&&r++;i.order=r+1}l=e.extend(!0,l,{isVisible:!i.isEnabled,break:{order:i.order,isEnabled:i.isEnabled,direction:i.direction,nulls:i.nulls}}),o._setOperationUpdate(l),i.isEnabled&&o._adjustControlBreakSort(),i.isEnabled?e.extend(t,{controlBreakIndex:i.order,controlBreakDirection:i.direction,hidden:!0}):e.extend(t,{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),a.save&&o._setReportSettings({refreshModel:a.refreshData,refreshColumns:a.refreshData})}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},updateControlBreak:function(t,i,n){var o=this,a=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},n||{});function l(){var n,l,r=o._getCurrentView().columns,s=o._isSettingsCheckboxFocused(t,"controlBreak");for(n=0;n<r.length;n++)if(r[n].columnId===t){l=r[n];break}l=e.extend(!0,l,{isVisible:!i.isEnabled,break:{order:i.order,isEnabled:i.isEnabled,direction:i.direction,nulls:i.nulls}}),o._setOperationUpdate(l),i.isEnabled?e.extend(o._currentViewImpl().modelColumns[o._getColumn(t).name],{controlBreakIndex:l.break.order,controlBreakDirection:l.break.direction,hidden:!0}):e.extend(o._currentViewImpl().modelColumns[o._getColumn(t).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),o._adjustControlBreakSort(),a.save&&o._setReportSettings({refreshModel:a.refreshData,refreshColumns:a.refreshData},(function(){o._focusOnSettingsCheckbox(s,t,"controlBreak")}))}a.skipNoChangesCheck?l():this._ifNoChangesDo(l)},deleteControlBreak:function(t,i){var n=this,o=e.extend({save:!0,refreshData:!0,skipNoChangesCheck:!1},i||{});function a(){var i,a,l=n._getCurrentView().columns;for(i=0;i<l.length;i++)if(l[i].columnId===t){a=l[i];break}a=e.extend(!0,a,{isVisible:!0,break:!1}),n._setOperationUpdate(a),e.extend(n._currentViewImpl().modelColumns[n._getColumn(t).name],{controlBreakIndex:0,controlBreakDirection:null,hidden:!1}),n._adjustControlBreakSort(),o.save&&n._setReportSettings({refreshModel:o.refreshData,refreshColumns:o.refreshData})}o.skipNoChangesCheck?a():this._ifNoChangesDo(a)},getSorts:function(){var t,i,n,o=[],a=this._getCurrentView().columns;for(t=0;t<a.length;t++)(i=a[t]).sort&&(n=e.extend({},{columnId:i.columnId,order:i.sort.order,direction:i.sort.direction,nulls:i.sort.nulls}),o.push(n));for(o.length>0&&(o=o.sort((function(e,t){return e.order-t.order}))),t=0;t<o.length;t++)delete o[t].order;return o},setSorts:function(e){var t,i,n,o,a,l,r,s=this,d=this.options.config,c=this._currentViewImpl(),u=c.internalIdentifier,h=d.views[u],g=this._getCurrentView().columns,p=null;this._ifNoChangesDo((function(){for(h.useModelFrom&&d.views[h.useModelFrom].shareModel&&(c=s.getViews(h.useModelFrom)),c.supports.configurableColumns&&(p=c.getColumns()),i=0;i<e.length;i++){for(a=e[i],o=!1,t=0;t<g.length;t++)if(l=g[t],a.columnId===l.columnId){o=!0;break}o||g.push({columnId:a.columnId,operation:"i",columnType:C,isVisible:!1,isFrozen:!1})}for(t=0;t<g.length;t++){if(l=g[t],o=!1,p)for(n=0;n<p.length;n++)if(l.columnId===p[n].id){r=p[n];break}for(i=0;i<e.length;i++)if((a=e[i]).columnId===l.columnId){o=!0,a.order=i+1;break}o?(delete a.columnId,l.sort&&a.order===l.sort.order&&a.direction===l.sort.direction&&a.nulls===l.sort.nulls||(l.sort=a,s._setOperationUpdate(l),r&&(r.sortIndex=l.sort.order,r.sortDirection=l.sort.direction))):l.sort&&(l.sort=!1,s._setOperationUpdate(l),r&&(r.sortIndex=null,r.sortDirection=null))}s._adjustControlBreakSort(),s._setReportSettings({refreshModel:!0,refreshColumns:!0}),c!==s._currentViewImpl()&&(c.refreshColumns(),c.refresh())}))},getChart:function(){return this._currentReportSettings().views.chart},setChart:function(t){var i,n=this,o=this.getChart(),a=this._currentViewImpl(),l={};o?(i=e.extend(o,t),this._setOperationUpdate(i)):i=e.extend({operation:"i"},t),this._currentReportSettings().views.chart=i,this._view()===b?(l.ig=this,l.igConfig=this.options.config,a.initView(l),this._setReportSettings({refreshView:!0,refreshModel:!0})):this._setReportSettings({},(function(){n._view(b,{fetchData:!0})}))},deleteChart:function(){var e=this,t=this._currentViewImpl();this._currentReportSettings().views.chart={operation:"d"},this._setReportSettings({},(function(){t.destroyView(e),t.view$=null}))},getViews:function(e){return e?this.viewsImpl[e]:this.viewsImpl},getCurrentView:function(){return this.getViews(this.getCurrentViewId())},getCurrentViewId:function(){return this._view()},focus:function(){var e=this.options.config;e.toolbar&&e.toolbar.searchField&&this.toolbar$?this._tbFindElement("search_field").focus():this._currentViewImpl().focus()}}),e.apex.interactiveGrid.copyDefaultToolbar=ce;var De=[];function xe(e){De.push(e)}e.apex.interactiveGrid.registerView=xe;var Ge=["selection-fill","selection-clear","selection-copy-down"],He={setColumnConfig:function(i){var n,o,a,l,r,s,c,u,h={},g=i.baseModelColumns,p=i.igConfig,m=p.views[this.internalIdentifier].features,f=i.currentReportSettings,_=i.ig,C=N,I=!1!==p.editable;for(n=0;n<f.views.grid.columns.length;n++)o=f.views.grid.columns[n],a=_._getColumn(o.columnId),(c=e.extend(!0,{},a.defaultGridColumnOptions||{},g[o.columnId])).elementId=a.staticId,c.seq=o.seq,void 0===c.noStretch&&(void 0!==a.layout.noStretch?c.noStretch=a.layout.noStretch:null!==m.stretchColumns?c.noStretch=!m.stretchColumns:c.noStretch=!f.views.grid.stretchColumns),a.isHidden||(c.hidden=!o.isVisible,c.frozen=o.isFrozen,o.width&&(c.width=o.width),o.sort&&(c.sortIndex=o.sort.order,c.sortDirection=o.sort.direction),(s=o.break)&&s.isEnabled&&(C=s.direction,c.controlBreakIndex=s.order,c.controlBreakDirection=C),a.layout.groupId&&("both"===a.layout.useGroupFor?c.useGroupFor="srv,heading":c.useGroupFor=a.layout.useGroupFor,c.groupName=a.layout.groupId),c.helpid=a.helpid,c.canHide=a.features.canHide,c.canSort=a.features.sort,a.link.attributes&&(c.linkAttributes=a.link.attributes),a.link.text&&(c.linkText=a.link.text),a.link.targetColumn&&(c.linkTargetColumn=a.link.targetColumn)),a.accessibility.usedAsRowHeader&&(c.usedAsRowHeader=a.accessibility.usedAsRowHeader),a.appearance.columnCssClasses&&(c.columnCssClasses=a.appearance.columnCssClasses),a.appearance.fieldColSpan&&(c.fieldColSpan=a.appearance.fieldColSpan),a.appearance.fieldCssClasses&&(c.fieldCssClasses=a.appearance.fieldCssClasses),a.validation&&(c.isRequired=a.validation.isRequired),a.appearance.cellTemplate&&(c.cellTemplate=a.appearance.cellTemplate),I&&(c.noCopy=!a.default.duplicate,void 0===c.defaultValue&&(u=a.default.value,e.isPlainObject(u)&&void 0!==u.d&&c.elementId&&(u.d=d(c.elementId).displayValueFor(u.d)),c.defaultValue=u)),"actions"===a.specialType&&(r="a-Button--noLabel a-Button--iconTextButton a-Button--actions js-menuButton",Ae(l=t.htmlBuilder(),{label:j("ROW_ACTIONS"),buttonClass:r,iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":_._getId("row_actions_menu"),"aria-haspopup":!0,"aria-expanded":!1}}),c.cellTemplate=l.toString(),l.clear(),Ae(l,{label:j("SEL_ACTIONS"),buttonClass:r+" js-selectionMenu",iconOnly:!0,icon:"icon-ig-actions",attributes:{"data-menu":_._getId("selection_actions_menu"),"aria-haspopup":!0,"aria-expanded":!1}}),c.heading=l.toString(),c.columnCssClasses?c.columnCssClasses+=" has-button":c.columnCssClasses="has-button",c.headingCssClasses?c.headingCssClasses+=" has-button":c.headingCssClasses="has-button",delete c.index,c.virtual=!0,c.noHeaderActivate=!0,c.elementId=null,0===n&&(c.frozen=!0,o.isFrozen=!0),c.noStretch=!0,c.canSort=!1,c.width||(c.width=42)),h[a.name]=c;h[k]=g[k],this.modelColumns=h,this.specialColumns={identityField:0===_.primaryKeyColumns.length?null:_.primaryKeyColumns,metaField:k}},init:function(e){var t=e.options.config;e.getActions().add([{name:"selection-copy-down",labelKey:"APEX.IG.COPY_DOWN",icon:"icon-ig-copy-down",hide:!0,action:function(){var t=e._currentViewImpl();t.singleRowMode||t.view$.grid("copyDownSelection")}},{name:"selection-clear",labelKey:"APEX.IG.CLEAR",icon:"icon-ig-clear",hide:!0,action:function(){var t=e._currentViewImpl();t.singleRowMode||t.view$.grid("fillSelection","")}},{name:"selection-fill",labelKey:"APEX.IG.FILL",icon:"icon-ig-fill",hide:!0,getFillValue:function(e){Ve({labelKey:"APEX.IG.FILL_LABEL",titleKey:"APEX.IG.FILL_TITLE"},e)},action:function(){var t=e._currentViewImpl();t.singleRowMode||this.getFillValue((function(e){!1!==e&&t.view$.grid("fillSelection",e)}))}}]),this._initMenus(t,e)},initView:function(i){var n,o,a,l,d,c,u,h=null,g=t.htmlBuilder(),p=!0,m=i.igConfig,f=m.defaultGridViewOptions.multiple,_=m.defaultGridViewOptions.selectAll,I=m.views.grid.features,b=!1,w=m.defaultGridViewOptions.rowHeader||y,A=i.ig,T=A.actions,R=A._isCurrentlyEditable(),O=m.columnGroups,k=!!R&&m.editable.autoAddRow,D=this,x=!0,G=null,H=null;function P(e,t){A.editMode=t.editMode,A.actions.update("edit"),A._trigger("modeChange",e,t)}function B(e,t){return void 0!==e?e:t}function X(e){G.hide(),H.removeClass("is-active").attr("aria-expanded","false"),e&&(H.focus(),D.view$.grid("focus")),H=null,A._off(A.document,"mousedown"),A._off(A.window,"blur"),A._off(G)}function q(){var e,t,i,n=A._currentReportSettings().views.grid.columns,o=D.view$.grid("getColumns"),a=0,l=!1,r=!1;for(e=0;e<n.length;e++)n[e]&&n[e].isVisible&&!A._getColumn(n[e].columnId).isHidden&&n[e].seq>a&&(a=n[e].seq,l=e);if(!1!==l){for(t=n[l],e=0;e<o.length;e++)t.columnId!==o[e].id||o[e].hidden||(i=o[e]);t.isFrozen&&(t.isFrozen=!1,i.frozen=!1,r=!0,A._setOperationUpdate(t))}r?A._setReportSettings({refreshView:!0,refreshColumns:!0}):(A._setReportSettings(),D.singleRowView$&&D.singleRowView$.recordView("refreshFields").recordView("refresh"))}if(!I.gridView&&!I.singleRowView)throw new Error("Interactive Grid grid view must have at least one of grid or single row");switch(e("div.a-GV-columnItemContainer",i.ig$).appendTo(i.ig$),I.gridView&&(g.markup("<div").attr(M,"a-IRR-sortWidget").attr("style","display:none;").attr("id",A._getId("column_header_menu")).markup(">").markup("</div>"),G=e(g.toString()),e("body").append(G),(u=i.currentReportSettings.views.grid.aggregations).length>0&&(w!==y&&"plain"!==w||(w=V))),I.rowSelector&&(w===y&&(w="plain"),b=!I.rowSelector.hideControl,void 0===f&&(f=I.rowSelector.multiSelect),f&&void 0===_&&(_=I.rowSelector.selectAll)),m.headingFixedTo){case y:p=!1,l=!1,d=!1;break;case"region":p=!0,l=!1,d=!1;break;case"page":p=!1,l=function(){return r.defaultStickyTop()+(e(".a-IG-header",i.ig$).outerHeight()||0)},d=m.defaultGridViewOptions.stickyFooter||!0}if(O.length)for(h={},n=0;n<O.length;n++)h[(o=e.extend({},O[n])).id]=o,delete o.id;I.gridView?(m.defaultGridViewOptions.contextMenu&&!m.defaultGridViewOptions.contextMenu.hasOwnProperty("actionsContext")&&(m.defaultGridViewOptions.contextMenu.actionsContext=A.actions),m.editable&&!1===m.editable.allowedOperations.create&&!1===m.editable.allowedOperations.update&&(x=!1),c={modelName:D.modelName,editable:R,autoAddRecord:k,rowHeader:w,rowHeaderCheckbox:b,aggregateLabels:this._gridAggregateLabels(),highlights:this._gridHighlightsFromReport(i.currentReportSettings),multiple:f,selectAll:_,noDataMessage:m.text.noDataFound,moreDataMessage:m.text.moreDataFound,showNullAs:m.appearance.showNullValue,columns:[D.modelColumns],columnSort:I.sort,reorderColumns:B(m.defaultGridViewOptions.reorderColumns,I.reorderColumns),resizeColumns:B(m.defaultGridViewOptions.resizeColumns,I.resizeColumns),pagination:A._getPaginationConfig(m,"defaultGridViewOptions"),rowsPerPage:i.currentReportSettings.rowsPerPage,hasSize:p,stickyTop:l,stickyFooter:d,allowEditMode:x,persistSelection:m.defaultGridViewOptions.persistSelection||m.submitSelectedRows,activateColumnHeader:function(i,n){var o,a,l,d,c,u,h,g=[],p=t.htmlBuilder();function m(i){var n,o,a,l=t.htmlBuilder();for(n=0;n<i.length;n++)e.isPlainObject(i[n])?(o=i[n].r,a=i[n].d):o=a=i[n],Re(l,{cssClasses:"a-IRR-sortWidget-row",text:a,data:{"return-value":o}});A._getElement("column_header_menu_rows").html(l.toString())}function f(e){var t=G.find(":focusable");e||(o=t.first()).data("first",!0),(a=t.last()).data("last",!0)}G.is(":visible")?X():((l=A._isColumnFilterable(n.column.id))&&(d=A._hasColumnFilterLov(n.column.id)),H=n.header$,n.header$.addClass("is-active").attr("aria-expanded","true"),A._renderColumnHeaderMenu(p,l,d,n.column.id),c>220?(u=n.column.frozen?2:1,c=n.header$.outerWidth(),G.css("min-width",c-u)):G.css("min-width","0"),h=A.isRTL?"right":"left",G.html(p.toString()).show().css({left:0,top:0}).position({my:h+" top",at:h+" bottom",of:n.header$,collision:"fit"}),d?A._getFilterValues(n.column.id,!0,(function(e){e.regions[0].filterValues&&(A._getElement("column_header_search").focus(),m(g=e.regions[0].filterValues),f())})):(f(),o.focus()),A._on(G,{"click button.a-IRR-sortWidget-button":function(t){var i,o,a,l=N;switch(e(t.currentTarget).data(v)){case"hide":D.view$.grid("hideColumn",n.column),A._currentViewColumn(n.column.id,{isVisible:!1}),q(),X(!0);break;case"break":(i=A._currentViewColumn(n.column.id)).sort&&(l=i.sort.direction),A.addControlBreak(n.column,{isEnabled:!0,direction:l}),X(!0);break;case"aggregate":A._openDialog(S,{columnId:n.column.id}),X();break;case"freeze":if(o=A._currentReportSettings().views.grid.columns,D.view$.grid(n.column.frozen?"unfreezeColumn":"freezeColumn",n.column),n.column.frozen)for(a=0;a<o.length;a++)(i=o[a]).seq<=n.column.seq&&!i.isFrozen&&(i.isFrozen=!0,A._setOperationUpdate(i));else for(a=0;a<o.length;a++)(i=o[a]).seq>=n.column.seq&&i.isFrozen&&(i.isFrozen=!1,A._setOperationUpdate(i));A._setReportSettings(),X(!0);break;case"help":X(!0),r.popupFieldHelp(A._getColumn(n.column.id).helpid,$v("pInstance"))}},keydown:function(t){var i;t.which===e.ui.keyCode.ESCAPE?(X(!0),t.preventDefault()):t.which===e.ui.keyCode.TAB&&(!(i=!!t.shiftKey)&&e(t.target).data("last")&&(t.preventDefault(),o.focus()),i&&e(t.target).data("first")&&(t.preventDefault(),a.focus()))},"keydown input.a-IRR-sortWidget-searchField":function(t){var i,o;if(l&&t.which===e.ui.keyCode.ENTER){if((o=this._getColumn(n.column.id).filter.dataType)===F)try{i=apex.jQuery.timepicker.parseDateString(e(t.target).val(),this._getColumn(n.column.id).appearance.dateFormatMask),A.addFilter({type:C,columnType:C,columnId:n.column.id,operator:"EQ",value:fe(i),isCaseSensitive:!1})}catch(e){s.alert(j("INVALID_DATE_FORMAT"))}else A.addFilter({type:C,columnType:C,columnId:n.column.id,operator:"VARCHAR2"===o?"C":"EQ",value:e(t.target).val(),isCaseSensitive:!1});X(!0),t.preventDefault()}},"keyup input.a-IRR-sortWidget-searchField":function(e){if(d){var t=e.target.value;m(g.filter((function(e){return e.d?e.d.toLowerCase().indexOf(t.toLowerCase())>-1:e.toLowerCase().indexOf(t.toLowerCase())>-1}))),f(!0)}},"click a.a-IRR-sortWidget-row":function(t){var i,o,a,l,r=e(t.currentTarget).data("returnValue");d&&((i=A._getColumn(n.column.id).filter.dataType)===F||i.indexOf(U)>-1?(o=r.indexOf("~"),a=r.substring(0,o),l=r.substring(o+1),o>0&&A.addFilter({type:C,columnType:C,columnId:n.column.id,operator:a,value:l,isCaseSensitive:!1})):A.addFilter({type:C,columnType:C,columnId:n.column.id,operator:"EQ",value:r,isCaseSensitive:!0}),X(!0),t.preventDefault())}}),A._on(A.document,{mousedown:function(t){!e(t.target).closest(G).length>0&&!e(t.target).closest(n.header$).length>0&&G.is(":visible")&&X()}}),A._on(A.window,{blur:function(){G.is(":visible")&&X()}}))},cancelColumnHeader:function(){G.is(":visible")&&X()},sortChange:function(e,t){A._ifNoChangesDo((function(){var e,i,n,o,a,l=t.column.sortIndex,r=D.view$.grid("getColumns");for(n=1,e=0;e<r.length;e++)(i=r[e]).sortIndex&&("change"===t.action?i===t.column&&(n=i.sortIndex):"add"===t.action?i.sortIndex>=n&&(n=i.sortIndex+1):"remove"===t.action?i===t.column?(delete i.sortIndex,delete i.sortDirection,(o=A._currentViewColumn(t.column.id)).sort=!1,A._setOperationUpdate(o)):i.sortIndex>l&&(i.sortIndex-=1,A._currentViewColumn(i.id,{sort:{order:i.sortIndex}})):"clear"!==t.action&&"set"!==t.action||(delete i.sortIndex,delete i.sortDirection,(o=A._currentViewColumn(i.id)).sort=!1,A._setOperationUpdate(o)));"clear"!==t.action&&"remove"!==t.action&&(t.column.sortIndex=n,t.column.sortDirection=t.direction,a=t.direction===N?L:"first",A._currentViewColumn(t.column.id,{sort:{order:n,direction:t.direction,nulls:a}})),A._setReportSettings({refreshModel:!0,refreshColumns:!0})}))},columnReorder:function(e,t){var i,n,o,a,l,r=A._currentReportSettings().views.grid.columns,s=r[t.newPosition].isFrozen;for(o=r,a=t.oldPosition,l=t.newPosition,o.splice(l,0,o.splice(a,1)[0]),r[t.newPosition]&&(r[t.newPosition].isFrozen=s),i=0;i<r.length;i++)r[i]||r.splice(i,1);for(i=0;i<r.length;i++)(n=r[i]).seq!==i+1&&(n.seq=i+1,A._setOperationUpdate(n));q()},columnResize:function(e,t){A._currentViewColumn(t.column.id,{width:t.width}),A._setReportSettings()},modeChange:P,selectionChange:function(t){var i=D.view$.grid("getSelection");e(".js-selectionMenu",D.view$).prop(E,0===i.length),D._selectionChange(A,t)},pageChange:function(e,t){A._pageChange(t)}},u.length>0&&(c.aggregateTooltips=this._gridAggregateTooltipsFromReport(A,i.currentReportSettings)),h&&(c.columnGroups=h),D.view$.grid({},m.defaultGridViewOptions,c),D.curInst=D.view$.grid("instance")):(D.view$.hide(),D.singleRowMode=!0),D.supports.singleRowView&&I.singleRowView&&(D.singleRowView$=e("<div id='"+A._getId("singleRow_vc")+"' class='a-IG-recordView'></div>").attr("aria-labelledby",A._getId("summary")),D.view$.after(this.singleRowView$),D.singleRowView$.width(D.view$.width()),m.maxHeight&&D.singleRowView$.height(D.view$.height()),(a=e.apex.recordView.copyDefaultToolbar())[0].controls.unshift({type:"MENU",labelKey:"APEX.IG.SRV_CHANGE_MENU",iconOnly:!0,icon:"icon-ig-actions",menuId:A._getId("srv_actions_menu")}),I.gridView&&(T.remove(["close-single-row-view"]),T.add([{name:"close-single-row-view",labelKey:"APEX.IG.REPORT_VIEW",action:function(){var e,t=A.editMode;return t&&D.singleRowView$.recordView("setEditMode",!1),D.singleRowMode=!1,D.singleRowView$.hide(),D.curInst=D.view$.grid("instance"),A._updateSummary(),(e=A._tbFind("selection_submenu"))&&(e.disabled=!D.supports.selection),D.view$.show().grid("resize"),t&&D.view$.grid("setEditMode",!0),D.view$.grid("focus"),!0}}]),a[0].controls.unshift({type:"BUTTON",action:"close-single-row-view"})),D.singleRowView$.recordView({},m.defaultSingleRowOptions,{modelName:D.modelName,actionsContext:T,toolbar:a,editable:R,autoAddRecord:k,noDataMessage:m.text.noDataFound,moreDataMessage:m.text.moreDataFound,showNullAs:m.appearance.showNullValue,fields:[D.modelColumns],fieldGroups:h,hasSize:p,modeChange:P,recordChange:function(e){D._selectionChange(A,e)}}),I.gridView?(D.singleRowView$.hide(),D.singleRowMode=!1):D.curInst=D.singleRowView$.recordView("instance"))},viewChanged:function(e,t,i){t._toggleEnableAction(e&&i.editable&&this.supports.edit,Ge),e&&this._selectionChange(t)},updateActions:function(e){var t=e.ig,i=t.options.config;t._toggleShowAction(e.canEdit&&this.supports.edit&&this.supports.cellSelection&&i.views.grid.features.cellRangeActions,Ge)},setReportOptions:function(e,t,i,n){var o,a=this,l=e.options.config;(o={"views.grid.aggregations":function(){a._hasGridView()&&a.view$.grid(v,"aggregateTooltips",a._gridAggregateTooltipsFromReport(e,i))},"views.grid.highlights":function(){a._hasGridView()&&a.view$.grid(v,"highlights",a._gridHighlightsFromReport(i))},"views.grid.columns":function(){var t,n,o,r,s,d,c=l.views.grid.features,u=i.views.grid.columns,h=a.getColumns(),g=!1!==c.gridView,p=!1;for(t=0;t<u.length;t++)for(s=u[t],o=e._getColumn(s.columnId),n=0;n<h.length;n++)if((r=h[n]).id===s.columnId){g&&(d=r.noStretch,void 0!==o.defaultGridColumnOptions&&void 0!==o.defaultGridColumnOptions.noStretch||(void 0!==o.layout.noStretch?r.noStretch=o.layout.noStretch:null!==c.stretchColumns?r.noStretch=!c.stretchColumns:r.noStretch=!i.views.grid.stretchColumns),r.noStretch!==d&&(p=!0)),r.hidden===s.isVisible&&r.canHide&&(r.hidden=!s.isVisible,p=!0);break}p&&(a.refreshColumns(),a.refresh())},editable:function(){var t=e._isCurrentlyEditable();a.model.getOption("identityField")&&a.model.setOption("editable",t),a.singleRowView$&&(a.singleRowView$.recordView(v,"editable",t),a.singleRowView$.recordView(v,"autoAddRecord",t)),a._hasGridView()&&(a.view$.grid(v,"editable",t),a.view$.grid(v,"autoAddRecord",t)),e._updateActions()},rowsPerPage:function(){a._hasGridView()&&(a.view$.grid(v,"rowsPerPage",i.rowsPerPage),t||(a.pendingRefresh=!0))}})[n]&&a.view$&&o[n]()},_selectionChange:function(e,t){t&&e._selectionChange(t)},_initMenus:function(t,i){var n=null,o=null,a=null,l=this,r=t.views.grid.features,s=[],d=[],c=[],u=i._tbFind("selection_submenu");function h(e){c.push(e),u&&u.push(e)}u&&(u=u.menu.items,l._selectionMenuItems=u,l._selectionMenuStart=u.length),c.push({type:D,action:"selection-copy",accelerator:"Ctrl+C"}),c.push(x),n=e("<div/>",{id:i._getId("row_actions_menu")}).appendTo("body"),o=e("<div/>",{id:i._getId("srv_actions_menu")}).appendTo("body"),a=e("<div/>",{id:i._getId("selection_actions_menu")}).appendTo("body"),l.supports.singleRowView&&(s.push({id:"srv",type:D,action:"single-row-view"}),s.push(x)),t.editable&&(t.editable.allowedOperations.create&&(s.push({id:"ins",type:D,action:"row-add-row"}),d.push({id:"ins",type:D,label:t.text.addRowButton,action:"insert-record"}),s.push({id:"dup",type:D,action:"row-duplicate"}),d.push({id:"dup",type:D,action:"duplicate-record"}),h({id:"dup",type:D,action:"selection-duplicate"}),s.push(x),h(x)),(t.editable.allowedOperations[I]||t.editable.allowedOperations.create)&&(s.push({id:"del",type:D,action:"row-delete"}),d.push({id:"del",type:D,action:"delete-record"})),t.editable.allowedOperations[I]&&h({id:"del",type:D,action:"selection-delete"})),s.push(x),s.push({id:"refresh",type:D,action:"row-refresh"}),d.push({id:"refresh",type:D,action:"refresh-record"}),h(x),h({id:"refresh",type:D,action:"selection-refresh"}),t.editable&&((t.editable.allowedOperations.update||t.editable.allowedOperations[I])&&(s.push({id:"revert",type:D,action:"row-revert"}),d.push({id:"revert",type:D,action:"revert-record"}),h({id:"revert",type:D,action:"selection-revert"})),r.cellRangeActions&&(h(x),h({id:"copy_down",type:D,action:"selection-copy-down"}),h({id:"fill",type:D,action:"selection-fill"}),h({id:"clear",type:D,action:"selection-clear"}))),n.menu({actionsContext:i.actions,items:s,beforeOpen:function(){var e,o=l.view$.find(".js-menuButton.is-active").closest("tr");l.singleRowMode?(i._updateAction("hide","single-row-view"),e=l.getSelectedRecords()):e=l.view$.grid("getRecords",[o]),t.editable&&(t.editable.allowedOperations.create&&(n.menu("find","dup").disabled=!l.model.allowAdd(null,"copy"),n.menu("find","ins").disabled=!l.model.allowAdd(null,"new")),(t.editable.allowedOperations.update||t.editable.allowedOperations[I])&&i._toggleEnableAction(l.model.canRevertRecord(e[0]),["row-revert"]),t.editable.allowedOperations[I]||i._toggleShowAction(l.model.allowDelete(e[0]),"row-delete"),t.editable.allowedOperations[I]&&i._toggleEnableAction(l.model.allowDelete(e[0]),["row-delete"]))},afterClose:function(){l.singleRowMode&&i._updateAction("show","single-row-view"),i._updateSelectionActions()}}),o.menu({actionsContext:i.actions,items:d,beforeOpen:function(){var e=l.getSelectedRecords();t.editable&&(t.editable.allowedOperations.create&&(o.menu("find","dup").disabled=!l.model.allowAdd(null,"copy"),o.menu("find","ins").disabled=!l.model.allowAdd(null,"new")),(t.editable.allowedOperations.update||t.editable.allowedOperations[I])&&(o.menu("find","revert").disabled=!e.length||!l.model.canRevertRecord(e[0])),t.editable.allowedOperations[I]||i._toggleShowAction(l.model.allowDelete(e[0]),"delete-record"),t.editable.allowedOperations[I]&&(o.menu("find","del").disabled=!e.length||!l.model.allowDelete(e[0])))}}),a.menu({actionsContext:i.actions,items:c,beforeOpen:function(){i._updateSelectionActions()}}),u&&i._tbFindElement("actions_button_menu").on("menubeforeopen.gridview",(function(){i._updateSelectionActions()})),l.rowActionMenu$=n,l.srvActionMenu$=o,l.selActionMenu$=a},_gridAggregateLabels:function(){var t=null;return this.aggregateLabels||(this.aggregateLabels=t={},e.each(Y,(function(e,i){t[i]={label:j(i),overallLabel:j(i+"_OVERALL")}}))),this.aggregateLabels},_gridAggregateTooltipsFromReport:function(e,t){var i,n,o=null,a=t.views.grid.aggregations;if(a.length>0)for(o={},i=0;i<a.length;i++)(n=a[i]).tooltip&&(o[n.function+"|"+e._getColumn(n.columnId).name]=n.tooltip);return o},_gridHighlightsFromReport:function(e){var t,i,n={},o=e.views.grid.highlights;for(t=0;t<o.length;t++)n[(i=o[t]).id]={seq:i.seq,row:i.type===_,color:i.textColor,background:i.backgroundColor};return n},_hasGridView:function(){return this.view$.is(":apex-grid")},destroyView:function(e){this._hasGridView()&&this.view$.grid("destroy"),this.singleRowView$&&this.singleRowView$.remove(),e._getElement("column_header_menu").remove()},destroy:function(e){this.rowActionMenu$&&this.rowActionMenu$.length>0&&(this.rowActionMenu$.remove(),this.rowActionMenu$=null),this.selActionMenu$&&this.selActionMenu$.length>0&&(this.selActionMenu$.remove(),this.selActionMenu$=null),this._selectionMenuStart&&this._selectionMenuItems&&(this._selectionMenuItems.length=this._selectionMenuStart,this._selectionMenuItems=this._selectionMenuStart=null)},getContextRecord:function(t){var i;return this.singleRowMode?[this.singleRowView$.recordView("getRecord")]:(i=e(t).closest("tr")).length>0?this.view$.grid("getRecords",[i]):[]},getColumns:function(){return this.singleRowMode?this.curInst.getFields():this.curInst.getColumns()},canCopy2Clipboard:function(){return!this.singleRowMode&&this.curInst.option("allowCopy")},selectCells:function(e){if(!this.singleRowMode){if(void 0===e)return this.view$.grid(v,"selectCells");this.view$.grid(v,"selectCells",e)}},getSelectedRecords:function(){var e;return this.singleRowMode?(e=this.curInst.getRecord())?[e]:[]:this.curInst.getSelectedRecords()},setSelectedRecords:function(e,t,i){var n;this.singleRowMode?((n=this.model.indexOf(e[0]))<0&&(n=0),this.singleRowView$.recordView(v,"recordOffset",n)):this.view$.grid("setSelectedRecords",e,t,i)},getActiveRecordId:function(){return this.curInst.getActiveRecordId()},setModelName:function(e){this.curInst.option("modelName",e)},setEditMode:function(e){this.curInst.setEditMode(e)},finishEditing:function(){return this.curInst.finishEditing()},setNoDataMessage:function(e){this.curInst.option("noDataMessage",e)},focus:function(){this.curInst.focus()},refreshColumns:function(){this._hasGridView()&&this.view$.grid("refreshColumns"),this.singleRowView$&&this.singleRowView$.recordView("refreshFields")},footerHeight:function(){if(!this.singleRowMode)return this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(e){this._hasGridView()&&this.view$.grid("refresh"),this.singleRowView$&&this.singleRowView$.recordView("refresh")},resize:function(){this.curInst.resize()},show:function(){this.curInst.element.show()},hide:function(){this.curInst.element.hide()}},Pe={setColumnConfig:function(t){var i,n,o={},a={},l=t.baseModelColumns,r=t.igConfig,s=t.ig,d=!1!==r.editable,c=0;for(n in l)l.hasOwnProperty(n)&&(c++,o=e.extend(!0,{},l[n]),n!==k?(i=s._getColumn(n),o.elementId=i.staticId,o.seq=c,d&&"actions"===i.specialType&&(delete o.index,o.virtual=!0,o.elementId=null),a[i.name]=o):a[k]=o);this.modelColumns=a,this.specialColumns={identityField:0===s.primaryKeyColumns.length?null:s.primaryKeyColumns,metaField:k}},initView:function(e){var t=!0,i=!1,n=e.igConfig,o=e.ig;switch(n.headingFixedTo){case y:t=!1;break;case"page":t=!1,i=!0}this.view$.tableModelView(this.viewConfig(e,{modelName:this.modelName,noDataMessage:n.text.noDataFound,moreDataMessage:n.text.moreDataFound,showNullAs:n.appearance.showNullValue,hasSize:t,columns:this.modelColumns,pagination:o._getPaginationConfig(n,"icon"===this.internalIdentifier?"defaultIconViewOptions":"defaultDetailViewOptions"),rowsPerPage:e.currentReportSettings.rowsPerPage,stickyFooter:i,selectionChange:function(e){o._selectionChange(e)},pageChange:function(e,t){o._pageChange(t)}}))},destroyView:function(){this.view$.tableModelView("destroy")},setReportOptions:function(e,t,i,n){var o,a=this;(o={rowsPerPage:function(){a.view$.tableModelView(v,"rowsPerPage",i.rowsPerPage),t||(a.pendingRefresh=!0)}})[n]&&a.view$&&o[n]()},getSelectedRecords:function(){return this.view$.tableModelView("getSelectedRecords")},setSelectedRecords:function(e,t,i){this.view$.tableModelView("setSelectedRecords",e,t,i)},setModelName:function(e){this.view$.tableModelView(v,"modelName",e)},setNoDataMessage:function(e){this.view$.tableModelView(v,"noDataMessage",e)},footerHeight:function(){return this.view$.find(".a-GV-footer").outerHeight()||0},refresh:function(e){this.view$.tableModelView("refresh")},resize:function(){this.view$.tableModelView("resize")},isConfigured:function(){return!0}};xe(e.extend({},Pe,{title:j("ICON"),internalIdentifier:"icon",cssClass:"a-IG-iconView",icon:"icon-ig-icons",supports:{sort:!0},viewConfig:function(t,i){var n,o=t.igConfig,a=o.views.icon.features,l=!1,r=o.views.icon;return i=e.extend(!0,{iconListOptions:{}},o.defaultIconViewOptions,i),r.customIcon?(r.customIcon.trim().toLowerCase().match(/\s*<li/)?i.recordTemplate=r.customIcon:i.recordTemplate="<li>"+r.customIcon+"</li>",r.customIcon.toLowerCase().indexOf("href=")>=0&&(l=!0)):(i.labelColumn=r.labelColumn,r.iconClassColumn&&(i.iconClassColumn=r.iconClassColumn),r.imageURLColumn&&(i.imageURLColumn=r.imageURLColumn),r.imageAttributes&&(i.imageAttributes=r.imageAttributes),r.linkAttributes&&(i.linkAttributes=r.linkAttributes),r.linkTarget&&(i.linkTarget=!0,l=!0),i.linkTargetColumn&&(l=!0)),i.useIconList=!0,n=i.iconListOptions,l&&void 0===n.navigation&&(n.navigation=!0),a.rowSelector&&void 0===n.multiple&&void 0===n.itemSelector&&(n.multiple=a.rowSelector.multiSelect,n.navigation?n.itemSelector=!1:n.itemSelector=!a.rowSelector.hideControl),i.iconListOptions.contextMenu&&!i.iconListOptions.contextMenu.hasOwnProperty("actionsContext")&&(i.iconListOptions.contextMenu.actionsContext=t.ig.actions),i},focus:function(){this.view$.tableModelView("focus")},getContextRecord:function(t){var i;return this.view$.tableModelView("option").useIconList&&(i=e(t).closest(".a-IconList-item")).length?this.view$.tableModelView("getRecords",i):[]},canCopy2Clipboard:function(){var e=this.view$.tableModelView("option","iconListOptions");return void 0===e.allowCopy||e.allowCopy}})),xe(e.extend({},He,{title:j("GRID"),internalIdentifier:"grid",cssClass:"a-IG-gridView",icon:"icon-ig-report",supports:{cellSelection:!0,edit:!0,highlight:!0,controlBreak:!0,aggregation:!0,singleRowView:!0,configurableColumns:!0,download:!0},gotoCell:function(e,t){return this.singleRowMode?this.curInst.gotoField(e,t):this.curInst.gotoCell(e,t)},lockActive:function(){this.curInst.lockActive()},unlockActive:function(){this.curInst.unlockActive()}})),xe(e.extend({},Pe,{title:j("DETAIL"),internalIdentifier:"detail",cssClass:"a-IG-detailView",icon:"icon-ig-details",supports:{selection:!1,sort:!0},viewConfig:function(t,i){var n=t.igConfig,o=n.views.detail;return i.beforeTemplate=o.beforeRows,i.recordTemplate=o.row,i.afterTemplate=o.afterRows,i.useIconList=!1,e.extend(!0,{},n.defaultDetailViewOptions,i)},focus:function(){this.view$.find(":focusable").first().focus()}})),xe({title:j("CHART"),internalIdentifier:b,cssClass:"a-IG-chartView",icon:"icon-ig-chart",supports:{totalRows:!1,selection:!1,sort:!1,changeRowsPerPage:!1},initDialog:function(t){var i,n,a,l,r=[],s=[],d=[],c=j("SELECT"),u=t.options.config.columns;for(r.push({value:"",label:c}),s.push({value:"",label:c}),d.push({value:"",label:c}),a=0;a<u.length;a++)(n=u[a]).specialType||n.isHidden||(l||(l=n),r.push({value:n.id,label:t._getColumnLabel(n.id)}),n.dataType===P&&s.push({value:n.id,label:t._getColumnLabel(n.id)}),n.dataType!==P&&n.dataType!==F||d.push({value:n.id,label:t._getColumnLabel(n.id)}));i=[{value:"",label:j("SELECT")},{value:Y.CNT,label:j(Y.CNT)},{value:Y.CNT_DIST,label:j(Y.CNT_DIST)},{value:Y.APPR_CNT_DIST,label:j(Y.APPR_CNT_DIST)},{value:Y.MIN,label:j(Y.MIN)},{value:Y.MAX,label:j(Y.MAX)},{value:Y.SUM,label:j(Y.SUM)},{value:Y.AVG,label:j(Y.AVG)}],this.dialog$=t._createDialog("chart",(function(e){e("iconList",{id:"CH_TYPE",iconOnly:!1,options:[{value:"area",label:j("AREA"),iconCssClasses:"icon-region-chart-area"},{value:B,label:j("BAR"),iconCssClasses:"icon-region-chart-bar"},{value:"bubble",label:j("BUBBLE"),iconCssClasses:"icon-region-chart-bubble"},{value:"donut",label:j("DONUT"),iconCssClasses:"icon-region-chart-donut"},{value:"funnel",label:j("FUNNEL"),iconCssClasses:"icon-region-chart-funnel"},{value:"line",label:j("LINE"),iconCssClasses:"icon-region-chart-line"},{value:"lineWithArea",label:j("LINE_WITH_AREA"),iconCssClasses:"icon-region-chart-line-area"},{value:"pie",label:j("PIE"),iconCssClasses:"icon-region-chart-pie"},{value:"polar",label:j("POLAR"),iconCssClasses:"icon-region-chart-polar"},{value:"radar",label:j("RADAR"),iconCssClasses:"icon-region-chart-radar"},{value:"range",label:j("RANGE"),iconCssClasses:"icon-region-chart-range-bar"},{value:"scatter",label:j("SCATTER"),iconCssClasses:"icon-region-chart-scatter"},{value:"stock",label:j("STOCK"),iconCssClasses:"icon-region-chart-stock"}]}),e(m,{id:"CH_ORIENTATION",options:[{value:"vertical",label:j("VERTICAL")},{value:"horizontal",label:j("HORIZONTAL")}]}),e(m,{id:"CH_LABEL_COLUMN",options:r}),e(m,{id:"CH_VALUE_COLUMN",options:s}),e(m,{id:"CH_VALUE_FUNCTION",options:i}),e(m,{id:"CH_X_COLUMN",options:d}),e(m,{id:"CH_X_FUNCTION",options:i}),e(m,{id:"CH_Y_COLUMN",options:s}),e(m,{id:"CH_Y_FUNCTION",options:i}),e(m,{id:"CH_Z_COLUMN",options:s}),e(m,{id:"CH_Z_FUNCTION",options:i}),e(m,{id:"CH_OPEN_COLUMN",options:s}),e(m,{id:"CH_OPEN_FUNCTION",options:i}),e(m,{id:"CH_CLOSE_COLUMN",options:s}),e(m,{id:"CH_CLOSE_FUNCTION",options:i}),e(m,{id:"CH_HIGH_COLUMN",options:s}),e(m,{id:"CH_HIGH_FUNCTION",options:i}),e(m,{id:"CH_LOW_COLUMN",options:s}),e(m,{id:"CH_LOW_FUNCTION",options:i}),e(m,{id:"CH_VOLUME_COLUMN",options:s}),e(m,{id:"CH_VOLUME_FUNCTION",options:i}),e(m,{id:"CH_TARGET_COLUMN",options:s}),e(m,{id:"CH_TARGET_FUNCTION",options:i}),e(m,{id:"CH_SERIES_COLUMN",options:r}),e(m,{id:"CH_STACK",options:[{value:q,label:j("OFF")},{value:X,label:j("ON")}]}),e(m,{id:"CH_SORT_BY",options:[]}),t._renderSortControls(e,"CH_SORT_"),e(p,{id:"CH_AXIS_LABEL_TITLE",maxChars:255}),e(p,{id:"CH_AXIS_VALUE_TITLE",maxChars:255}),e(p,{id:"CH_AXIS_VALUE_DECIMAL"})}),{viewDialog:!0,width:750,height:450,titleKey:"CHART",modelOptions:{fields:{id:{canHide:!1,hidden:!0,seq:0},type:{label:"TYPE",elementId:"CH_TYPE",seq:10,defaultValue:B},orientationId:{label:"ORIENTATION",elementId:"CH_ORIENTATION",seq:20,fieldColSpan:7,defaultValue:"vertical"},labelColumnId:{label:"LABEL_COLUMN",elementId:"CH_LABEL_COLUMN",seq:30,fieldColSpan:7,defaultValue:""},valueColumnId:{label:"VALUE_COLUMN",elementId:"CH_VALUE_COLUMN",seq:40,fieldColSpan:7,defaultValue:""},valueFunctionId:{label:"AGGREGATION",elementId:"CH_VALUE_FUNCTION",seq:45,fieldColSpan:5,defaultValue:""},xColumnId:{label:"X_COLUMN",elementId:"CH_X_COLUMN",seq:50,fieldColSpan:7,defaultValue:""},xFunctionId:{label:"AGGREGATION",elementId:"CH_X_FUNCTION",seq:55,fieldColSpan:5,defaultValue:""},yColumnId:{label:"Y_COLUMN",elementId:"CH_Y_COLUMN",seq:60,fieldColSpan:7,defaultValue:""},yFunctionId:{label:"AGGREGATION",elementId:"CH_Y_FUNCTION",seq:65,fieldColSpan:5,defaultValue:""},openColumnId:{label:"OPEN_COLUMN",elementId:"CH_OPEN_COLUMN",seq:70,fieldColSpan:7,defaultValue:""},openFunctionId:{label:"AGGREGATION",elementId:"CH_OPEN_FUNCTION",seq:75,fieldColSpan:5,defaultValue:""},closeColumnId:{label:"CLOSE_COLUMN",elementId:"CH_CLOSE_COLUMN",seq:80,fieldColSpan:7,defaultValue:""},closeFunctionId:{label:"AGGREGATION",elementId:"CH_CLOSE_FUNCTION",seq:85,fieldColSpan:5,defaultValue:""},highColumnId:{label:"HIGH_COLUMN",elementId:"CH_HIGH_COLUMN",seq:90,fieldColSpan:7,defaultValue:""},highFunctionId:{label:"AGGREGATION",elementId:"CH_HIGH_FUNCTION",seq:95,fieldColSpan:5,defaultValue:""},lowColumnId:{label:"LOW_COLUMN",elementId:"CH_LOW_COLUMN",seq:100,fieldColSpan:7,defaultValue:""},lowFunctionId:{label:"AGGREGATION",elementId:"CH_LOW_FUNCTION",seq:105,fieldColSpan:5,defaultValue:""},volumeColumnId:{label:"VOLUME_COLUMN",elementId:"CH_VOLUME_COLUMN",seq:110,fieldColSpan:7,defaultValue:""},volumeFunctionId:{label:"AGGREGATION",elementId:"CH_VOLUME_FUNCTION",seq:115,fieldColSpan:5,defaultValue:""},targetColumnId:{label:"TARGET_COLUMN",elementId:"CH_TARGET_COLUMN",seq:120,fieldColSpan:7,defaultValue:""},targetFunctionId:{label:"AGGREGATION",elementId:"CH_TARGET_FUNCTION",seq:125,fieldColSpan:5,defaultValue:""},zColumnId:{label:"Z_COLUMN",elementId:"CH_Z_COLUMN",seq:130,fieldColSpan:7,defaultValue:""},zFunctionId:{label:"AGGREGATION",elementId:"CH_Z_FUNCTION",seq:135,fieldColSpan:5,defaultValue:""},seriesColumnId:{label:"SERIES_COLUMN",elementId:"CH_SERIES_COLUMN",seq:140,fieldColSpan:7,defaultValue:""},stackId:{label:"STACK",elementId:"CH_STACK",seq:143,fieldColSpan:5,defaultValue:q},sortBy:{label:"SORT_BY",elementId:"CH_SORT_BY",seq:145,fieldColSpan:7,defaultValue:j("LABEL_COLUMN")},sortDirection:{label:"DIRECTION",elementId:"CH_SORT_DIRECTION",seq:147,fieldColSpan:3,defaultValue:N},sortNulls:{label:"NULLS",elementId:"CH_SORT_NULLS",seq:149,fieldColSpan:2,defaultValue:L},axisLabelTitle:{label:"AXIS_LABEL_TITLE",elementId:"CH_AXIS_LABEL_TITLE",seq:150,fieldColSpan:7},axisValueTitle:{label:"AXIS_VALUE_TITLE",elementId:"CH_AXIS_VALUE_TITLE",seq:170,fieldColSpan:7},axisValueDecimal:{label:"AXIS_VALUE_DECIMAL",elementId:"CH_AXIS_VALUE_DECIMAL",seq:180,fieldColSpan:3}}},init:function(i,n,o){var a,l,r={},s=t._getElement("CH_TYPE"),d=t._getElement("CH_ORIENTATION"),c=t._getElement("CH_LABEL_COLUMN"),u=t._getElement("CH_VALUE_COLUMN"),h=t._getElement("CH_X_COLUMN"),g=t._getElement("CH_Y_COLUMN"),p=t._getElement("CH_Z_COLUMN"),m=t._getElement("CH_OPEN_COLUMN"),f=t._getElement("CH_CLOSE_COLUMN"),_=t._getElement("CH_HIGH_COLUMN"),C=t._getElement("CH_LOW_COLUMN"),I=t._getElement("CH_VOLUME_COLUMN"),E=t._getElement("CH_TARGET_COLUMN"),v=t._getElement("CH_SERIES_COLUMN"),b=t._getElement("CH_STACK"),w=t._getElement("CH_AXIS_LABEL_TITLE"),A=t._getElement("CH_AXIS_VALUE_TITLE"),T=t._getElement("CH_AXIS_VALUE_DECIMAL"),R=t._getElement("CH_VALUE_FUNCTION"),S=t._getElement("CH_X_FUNCTION"),N=t._getElement("CH_Y_FUNCTION"),L=t._getElement("CH_Z_FUNCTION"),y=t._getElement("CH_OPEN_FUNCTION"),O=t._getElement("CH_CLOSE_FUNCTION"),k=t._getElement("CH_HIGH_FUNCTION"),V=t._getElement("CH_LOW_FUNCTION"),M=t._getElement("CH_VOLUME_FUNCTION"),D=t._getElement("CH_TARGET_FUNCTION"),x=t._getElement("CH_SORT_BY"),G=t._getElement("CH_SORT_DIRECTION"),H=t._getElement("CH_SORT_NULLS"),P=x.val();function F(){var t=s.val();d.val();switch(ye([d,c,u,h,g,p,m,f,_,C,I,E,v,b,w,A,T,R,S,N,L,y,O,k,V,M,D,x,G,H]),function(){var e=o.recordView("getRecord");function t(t,n){i.setValue(e,t,n)}t("sortBy",x.val()),t("sortDirection",G.val()),t("sortNulls",H.val()),t("orientationId",d.val()),t("stackId",b.val())}(),a=[d,c,u,v,b,R,w,A,T,x,G,H],l=[c,u,R,x,G,H],t){case"area":Le(a),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))}));break;case B:Le([d,c,u,p,v,b,R,L,w,A,T,x,G,H]),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),r[ne]=j("Z_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"bubble":Le([c,h,g,p,S,N,L,w,A,T,x,G,H]),ke([c,h,g,p],!0),ke([u,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[te]=j("X_COLUMN"),r[ie]=j("Y_COLUMN"),r[ne]=j("Z_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"donut":Le([c,u,R,x,G,H,T]),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"funnel":Le([d,c,u,E,R,D,x,G,H]),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),r[oe]=j("TARGET_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"line":case"lineWithArea":Le(a),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"pie":Le([c,u,R,T,x,G,H]),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1);break;case"polar":case"radar":Le(l),ke([c,u],!0),ke([h,g,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ee]=j("VALUE_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"range":Le([d,c,_,C,p,v,k,V,L,w,A,T,x,G,H]),ke([_,C],!0),ke([c,u,h,g,p,m,f],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[ae]=j("HIGH_COLUMN"),r[le]=j("LOW_COLUMN"),r[ne]=j("Z_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P);break;case"stock":Le([c,m,f,_,C,I,y,O,k,V,M]),ke([c,m,f,_,C],!0),ke([u,h,g,p],!1);break;case"scatter":Le([c,h,g,v,S,N,w,A,T,x,G,H]),ke([c,h,g],!0),ke([u,p,m,f,_,C],!1),P=x.val(),x.empty(),(r={})[J]=j("LABEL_COLUMN"),r[te]=j("X_COLUMN"),r[ie]=j("Y_COLUMN"),e.each(r,(function(t,i){x.append(e("<option></option>").attr("value",t).text(i))})),null===P&&""===P||x.val(P)}}s.change(F),o.on("apexbeginrecordedit",(function(e,i){var n=s.val();we(t._getId("CH_TYPE"),n),F()}))},load:function(i){var n,o,a=e.extend({},t.getChart());for(n in a.axis&&(a.axis.label&&(a.axisLabelTitle=a.axis.label),a.axis.value&&(a.axisValueTitle=a.axis.value),a.axis.valueDecimalPlaces&&(a.axisValueDecimal=a.axis.valueDecimalPlaces),delete a.axis),a.stackId=a.stack,delete a.stack,a.orientationId=a.orientation,delete a.orientation,a.chartColumns)if(a.chartColumns.hasOwnProperty(n))switch(o=a.chartColumns[n],n){case"LABEL":a.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}&&(a.labelColumnId=o.columnId,o.sort&&(a.sortBy="LABEL",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls));break;case"VALUE":a.valueColumnId=o.columnId,o.function&&(a.valueFunctionId=o.function),o.sort&&(a.sortBy="VALUE",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"X":a.xColumnId=o.columnId,o.function&&(a.xFunctionId=o.function),o.sort&&(a.sortBy="X",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"Y":a.yColumnId=o.columnId,o.function&&(a.yFunctionId=o.function),o.sort&&(a.sortBy="Y",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"Z":a.zColumnId=o.columnId,o.function&&(a.zFunctionId=o.function),o.sort&&(a.sortBy="Z",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"OPEN":a.openColumnId=o.columnId,o.function&&(a.openFunctionId=o.function);break;case"CLOSE":a.closeColumnId=o.columnId,o.function&&(a.closeFunctionId=o.function);break;case"HIGH":a.highColumnId=o.columnId,o.function&&(a.highFunctionId=o.function),o.sort&&(a.sortBy="HIGH",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"LOW":a.lowColumnId=o.columnId,o.function&&(a.lowFunctionId=o.function),o.sort&&(a.sortBy="LOW",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"VOLUME":a.volumeColumnId=o.columnId,o.function&&(a.volumeFunctionId=o.function);break;case"TARGET":a.targetColumnId=o.columnId,o.function&&(a.targetFunctionId=o),o.sort&&(a.sortBy="TARGET",a.sortDirection=o.sort.direction,a.sortNulls=o.sort.nulls);break;case"SERIES_NAME":a.seriesColumnId=o.columnId}delete a.chartColumns,i.setData(a)},validate:function(e,t,i){var n,a=!0,l=e.getRecord();return l.sortBy&&(n=l.sortBy.toLowerCase()+"ColumnId",l.hasOwnProperty(n)?t(l.sortBy,"sortBy"):(i(l.sortBy,"sortBy",o.formatMessage("APEX.IG.INVALID_SORT_BY",l.sortBy)),a=!1)),a},store:function(i){var n,o,a,l,r,s,d,c,u,h,g,p,m=e.extend({},i.getRecord());m.axis={},m.axis={label:m.axisLabelTitle,value:m.axisValueTitle,valueDecimalPlaces:m.axisValueDecimal},delete m.axisLabelTitle,delete m.axisValueTitle,delete m.axisValueDecimal,m.stack=m.stackId,m.orientation=m.orientationId,m.chartColumns={},m.type in{bar:1,bubble:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}?m.labelColumnId&&(n={columnId:m.labelColumnId,columnType:C},m.sortBy===J&&(n.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.chartColumns.LABEL=n):delete m.chartColumns.LABEL,m.type in{bar:1,area:1,funnel:1,pie:1,donut:1,polar:1,radar:1,line:1,lineWithArea:1}?m.valueColumnId&&(o={columnId:m.valueColumnId,columnType:C},m.sortBy===ee&&(o.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.valueFunctionId&&(o.function=m.valueFunctionId),m.chartColumns.VALUE=o):delete m.chartColumns.VALUE,m.type in{bubble:1,scatter:1}?(m.xColumnId&&(a={columnId:m.xColumnId,columnType:C},"X"===m.sortBy&&(a.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.xFunctionId&&(a.function=m.xFunctionId),m.chartColumns.X=a),m.yColumnId&&(l={columnId:m.yColumnId,columnType:C},"Y"===m.sortBy&&(l.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.yFunctionId&&(l.function=m.yFunctionId),m.chartColumns.Y=l)):(delete m.chartColumns.X,delete m.chartColumns.Y),m.type in{bar:1,bubble:1}?m.zColumnId&&(r={columnId:m.zColumnId,columnType:C},"Z"===m.sortBy&&(r.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.zFunctionId&&(r.function=m.zFunctionId),m.chartColumns.Z=r):delete m.chartColumns.Z,"stock"===m.type?(m.openColumnId&&(s={columnId:m.openColumnId,columnType:C},m.openFunctionId&&(s.function=m.openFunctionId),m.chartColumns.OPEN=s),m.closeColumnId&&(d={columnId:m.closeColumnId,columnType:C},m.closeFunctionId&&(d.function=m.closeFunctionId),m.chartColumns.CLOSE=d),m.volumeColumnId&&(h={columnId:m.volumeColumnId,columnType:C},m.volumeFunctionId&&(h.function=m.volumeFunctionId),m.chartColumns.VOLUME=h)):(delete m.chartColumns.OPEN,delete m.chartColumns.CLOSE,delete m.chartColumns.VOLUME),m.type in{range:1,stock:1}?(m.highColumnId&&(c={columnId:m.highColumnId,columnType:C},"HIGH"===m.sortBy&&(c.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.highFunctionId&&(c.function=m.highFunctionId),m.chartColumns.HIGH=c),m.lowColumnId&&(u={columnId:m.lowColumnId,columnType:C},"LOW"===m.sortBy&&(u.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.lowFunctionId&&(u.function=m.lowFunctionId),m.chartColumns.LOW=u)):(delete m.chartColumns.HIGH,delete m.chartColumns.LOW),"funnel"===m.type?m.targetColumnId&&(g={columnId:m.targetColumnId,columnType:C},"TARGET"===m.sortBy&&(g.sort={order:1,direction:m.sortDirection,nulls:m.sortNulls}),m.targetFunctionId&&(g.function=m.targetFunctionId),m.chartColumns.TARGET=g):delete m.chartColumns.TARGET,m.seriesColumnId&&(p={columnId:m.seriesColumnId,columnType:C},m.chartColumns.SERIES_NAME=p),delete m.sortBy,delete m.sortDirection,delete m.sortNulls,delete m.stackId,delete m.orientationId,delete m.xColumnId,delete m.xFunctionId,delete m.yFunctionId,delete m.yColumnId,delete m.valueColumnId,delete m.valueFunctionId,delete m.labelColumnId,delete m.zColumnId,delete m.zFunctionId,delete m.openColumnId,delete m.openFunctionId,delete m.closeColumnId,delete m.closeFunctionId,delete m.volumeColumnId,delete m.volumeFunctionId,delete m.highColumnId,delete m.highFunctionId,delete m.lowColumnId,delete m.lowFunctionId,delete m.targetColumnId,delete m.targetFunctionId,delete m.seriesColumnId,t.setChart(m)}})},setColumnConfig:function(t){var i,n,o,a,l,r={},s={},d=t.baseModelColumns,c=t.ig,u=t.igConfig,h=t.currentReportSettings.views.chart.chartColumns,g=["CLOSE","HIGH","LABEL","LOW","OPEN","SERIES_NAME","TARGET","VALUE","VOLUME","X","Y","Z"],p=0;for(l=0;l<g.length;l++)o=g[l],h.hasOwnProperty(o)&&((r=e.extend(!0,{},d[h[o].columnId])).seq=p,r.index=p,s[o]=r,p++);if(u.parentRegionStaticId)for(n in d)d.hasOwnProperty(n)&&(a=d[n]).parentField&&(i=c._getColumn(n),(r=e.extend(!0,{},a)).seq=p,r.virtual=!0,delete r.index,s[i.name]=r,p++);this.modelColumns=s,this.specialColumns={}},initView:function(t){var i,n,o,a,l,r,s,d,c,u,h=t.ig,g=this,p=h._currentReportSettings().views.chart,m=t.igConfig,f=[],_="disabled";require(["ojs/ojcore","ojs/ojchart","ojs/ojvalidation"],(function(){function t(t){var i,n=oj.ConverterFactory.CONVERTER_TYPE_NUMBER,o=h._getColumn(t);return o.filter.dataType===F||o.filter.dataType===U||"TIMESTAMP_TZ"===o.filter.dataType||"TIMESTAMP_LTZ"===o.filter.dataType?(n=oj.ConverterFactory.CONVERTER_TYPE_DATETIME,i=function(t){var i=t.appearance.formatMask;i?e.each(se,(function(e,t){t.value===i&&(i=t.label)})):i={formatType:"date",dateFormat:"medium"};return i}(o)):o.filter.dataType===P&&(i=function(t){var i,n=t.appearance.formatExample.trim();p.axis&&p.axis.valueDecimalPlaces&&(i=p.axis.valueDecimalPlaces);n?e.each(re,(function(e,t){t.value===n&&(n=t.label)})):n={style:"decimal",maximumFractionDigits:i||2};return n}(o)),i?oj.Validation.converterFactory(n).createConverter(i):{}}switch(p.chartColumns.LABEL.columnId&&((l=h._getColumn(p.chartColumns.LABEL.columnId)).filter.dataType!==F&&l.filter.dataType!==U&&"TIMESTAMP_TZ"!==l.filter.dataType&&"TIMESTAMP_LTZ"!==l.filter.dataType||(_="enabled")),n={legend:{rendered:$,position:"end"},orientation:p.orientation,stack:p.stack,animationOnDisplay:$,animationOnDataChange:$,hoverBehavior:"dim",groups:[],series:[],valueFormats:[],timeAxisType:_,translations:{labelNoData:m.text.noDataFound}},p.type){case"area":case B:o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:$}:{rendered:q},coordinateSystem:"cartesian",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"y",converter:t(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case"bubble":o=e.extend({},n,{type:p.type,legend:{rendered:q},coordinateSystem:"cartesian",xAxis:{},yAxis:{}});break;case"donut":o=e.extend({},n,{type:"pie",styleDefaults:{pieInnerRadius:.5},legend:{rendered:$},hideAndShowBehavior:"withRescale",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}]});break;case"pie":o=e.extend({},n,{type:p.type,styleDefaults:{pieInnerRadius:0},legend:{rendered:$},hideAndShowBehavior:"withRescale",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}]});break;case"funnel":o=e.extend({},n,{type:p.type,legend:{rendered:$},valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}]}),p.chartColumns.TARGET&&o.valueFormats.push({type:"target",converter:t(p.chartColumns.TARGET.columnId)});break;case"line":case"lineWithArea":o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:$}:{rendered:q},coordinateSystem:"cartesian",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}],xAxis:{},yAxis:{}});break;case"polar":o=e.extend({},n,{type:B,coordinateSystem:p.type,legend:{rendered:q},valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}],polarGridShape:"circle",stack:X});break;case"radar":o=e.extend({},n,{type:"area",coordinateSystem:"polar",legend:{rendered:q},valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"value",converter:t(p.chartColumns.VALUE.columnId)}],polarGridShape:"polygon",stack:X});break;case"range":o=e.extend({},n,{type:B,legend:p.chartColumns.SERIES_NAME?{rendered:$}:{rendered:q},valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"high",converter:t(p.chartColumns.HIGH.columnId)},{type:"low",converter:t(p.chartColumns.LOW.columnId)}],xAxis:{},yAxis:{}});break;case"scatter":o=e.extend({},n,{type:p.type,legend:p.chartColumns.SERIES_NAME?{rendered:$}:{rendered:q},coordinateSystem:"cartesian",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"x",converter:t(p.chartColumns.X.columnId)},{type:"y",converter:t(p.chartColumns.Y.columnId)}],xAxis:{},yAxis:{}});break;case"stock":o=e.extend({},n,{type:p.type,zoomAndScroll:"delayed",initialZooming:"first",legend:{rendered:$},dataCursor:X,dataCursorBehavior:"smooth",valueFormats:[{type:V,converter:t(p.chartColumns.LABEL.columnId)},{type:"high",converter:t(p.chartColumns.HIGH.columnId)},{type:"low",converter:t(p.chartColumns.LOW.columnId)},{type:"open",converter:t(p.chartColumns.OPEN.columnId)},{type:"close",converter:t(p.chartColumns.CLOSE.columnId)}],xAxis:{},yAxis:{}}),p.chartColumns.VOLUME&&o.valueFormats.push({type:"volume",converter:t(p.chartColumns.VOLUME.columnId)}),o.series.type="candlestick"}if(p.type in{area:1,bar:1,bubble:1,line:1,lineWithArea:1,range:1,stock:1,scatter:1}){switch(p.type){case"stock":r=p.chartColumns.OPEN.columnId;break;case"range":r=p.chartColumns.HIGH.columnId;break;case"scatter":case"bubble":r=p.chartColumns.X.columnId;break;default:r=p.chartColumns.VALUE.columnId}p.axis&&(p.axis.label&&(s=p.axis.label),p.axis.value&&(d=p.axis.value)),o.xAxis={title:s,baselineScaling:"zero",majorTick:{rendered:X},minorTick:{rendered:q},tickLabel:{rendered:X,converter:t(p.chartColumns.LABEL.columnId),scaling:y},position:$,rotation:q},o.yAxis={title:d,baselineScaling:"zero",position:"stock"===p.type?"end":$,majorTick:{rendered:X},minorTick:{rendered:q},tickLabel:{rendered:X,converter:t(r),scaling:y}}}if(p.type in{bar:1,area:1,polar:1,radar:1,range:1,line:1,lineWithArea:1,bubble:1,scatter:1,stock:1}){switch(i={path:"groups",uniqueIndexField:"LABEL",item:{name:"LABEL"}},p.type){case"bubble":a={name:"LABEL",x:"X",y:"Y",z:"Z",labelPosition:"'none'"};break;case"scatter":a={name:"LABEL",x:"X",y:"Y",labelPosition:"'none'"};break;case"stock":a={name:"LABEL",open:"OPEN",close:"CLOSE",high:"HIGH",low:"LOW",volume:"VOLUME"};break;case"range":a={name:"LABEL",high:"HIGH",low:"LOW",labelPosition:"'none'"};break;default:a={label:"VALUE",value:"VALUE",name:"LABEL",labelPosition:"'none'"}}f=p.chartColumns.SERIES_NAME?[i,{path:"series",uniqueIndexField:"SERIES_NAME",item:{name:"SERIES_NAME",displayInLegend:X}},{path:"series/[SERIES_NAME]/items",item:a}]:[i,{path:"series/0/items",item:a}]}if(p.type in{pie:1,donut:1,funnel:1}&&(c=g.model.getFieldKey("LABEL"),f=[{path:"series",uniqueIndexField:"LABEL",item:function(e,t){return{name:""+t[c],displayInLegend:X}}},{path:"series/[LABEL]/items",item:{value:"VALUE",targetValue:"TARGET"}}]),p.chartColumns.VALUE){if(p.chartColumns.VALUE.sort)switch(p.chartColumns.VALUE.sort.direction){case"asc":u="ascending";break;case"desc":u="descending"}}else p.chartColumns.LABEL.sort?u="label-"+p.chartColumns.LABEL.sort.direction:(p.chartColumns.SERIES_NAME&&(u="label-asc"),u="off");o.sorting=u,g._dataTransformOptions={showNullAs:m.appearance.showNullValue,offset:0,template:f},g._chartOptions=o,g._updateChartData(),g.view$.ojChart(o).css({"max-width":"100%"}),g._subscribeModel(),(m.lazyLoad||g.model.getTotalRecords()<0)&&g.refresh()}))},_updateChartData:function(){var t;if(t=this.model.transform(this._dataTransformOptions,this._chartOptions),-1===e.inArray(t.type,["pie","funnel","scatter","bubble","stock","polar","radar"])&&t.series.length>1&&"mixedFrequency"!==t.timeAxisType&&"skipGaps"!==t.timeAxisType){u.chartSortArray(t.groups,t.sorting);for(var i=0;i<t.series.length;i++)u.chartFillGaps(t.groups,t.series[i].items,t.sorting,!0)}},_subscribeModel:function(){var e=this,t=this.view$;this._observedModel&&this._observedModel.unSubscribe(this._observerId),this._observedModel=this.model,this._observerId=this.model.subscribe({viewId:t[0].id,onChange:function(t){"refresh"===t&&e.refresh()},progressView:t})},refresh:function(){var e=this;if(this.view$.hasClass("oj-chart")){if(null===this.view$[0].offsetParent)return void(this._pendingRefresh=!0);this._pendingRefresh=!1,this.model.fetch(0,(function(t){t&&i.warn("No data fetched for chart"),e._updateChartData(),e.resize()}))}},resize:function(){if(this.view$.hasClass("oj-chart")){if(this._pendingRefresh)return void this.refresh();this.view$.ojChart("refresh")}},destroyView:function(){this.model&&this.model.unSubscribe(this.view$[0].id),this.view$.ojChart("destroy")},setModelName:function(e){this._subscribeModel(),this.view$.hasClass("oj-chart")&&(this.model.getTotalRecords()<0?this.refresh():(this._updateChartData(),this.resize()))},setNoDataMessage:function(e){var t=this.view$;t.hasClass("oj-chart")&&t.ojChart(v,"translations.labelNoData",e)}})}(apex.jQuery,apex.util,apex.debug,apex.server,apex.lang,apex.actions,apex.region,apex.theme,apex.message,apex.item,apex.model,apex.widget.util);